(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{758:function(s,a,t){"use strict";t.r(a);var e=t(5),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"go的依赖管理go-module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go的依赖管理go-module"}},[s._v("#")]),s._v(" Go的依赖管理Go Module")]),s._v(" "),t("h2",{attrs:{id:"来源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#来源"}},[s._v("#")]),s._v(" 来源")]),s._v(" "),t("p",[s._v("https://www.liwenzhou.com/posts/Go/go_dependency/")]),s._v(" "),t("h2",{attrs:{id:"历史遗留问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#历史遗留问题"}},[s._v("#")]),s._v(" 历史遗留问题")]),s._v(" "),t("p",[s._v("如果是使用Go1.11和Go1.12版本，需要手动开启Go module支持")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200906202108891.png",alt:"image-20200906202108891"}})]),s._v(" "),t("h2",{attrs:{id:"为什么需要依赖管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要依赖管理"}},[s._v("#")]),s._v(" 为什么需要依赖管理")]),s._v(" "),t("p",[s._v("最早的时候，Go所依赖的所有的第三方库都放在GOPATH这个目录下面。这就导致了同一个库只能保存一个版本的代码。如果不同的项目依赖同一个第三方的库的不同版本，应该怎么解决？")]),s._v(" "),t("h2",{attrs:{id:"godep"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#godep"}},[s._v("#")]),s._v(" godep")]),s._v(" "),t("p",[s._v("Go语言从v1.5开始开始引入"),t("code",[s._v("vendor")]),s._v("模式，如果项目目录下有vendor目录，那么go工具链会优先使用"),t("code",[s._v("vendor")]),s._v("内的包进行编译、测试等。")]),s._v(" "),t("p",[t("code",[s._v("godep")]),s._v("是一个通过vender模式实现的Go语言的第三方依赖管理工具，类似的还有由社区维护准官方包管理工具"),t("code",[s._v("dep")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("p",[s._v("执行以下命令安装"),t("code",[s._v("godep")]),s._v("工具。")]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" get github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tools"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("godep\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"基本命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[s._v("#")]),s._v(" 基本命令")]),s._v(" "),t("p",[s._v("安装好godep之后，在终端输入"),t("code",[s._v("godep")]),s._v("查看支持的所有命令。")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("godep save     将依赖项输出并复制到Godeps.json文件中\ngodep go       使用保存的依赖项运行go工具\ngodep get      下载并安装具有指定依赖项的包\ngodep path     打印依赖的GOPATH路径\ngodep restore  在GOPATH中拉取依赖的版本\ngodep update   更新选定的包或go版本\ngodep "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v("     显示当前和以前保存的依赖项集之间的差异\ngodep version  查看版本信息\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("使用"),t("code",[s._v("godep help [command]")]),s._v("可以看看具体命令的帮助信息。")]),s._v(" "),t("h3",{attrs:{id:"使用godep"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用godep"}},[s._v("#")]),s._v(" 使用godep")]),s._v(" "),t("p",[s._v("在项目目录下执行"),t("code",[s._v("godep save")]),s._v("命令，会在当前项目中创建"),t("code",[s._v("Godeps")]),s._v("和"),t("code",[s._v("vender")]),s._v("两个文件夹。")]),s._v(" "),t("p",[s._v("其中"),t("code",[s._v("Godeps")]),s._v("文件夹下有一个"),t("code",[s._v("Godeps.json")]),s._v("的文件，里面记录了项目所依赖的包信息。 "),t("code",[s._v("vender")]),s._v("文件夹下是项目依赖的包的源代码文件。")]),s._v(" "),t("h3",{attrs:{id:"vender机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vender机制"}},[s._v("#")]),s._v(" vender机制")]),s._v(" "),t("p",[s._v("Go1.5版本之后开始支持，能够控制Go语言程序编译时依赖包搜索路径的优先级。")]),s._v(" "),t("p",[s._v("例如查找项目的某个依赖包，首先会在项目根目录下的"),t("code",[s._v("vender")]),s._v("文件夹中查找，如果没有找到就会去"),t("code",[s._v("$GOAPTH/src")]),s._v("目录下查找。")]),s._v(" "),t("h3",{attrs:{id:"godep开发流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#godep开发流程"}},[s._v("#")]),s._v(" godep开发流程")]),s._v(" "),t("ol",[t("li",[s._v("保证程序能够正常编译")]),s._v(" "),t("li",[s._v("执行"),t("code",[s._v("godep save")]),s._v("保存当前项目的所有第三方依赖的版本信息和代码")]),s._v(" "),t("li",[s._v("提交Godeps目录和vender目录到代码库。")]),s._v(" "),t("li",[s._v("如果要更新依赖的版本，可以直接修改"),t("code",[s._v("Godeps.json")]),s._v("文件中的对应项")])]),s._v(" "),t("h2",{attrs:{id:"go-module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go-module"}},[s._v("#")]),s._v(" go module")]),s._v(" "),t("p",[t("code",[s._v("go module")]),s._v("是Go1.11版本之后官方推出的版本管理工具，并且从Go1.13版本开始，"),t("code",[s._v("go module")]),s._v("将是Go语言默认的依赖管理工具。")]),s._v(" "),t("h3",{attrs:{id:"go111module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go111module"}},[s._v("#")]),s._v(" GO111MODULE")]),s._v(" "),t("p",[s._v("要启用"),t("code",[s._v("go module")]),s._v("支持首先要设置环境变量"),t("code",[s._v("GO111MODULE")]),s._v("，通过它可以开启或关闭模块支持，它有三个可选值："),t("code",[s._v("off")]),s._v("、"),t("code",[s._v("on")]),s._v("、"),t("code",[s._v("auto")]),s._v("，默认值是"),t("code",[s._v("auto")]),s._v("。")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("GO111MODULE=off")]),s._v("禁用模块支持，编译时会从"),t("code",[s._v("GOPATH")]),s._v("和"),t("code",[s._v("vendor")]),s._v("文件夹中查找包。")]),s._v(" "),t("li",[t("code",[s._v("GO111MODULE=on")]),s._v("启用模块支持，编译时会忽略"),t("code",[s._v("GOPATH")]),s._v("和"),t("code",[s._v("vendor")]),s._v("文件夹，只根据 "),t("code",[s._v("go.mod")]),s._v("下载依赖。")]),s._v(" "),t("li",[t("code",[s._v("GO111MODULE=auto")]),s._v("，当项目在"),t("code",[s._v("$GOPATH/src")]),s._v("外且项目根目录有"),t("code",[s._v("go.mod")]),s._v("文件时，开启模块支持。")])]),s._v(" "),t("p",[s._v("简单来说，设置"),t("code",[s._v("GO111MODULE=on")]),s._v("之后就可以使用"),t("code",[s._v("go module")]),s._v("了，以后就没有必要在GOPATH中创建项目了，并且还能够很好的管理项目依赖的第三方包信息。")]),s._v(" "),t("p",[s._v("使用 go module 管理依赖后会在项目根目录下生成两个文件"),t("code",[s._v("go.mod")]),s._v("和"),t("code",[s._v("go.sum")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"goproxy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#goproxy"}},[s._v("#")]),s._v(" GOPROXY")]),s._v(" "),t("p",[s._v("Go1.11之后设置GOPROXY命令为：")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOPROXY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://goproxy.cn\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("Go1.13之后"),t("code",[s._v("GOPROXY")]),s._v("默认值为"),t("code",[s._v("https://proxy.golang.org")]),s._v("，在国内是无法访问的，所以十分建议大家设置GOPROXY，这里我推荐使用"),t("a",{attrs:{href:"https://studygolang.com/topics/10014",target:"_blank",rel:"noopener noreferrer"}},[s._v("goproxy.cn"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("go "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" -w "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOPROXY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://goproxy.cn,direct\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"go-mod命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go-mod命令"}},[s._v("#")]),s._v(" go mod命令")]),s._v(" "),t("p",[s._v("常用的"),t("code",[s._v("go mod")]),s._v("命令如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("go mod download    下载依赖的module到本地cache（默认为$GOPATH/pkg/mod目录）\ngo mod edit        编辑go.mod文件\ngo mod graph       打印模块依赖图\ngo mod init        初始化当前文件夹, 创建go.mod文件\ngo mod tidy        增加缺少的module，删除无用的module\ngo mod vendor      将依赖复制到vendor下\ngo mod verify      校验依赖\ngo mod why         解释为什么需要依赖\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"go-mod"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go-mod"}},[s._v("#")]),s._v(" go.mod")]),s._v(" "),t("p",[s._v("go.mod文件记录了项目所有的依赖信息，其结构大致如下：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("module github.com/Q1mi/studygo/blogger\n\ngo "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.12")]),s._v("\n\nrequire "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tgithub.com/DeanThompson/ginpprof v0.0.0-20190408063150-3be636683586\n\tgithub.com/gin-gonic/gin v1.4.0\n\tgithub.com/go-sql-driver/mysql v1.4.1\n\tgithub.com/jmoiron/sqlx v1.2.0\n\tgithub.com/satori/go.uuid v1.2.0\n\tgoogle.golang.org/appengine v1.6.1 // indirect\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("其中，")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("module")]),s._v("用来定义包名")]),s._v(" "),t("li",[t("code",[s._v("require")]),s._v("用来定义依赖包及版本")]),s._v(" "),t("li",[t("code",[s._v("indirect")]),s._v("表示间接引用")])]),s._v(" "),t("h4",{attrs:{id:"依赖的版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#依赖的版本"}},[s._v("#")]),s._v(" 依赖的版本")]),s._v(" "),t("p",[s._v("go mod支持语义化版本号，比如"),t("code",[s._v("go get foo@v1.2.3")]),s._v("，也可以跟git的分支或tag，比如"),t("code",[s._v("go get foo@master")]),s._v("，当然也可以跟git提交哈希，比如"),t("code",[s._v("go get foo@e3702bed2")]),s._v("。关于依赖的版本支持以下几种格式：")]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[s._v("gopkg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("in"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tomb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("v1 v1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20141024135613")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dd632973f1e7\ngopkg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("in"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("vmihailenco"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("msgpack"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("v2 v2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.1")]),s._v("\ngopkg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("in"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("yaml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("v2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v("v2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.1")]),s._v("\ngithub"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tatsushid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fastping v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20160109021039")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d7bb493dee3e\nlatest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"replace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#replace"}},[s._v("#")]),s._v(" replace")]),s._v(" "),t("p",[s._v("在国内访问golang.org/x的各个包都需要翻墙，你可以在go.mod中使用replace替换成github上对应的库。")]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[s._v("replace "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\tgolang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("crypto v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20180820150726")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("614d502a4dac "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("golang"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("crypto v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20180820150726")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("614d502a4dac\n\tgolang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("net v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20180821023952")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("922f4815f713 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("golang"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("net v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20180826012351")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("8a410e7b638d\n\tgolang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("text v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("golang"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("text v0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"go-get"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go-get"}},[s._v("#")]),s._v(" go get")]),s._v(" "),t("p",[s._v("在项目中执行"),t("code",[s._v("go get")]),s._v("命令可以下载依赖包，并且还可以指定下载的版本。")]),s._v(" "),t("ol",[t("li",[s._v("运行"),t("code",[s._v("go get -u")]),s._v("将会升级到最新的次要版本或者修订版本(x.y.z, z是修订版本号， y是次要版本号)")]),s._v(" "),t("li",[s._v("运行"),t("code",[s._v("go get -u=patch")]),s._v("将会升级到最新的修订版本")]),s._v(" "),t("li",[s._v("运行"),t("code",[s._v("go get package@version")]),s._v("将会升级到指定的版本号version")])]),s._v(" "),t("p",[s._v("如果下载所有依赖可以使用"),t("code",[s._v("go mod download")]),s._v("命令。")]),s._v(" "),t("h3",{attrs:{id:"整理依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#整理依赖"}},[s._v("#")]),s._v(" 整理依赖")]),s._v(" "),t("p",[s._v("我们在代码中删除依赖代码后，相关的依赖库并不会在"),t("code",[s._v("go.mod")]),s._v("文件中自动移除。这种情况下我们可以使用"),t("code",[s._v("go mod tidy")]),s._v("命令更新"),t("code",[s._v("go.mod")]),s._v("中的依赖关系。")]),s._v(" "),t("h3",{attrs:{id:"go-mod-edit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#go-mod-edit"}},[s._v("#")]),s._v(" go mod edit")]),s._v(" "),t("h4",{attrs:{id:"格式化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#格式化"}},[s._v("#")]),s._v(" 格式化")]),s._v(" "),t("p",[s._v("因为我们可以手动修改go.mod文件，所以有些时候需要格式化该文件。Go提供了一下命令：")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("go mod edit -fmt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"添加依赖项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖项"}},[s._v("#")]),s._v(" 添加依赖项")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("go mod edit -require"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("golang.org/x/text\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"移除依赖项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#移除依赖项"}},[s._v("#")]),s._v(" 移除依赖项")]),s._v(" "),t("p",[s._v("如果只是想修改"),t("code",[s._v("go.mod")]),s._v("文件中的内容，那么可以运行"),t("code",[s._v("go mod edit -droprequire=package path")]),s._v("，比如要在"),t("code",[s._v("go.mod")]),s._v("中移除"),t("code",[s._v("golang.org/x/text")]),s._v("包，可以使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("go mod edit -droprequire"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("golang.org/x/text\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("关于"),t("code",[s._v("go mod edit")]),s._v("的更多用法可以通过"),t("code",[s._v("go help mod edit")]),s._v("查看。")]),s._v(" "),t("h2",{attrs:{id:"在项目中使用go-module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在项目中使用go-module"}},[s._v("#")]),s._v(" 在项目中使用go module")]),s._v(" "),t("h3",{attrs:{id:"既有项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#既有项目"}},[s._v("#")]),s._v(" 既有项目")]),s._v(" "),t("p",[s._v("如果需要对一个已经存在的项目启用"),t("code",[s._v("go module")]),s._v("，可以按照以下步骤操作：")]),s._v(" "),t("ol",[t("li",[s._v("在项目目录下执行"),t("code",[s._v("go mod init")]),s._v("，生成一个"),t("code",[s._v("go.mod")]),s._v("文件。")]),s._v(" "),t("li",[s._v("执行"),t("code",[s._v("go get")]),s._v("，查找并记录当前项目的依赖，同时生成一个"),t("code",[s._v("go.sum")]),s._v("记录每个依赖库的版本和哈希值。")])]),s._v(" "),t("h3",{attrs:{id:"新项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新项目"}},[s._v("#")]),s._v(" 新项目")]),s._v(" "),t("p",[s._v("对于一个新创建的项目，我们可以在项目文件夹下按照以下步骤操作：")]),s._v(" "),t("ol",[t("li",[s._v("执行"),t("code",[s._v("go mod init 项目名")]),s._v("命令，在当前项目文件夹下创建一个"),t("code",[s._v("go.mod")]),s._v("文件。")]),s._v(" "),t("li",[s._v("手动编辑"),t("code",[s._v("go.mod")]),s._v("中的require依赖项或执行"),t("code",[s._v("go get")]),s._v("自动发现、维护依赖。")])])])}),[],!1,null,null,null);a.default=r.exports}}]);