(window.webpackJsonp=window.webpackJsonp||[]).push([[860],{1556:function(s,n,e){"use strict";e.r(n);var a=e(5),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"第一个-kubernetes-容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第一个-kubernetes-容器"}},[s._v("#")]),s._v(" 第一个 Kubernetes 容器")]),s._v(" "),e("h2",{attrs:{id:"检查组件运行状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查组件运行状态"}},[s._v("#")]),s._v(" 检查组件运行状态")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    kubectl get cs\n    \n    # 输出如下\n    NAME                 STATUS    MESSAGE             ERROR\n    # 调度服务，主要作用是将 POD 调度到 Node\n    scheduler            Healthy   ok                  \n    # 自动化修复服务，主要作用是 Node 宕机后自动修复 Node 回到正常的工作状态\n    controller-manager   Healthy   ok                  \n    # 服务注册与发现\n    etcd-0               Healthy   {"health":"true"} \n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h2",{attrs:{id:"检查-master-状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查-master-状态"}},[s._v("#")]),s._v(" 检查 Master 状态")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl cluster-info\n    \n    # 输出如下\n    # 主节点状态\n    Kubernetes master is running at https://192.168.141.130:6443\n    # DNS 状态\n    KubeDNS is running at https://192.168.141.130:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n    \n    To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"检查-nodes-状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查-nodes-状态"}},[s._v("#")]),s._v(" 检查 Nodes 状态")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl get nodes\n    \n    # 输出如下，STATUS 为 Ready 即为正常状态\n    NAME                STATUS   ROLES    AGE     VERSION\n    kubernetes-master   Ready    master   44h     v1.14.1\n    kubernetes-slave1   Ready    <none>   3h38m   v1.14.1\n    kubernetes-slave2   Ready    <none>   3h37m   v1.14.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"运行第一个容器实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行第一个容器实例"}},[s._v("#")]),s._v(" 运行第一个容器实例")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    # 使用 kubectl 命令创建两个监听 80 端口的 Nginx Pod（Kubernetes 运行容器的最小单元）\n    kubectl run nginx --image=nginx --replicas=2 --port=80\n    \n    # 输出如下\n    kubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead.\n    deployment.apps/nginx created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"查看全部-pods-的状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看全部-pods-的状态"}},[s._v("#")]),s._v(" 查看全部 Pods 的状态")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl get pods\n    \n    # 输出如下，需要等待一小段实践，STATUS 为 Running 即为运行成功\n    NAME                     READY   STATUS    RESTARTS   AGE\n    nginx-755464dd6c-qnmwp   1/1     Running   0          90m\n    nginx-755464dd6c-shqrp   1/1     Running   0          90m\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"查看已部署的服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看已部署的服务"}},[s._v("#")]),s._v(" 查看已部署的服务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl get deployment\n    \n    # 输出如下\n    NAME    READY   UP-TO-DATE   AVAILABLE   AGE\n    nginx   2/2     2            2           91m\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"映射服务-让用户可以访问"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#映射服务-让用户可以访问"}},[s._v("#")]),s._v(" 映射服务，让用户可以访问")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl expose deployment nginx --port=80 --type=LoadBalancer\n    \n    # 输出如下\n    service/nginx exposed\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"查看已发布的服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看已发布的服务"}},[s._v("#")]),s._v(" 查看已发布的服务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl get services\n    \n    # 输出如下\n    NAME         TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE\n    kubernetes   ClusterIP      10.96.0.1        <none>        443/TCP        44h\n    # 由此可见，Nginx 服务已成功发布并将 80 端口映射为 31738\n    nginx        LoadBalancer   10.108.121.244   <pending>     80:31738/TCP   88m\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"查看服务详情"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看服务详情"}},[s._v("#")]),s._v(" 查看服务详情")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    kubectl describe service nginx\n    \n    # 输出如下\n    Name:                     nginx\n    Namespace:                default\n    Labels:                   run=nginx\n    Annotations:              <none>\n    Selector:                 run=nginx\n    Type:                     LoadBalancer\n    IP:                       10.108.121.244\n    Port:                     <unset>  80/TCP\n    TargetPort:               80/TCP\n    NodePort:                 <unset>  31738/TCP\n    Endpoints:                192.168.17.5:80,192.168.8.134:80\n    Session Affinity:         None\n    External Traffic Policy:  Cluster\n    Events:                   <none>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("h2",{attrs:{id:"验证是否成功"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#验证是否成功"}},[s._v("#")]),s._v(" 验证是否成功")]),s._v(" "),e("p",[s._v("通过浏览器访问 Master 服务器")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    http://192.168.141.130:31738/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("此时 Kubernetes 会以负载均衡的方式访问部署的 Nginx 服务，能够正常看到 Nginx 的欢迎页即表示成功。容器实际部署在其它 Node 节点上，通过访问 Node 节点的 IP:Port 也是可以的。")]),s._v(" "),e("h2",{attrs:{id:"停止服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#停止服务"}},[s._v("#")]),s._v(" 停止服务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    kubectl delete deployment nginx\n    \n    # 输出如下\n    deployment.extensions "nginx" deleted\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    kubectl delete service nginx\n    \n    # 输出如下\n    service "nginx" deleted\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);