(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{725:function(a,s,t){"use strict";t.r(s);var e=t(5),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"kibana入门"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana入门"}},[a._v("#")]),a._v(" Kibana入门")]),a._v(" "),t("p",[a._v("Kibana 是一款开源的数据分析和可视化平台，它是 Elastic Stack 成员之一，设计用于和 Elasticsearch 协作。您可以使用 Kibana 对 Elasticsearch 索引中的数据进行搜索、查看、交互操作。您可以很方便的利用图表、表格及地图对数据进行多元化的分析和呈现。")]),a._v(" "),t("p",[a._v("官网：https://www.elastic.co/cn/kibana")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924193926486.png",alt:"image-20200924193926486"}})]),a._v(" "),t("h2",{attrs:{id:"配置和安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置和安装"}},[a._v("#")]),a._v(" 配置和安装")]),a._v(" "),t("p",[a._v("到下载地址，选择对应的版本：https://www.elastic.co/cn/downloads/kibana")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924194324366.png",alt:"image-20200924194324366"}}),a._v("下载完成后，将文件拷贝到我们的服务器上，然后解压")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 解压")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -zxvf kibana-7.9.1-linux-x86_64.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重命名")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" kibana-7.9.1-linux-x86_64 kibana\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("p",[a._v("然后在进入kibana目录，找到config文件夹下的kibana.yml进行配置的修改")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /soft/kibana/config/kibana.yml\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("然后找到下面的内容")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#对外暴露服务的地址")]),a._v("\nserver.host: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.0.0.0"')]),a._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#配置Elasticsearch")]),a._v("\nelasticsearch.url: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://127.0.0.1:9200"')]),a._v(" \n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("h2",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),t("p",[a._v("修改配置完成后，我们就可以启动kibana了")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启动")]),a._v("\n./bin/kibana\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("点击启动，发现报错了")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924195011533.png",alt:"image-20200924195011533"}})]),a._v(" "),t("p",[a._v("原因是kibana不能使用root用户进行启动，所以我们切换到elsearch用户")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将soft文件夹的所属者改成elsearch")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" elsearch:elsearch /soft/ -R\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 切换用户")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" elsearch\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动")]),a._v("\n./bin/kibana\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br")])]),t("p",[a._v("然后打开下面的地址，即可访问我们的kibana了")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("http://202.193.56.222:5601/\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/image-20200924200502907.png",alt:"image-20200924200502907"}})]),a._v(" "),t("h2",{attrs:{id:"功能说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#功能说明"}},[a._v("#")]),a._v(" 功能说明")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924200615995.png",alt:"image-20200924200615995"}})]),a._v(" "),t("ul",[t("li",[a._v("Discover：数据探索")]),a._v(" "),t("li",[a._v("Visualize：可视化")]),a._v(" "),t("li",[a._v("Dashboard：仪表盘")]),a._v(" "),t("li",[a._v("Timelion：时序控件")]),a._v(" "),t("li",[a._v("Canvas：画布")]),a._v(" "),t("li",[a._v("Machine Learning：机器学习")]),a._v(" "),t("li",[a._v("Infrastructure：基本信息")]),a._v(" "),t("li",[a._v("Logs：数据日志展示")]),a._v(" "),t("li",[a._v("APM：性能监控")]),a._v(" "),t("li",[a._v("Dev Tools：开发者工具")]),a._v(" "),t("li",[a._v("Monitoring：监控")]),a._v(" "),t("li",[a._v("Management：管理")])]),a._v(" "),t("h2",{attrs:{id:"数据探索"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据探索"}},[a._v("#")]),a._v(" 数据探索")]),a._v(" "),t("p",[a._v("先添加索引信息")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924201110208.png",alt:"image-20200924201110208"}})]),a._v(" "),t("p",[a._v("然后我们就输入匹配规则进行匹配")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924201234997.png",alt:"image-20200924201234997"}})]),a._v(" "),t("p",[a._v("然后选择时间字段，一般选择第一个")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924201312845.png",alt:"image-20200924201312845"}})]),a._v(" "),t("p",[a._v("索引创建完毕后")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924201354838.png",alt:"image-20200924201354838"}})]),a._v(" "),t("p",[a._v("然后我们就可以往nginx error.log日志文件中，添加几天错误记录")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hello error"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" error.log\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("我们追加了两条数据，然后到kibana的discover中，刷新页面，就能够看到我们刚添加的日志了，同时我们点击右侧还可以选择需要展示的字段，非常的方便")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924201952010.png",alt:"image-20200924201952010"}})]),a._v(" "),t("p",[a._v("点击右上角，我们还可以针对时间来进行过滤")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924202210114.png",alt:"image-20200924202210114"}})]),a._v(" "),t("h2",{attrs:{id:"metricbeat仪表盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#metricbeat仪表盘"}},[a._v("#")]),a._v(" Metricbeat仪表盘")]),a._v(" "),t("p",[a._v("现在将Metricbeat的数据展示在Kibana中，首先需要修改我们的MetricBeat配置")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#修改metricbeat配置")]),a._v("\nsetup.kibana:\n  host: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.40.133:5601"')]),a._v("\n  \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#安装仪表盘到Kibana【需要确保Kibana在正常运行，这个过程可能会有些耗时】")]),a._v("\n./metricbeat setup --dashboards\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("p",[a._v("安装完成后，如下所示")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924203831606.png",alt:"image-20200924203831606"}})]),a._v(" "),t("p",[a._v("然后我们启动Metricbeat")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("./metricbeat -e\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("然后到kibana页面下，找到我们刚刚安装的仪表盘")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924204708099.png",alt:"image-20200924204708099"}})]),a._v(" "),t("p",[a._v("然后我们就能够看到非常多的指标数据了")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924204636176.png",alt:"image-20200924204636176"}})]),a._v(" "),t("h2",{attrs:{id:"nginx指标仪表盘【metricbeat】"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx指标仪表盘【metricbeat】"}},[a._v("#")]),a._v(" Nginx指标仪表盘【Metricbeat】")]),a._v(" "),t("p",[a._v("选择Metricbeat的nginx仪表盘即可")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924205523107.png",alt:"image-20200924205523107"}})]),a._v(" "),t("p",[a._v("然后就能够看到Nginx的指标信息了")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924205552446.png",alt:"image-20200924205552446"}})]),a._v(" "),t("h2",{attrs:{id:"nginx日志仪表盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx日志仪表盘"}},[a._v("#")]),a._v(" Nginx日志仪表盘")]),a._v(" "),t("p",[a._v("我们可以和刚刚Metricbeat的仪表盘一样，也可以将filebeat收集的日志记录，推送到Kibana中")]),a._v(" "),t("p",[a._v("首先我们需要修改filebeat的 mogublog-nginx.yml配置文件")]),a._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("filebeat.inputs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("setup.template.settings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("index.number_of_shards")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("output.elasticsearch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("hosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:9200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("filebeat.config.modules")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("path.config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("/modules.d/"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("*.yml")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("reload.enabled")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("setup.kibana")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("host")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:5601"')]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br")])]),t("p",[a._v("然后按照仪表盘")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("./filebeat -c mogublog-nginx.yml setup\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("等待一会后，仪表盘也安装成功了")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924210454873.png",alt:"image-20200924210454873"}})]),a._v(" "),t("p",[a._v("然后我们启动filebeat即可")]),a._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("./filebeat -e -c mogublog-nginx.yml\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("启动完成后，我们回到我们的Kibana中，找到Dashboard，添加我们的filebeat - nginx即可")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924210913557.png",alt:"image-20200924210913557"}})]),a._v(" "),t("p",[a._v("然后就能看到我们的仪表盘了，上图就是请求的来源")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924210816489.png",alt:"image-20200924210816489"}})]),a._v(" "),t("blockquote",[t("p",[a._v("需要注意的是，这些仪表盘本身是没有的，我们需要通过filebeat来进行安装")])]),a._v(" "),t("h2",{attrs:{id:"kibana自定义仪表盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana自定义仪表盘"}},[a._v("#")]),a._v(" Kibana自定义仪表盘")]),a._v(" "),t("p",[a._v("在Kibana中，我们也可以自定义图标，如制作柱形图")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924211227780.png",alt:"image-20200924211227780"}})]),a._v(" "),t("p",[a._v("我们选择最下面的 Vertical Bar，也就是柱形图，然后在选择我们的索引")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924211318386.png",alt:"image-20200924211318386"}})]),a._v(" "),t("p",[a._v("这样就出来了")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924211427643.png",alt:"image-20200924211427643"}})]),a._v(" "),t("h2",{attrs:{id:"开发者工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开发者工具"}},[a._v("#")]),a._v(" 开发者工具")]),a._v(" "),t("p",[a._v("在Kibana中，为开发者的测试提供了便捷的工具使用，如下：")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924211727920.png",alt:"image-20200924211727920"}})]),a._v(" "),t("p",[a._v("我们就可以在这里面写一些请求了")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/image-20200924212137167.png",alt:"image-20200924212137167"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);