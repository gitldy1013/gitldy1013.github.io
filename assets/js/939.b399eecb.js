(window.webpackJsonp=window.webpackJsonp||[]).push([[939],{1634:function(s,n,a){"use strict";a.r(n);var t=a(5),r=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"创建服务提供者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建服务提供者"}},[s._v("#")]),s._v(" 创建服务提供者")]),s._v(" "),a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),a("p",[s._v("通过一个简单的示例来感受一下如何将服务注册到 Nacos，其实和 Eureka 没有太大差别。")]),s._v(" "),a("h2",{attrs:{id:"pom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pom"}},[s._v("#")]),s._v(" POM")]),s._v(" "),a("p",[s._v("创建一个工程名为 "),a("code",[s._v("hello-spring-cloud-alibaba-nacos-provider")]),s._v(" 的服务提供者项目，"),a("code",[s._v("pom.xml")]),s._v(" 配置如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('    <?xml version="1.0" encoding="UTF-8"?>\n    <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n             xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n        <modelVersion>4.0.0</modelVersion>\n    \n        <parent>\n            <groupId>com.cmcc</groupId>\n            <artifactId>hello-spring-cloud-alibaba-dependencies</artifactId>\n            <version>1.0.0-SNAPSHOT</version>\n            <relativePath>../hello-spring-cloud-alibaba-dependencies/pom.xml</relativePath>\n        </parent>\n    \n        <artifactId>hello-spring-cloud-alibaba-nacos-provider</artifactId>\n        <packaging>jar</packaging>\n    \n        <name>hello-spring-cloud-alibaba-nacos-provider</name>\n        <url>http://www.cmcc.com</url>\n        <inceptionYear>2018-Now</inceptionYear>\n    \n        <dependencies>\n            \x3c!-- Spring Boot Begin --\x3e\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-web</artifactId>\n            </dependency>\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-actuator</artifactId>\n            </dependency>\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-test</artifactId>\n                <scope>test</scope>\n            </dependency>\n            \x3c!-- Spring Boot End --\x3e\n    \n            \x3c!-- Spring Cloud Begin --\x3e\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>\n            </dependency>\n            \x3c!-- Spring Cloud End --\x3e\n        </dependencies>\n    \n        <build>\n            <plugins>\n                <plugin>\n                    <groupId>org.springframework.boot</groupId>\n                    <artifactId>spring-boot-maven-plugin</artifactId>\n                    <configuration>\n                        <mainClass>com.cmcc.hello.spring.cloud.alibaba.nacos.provider.NacosProviderApplication</mainClass>\n                    </configuration>\n                </plugin>\n            </plugins>\n        </build>\n    </project>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br")])]),a("h2",{attrs:{id:"application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#application"}},[s._v("#")]),s._v(" Application")]),s._v(" "),a("p",[s._v("通过 "),a("code",[s._v("@EnableDiscoveryClient")]),s._v(" 注解表明是一个 Nacos 客户端，该注解是 Spring Cloud 提供的原生注解")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('    package com.cmcc.hello.spring.cloud.alibaba.nacos.provider;\n    \n    import org.springframework.boot.SpringApplication;\n    import org.springframework.boot.autoconfigure.SpringBootApplication;\n    import org.springframework.cloud.client.discovery.EnableDiscoveryClient;\n    import org.springframework.web.bind.annotation.GetMapping;\n    import org.springframework.web.bind.annotation.PathVariable;\n    import org.springframework.web.bind.annotation.RestController;\n    \n    @SpringBootApplication\n    @EnableDiscoveryClient\n    public class NacosProviderApplication {\n        public static void main(String[] args) {\n            SpringApplication.run(NacosProviderApplication.class, args);\n        }\n    \n        @RestController\n        public class EchoController {\n            @GetMapping(value = "/echo/{message}")\n            public String echo(@PathVariable String message) {\n                return "Hello Nacos Discovery " + message;\n            }\n        }\n    }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h2",{attrs:{id:"application-yml"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#application-yml"}},[s._v("#")]),s._v(" application.yml")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('    spring:\n      application:\n        name: nacos-provider\n      cloud:\n        nacos:\n          discovery:\n            server-addr: 127.0.0.1:8848\n    \n    server:\n      port: 8081\n    \n    management:\n      endpoints:\n        web:\n          exposure:\n            include: "*"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h2",{attrs:{id:"启动工程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动工程"}},[s._v("#")]),s._v(" 启动工程")]),s._v(" "),a("p",[s._v("通过浏览器访问 "),a("code",[s._v("http://localhost:8848/nacos")]),s._v("，即 Nacos Server 网址")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/20190105063653.png",alt:""}})]),s._v(" "),a("p",[s._v("你会发现一个服务已经注册在服务中了，服务名为 "),a("code",[s._v("nacos-provider")])]),s._v(" "),a("p",[s._v("这时打开 "),a("code",[s._v("http://localhost:8081/echo/hi")]),s._v(" ，你会在浏览器上看到：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    Hello Nacos Discovery hi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"服务的端点检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务的端点检查"}},[s._v("#")]),s._v(" 服务的端点检查")]),s._v(" "),a("p",[s._v("spring-cloud-starter-alibaba-nacos-discovery 在实现的时候提供了一个 EndPoint, EndPoint 的访问地址为 "),a("code",[s._v("http://ip:port/actuator/nacos-discovery")]),s._v("。 EndPoint 的信息主要提供了两类:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    1、subscribe: 显示了当前有哪些服务订阅者\n    2、NacosDiscoveryProperties: 显示了当前服务实例关于 Nacos 的基础配置\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("通过浏览器访问 "),a("code",[s._v("http://localhost:8081/actuator/nacos-discovery")]),s._v(" 你会在浏览器上看到：")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/20190105064504.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"附-nacos-starter-更多配置项信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附-nacos-starter-更多配置项信息"}},[s._v("#")]),s._v(" 附：Nacos Starter 更多配置项信息")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("配置项")]),s._v(" "),a("th",[s._v("Key")]),s._v(" "),a("th",[s._v("默认值")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("服务端地址")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.server-addr")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("Nacos Server 启动监听的ip地址和端口")])]),s._v(" "),a("tr",[a("td",[s._v("服务名")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.service")]),s._v(" "),a("td",[s._v("${spring.application.name}")]),s._v(" "),a("td",[s._v("给当前的服务命名")])]),s._v(" "),a("tr",[a("td",[s._v("权重")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.weight")]),s._v(" "),a("td",[s._v("1")]),s._v(" "),a("td",[s._v("取值范围 1 到 100，数值越大，权重越大")])]),s._v(" "),a("tr",[a("td",[s._v("网卡名")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.network-interface")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("当IP未配置时，注册的IP为此网卡所对应的IP地址，如果此项也未配置，则默认取第一块网卡的地址")])]),s._v(" "),a("tr",[a("td",[s._v("注册的IP地址")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.ip")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("优先级最高")])]),s._v(" "),a("tr",[a("td",[s._v("注册的端口")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.port")]),s._v(" "),a("td",[s._v("-1")]),s._v(" "),a("td",[s._v("默认情况下不用配置，会自动探测")])]),s._v(" "),a("tr",[a("td",[s._v("命名空间")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.namespace")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("常用场景之一是不同环境的注册的区分隔离，例如开发测试环境和生产环境的资源（如配置、服务）隔离等。")])]),s._v(" "),a("tr",[a("td",[s._v("AccessKey")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.access-key")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("当要上阿里云时，阿里云上面的一个云账号名")])]),s._v(" "),a("tr",[a("td",[s._v("SecretKey")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.secret-key")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("当要上阿里云时，阿里云上面的一个云账号密码")])]),s._v(" "),a("tr",[a("td",[s._v("Metadata")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.metadata")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td",[s._v("使用 Map 格式配置，用户可以根据自己的需要自定义一些和服务相关的元数据信息")])]),s._v(" "),a("tr",[a("td",[s._v("日志文件名")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.log-name")]),s._v(" "),a("td",[s._v("无")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("接入点")]),s._v(" "),a("td",[s._v("spring.cloud.nacos.discovery.enpoint")]),s._v(" "),a("td",[s._v("UTF-8")]),s._v(" "),a("td",[s._v("地域的某个服务的入口域名，通过此域名可以动态地拿到服务端地址")])]),s._v(" "),a("tr",[a("td",[s._v("是否集成 Ribbon")]),s._v(" "),a("td",[s._v("ribbon.nacos.enabled")]),s._v(" "),a("td",[s._v("true")]),s._v(" "),a("td",[s._v("一般都设置成 true 即可")])])])])])}),[],!1,null,null,null);n.default=r.exports}}]);