(window.webpackJsonp=window.webpackJsonp||[]).push([[1030],{1726:function(n,a,t){"use strict";t.r(a);var s=t(5),e=Object(s.a)({},(function(){var n=this,a=n.$createElement,t=n._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h1",{attrs:{id:"使用-spring-注解管理事务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-spring-注解管理事务"}},[n._v("#")]),n._v(" 使用 Spring 注解管理事务")]),n._v(" "),t("h2",{attrs:{id:"概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[n._v("#")]),n._v(" 概述")]),n._v(" "),t("p",[n._v("通过 "),t("code",[n._v("@Transactional")]),n._v(" 注解方式，也可将事务织入到相应方法中。而使用注解方式，只需在配置文件中加入一个 "),t("code",[n._v("tx")]),n._v(" 标签，以告诉 Spring 使用注解来完成事务的织入。该标签只需指定一个属性，事务管理器。")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('    \x3c!-- 开启事务注解驱动 --\x3e\n    <tx:annotation-driven transaction-manager="transactionManager" />\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br")])]),t("h2",{attrs:{id:"transactional-注解简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#transactional-注解简介"}},[n._v("#")]),n._v(" "),t("code",[n._v("@Transactional")]),n._v(" 注解简介")]),n._v(" "),t("p",[t("code",[n._v("@Transactional")]),n._v(" 的所有可选属性：")]),n._v(" "),t("ul",[t("li",[t("code",[n._v("propagation")]),n._v("：用于设置事务传播属性。该属性类型为 Propagation 枚举，默认值为 "),t("code",[n._v("Propagation.REQUIRED")]),n._v("。")]),n._v(" "),t("li",[t("code",[n._v("isolation")]),n._v("：用于设置事务的隔离级别。该属性类型为 Isolation 枚举 ，默认值为 "),t("code",[n._v("Isolation.DEFAULT")]),n._v("。")]),n._v(" "),t("li",[t("code",[n._v("readOnly")]),n._v("：用于设置该方法对数据库的操作是否是只读的。该属性为 boolean，默认值为 "),t("code",[n._v("false")]),n._v("。")]),n._v(" "),t("li",[t("code",[n._v("timeout")]),n._v("：用于设置本操作与数据库连接的超时时限。单位为秒，类型为 int，默认值为 -1，即没有时限。")]),n._v(" "),t("li",[t("code",[n._v("rollbackFor")]),n._v("：指定需要回滚的异常类。类型为 "),t("code",[n._v("Class[]")]),n._v("，默认值为空数组。当然，若只有一个异常类时，可以不使用数组。")]),n._v(" "),t("li",[t("code",[n._v("rollbackForClassName")]),n._v("：指定需要回滚的异常类类名。类型为 "),t("code",[n._v("String[]")]),n._v("，默认值为空数组。当然，若只有一个异常类时，可以不使用数组。")]),n._v(" "),t("li",[t("code",[n._v("noRollbackFor")]),n._v("：指定不需要回滚的异常类。类型为 "),t("code",[n._v("Class[]")]),n._v("，默认值为空数组。当然，若只有一个异常类时，可以不使用数组。")]),n._v(" "),t("li",[t("code",[n._v("noRollbackForClassName")]),n._v("： 指定不需要回滚的异常类类名。类型为 "),t("code",[n._v("String[]")]),n._v("，默认值为空数组。当然，若只有一个异常类时，可以不使用数组。")])]),n._v(" "),t("p",[n._v("需要注意的是，"),t("code",[n._v("@Transactional")]),n._v(" 若用在方法上，只能用于 "),t("code",[n._v("public")]),n._v(" 方法上。对于其他非 "),t("code",[n._v("public")]),n._v(" 方法，如果加上了注解 "),t("code",[n._v("@Transactional")]),n._v("，虽然 Spring 不会报错，但不会将指定事务织入到该方法中。因为 Spring 会忽略掉所有非 "),t("code",[n._v("public")]),n._v(" 方法上的 "),t("code",[n._v("@Transaction")]),n._v(" 注解。")]),n._v(" "),t("p",[n._v("若 "),t("code",[n._v("@Transaction")]),n._v(" 注解在类上，则表示该类上所有的方法均将在执行时织入事务。")]),n._v(" "),t("h2",{attrs:{id:"使用-transaction-注解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-transaction-注解"}},[n._v("#")]),n._v(" 使用 "),t("code",[n._v("@Transaction")]),n._v(" 注解")]),n._v(" "),t("p",[n._v("使用起来很简单，只需要在需要增加事务的业务类上增加 "),t("code",[n._v("@Transaction")]),n._v(" 注解即可，案例代码如下：")]),n._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[n._v('    package com.hello.spring.transaction.aspectsj.aop.service.impl;\n    \n    import com.hello.spring.transaction.aspectsj.aop.dao.TbContentCategoryDao;\n    import com.hello.spring.transaction.aspectsj.aop.domain.TbContent;\n    import com.hello.spring.transaction.aspectsj.aop.domain.TbContentCategory;\n    import com.hello.spring.transaction.aspectsj.aop.service.TbContentCategoryService;\n    import com.hello.spring.transaction.aspectsj.aop.service.TbContentService;\n    import org.springframework.beans.factory.annotation.Autowired;\n    import org.springframework.stereotype.Service;\n    import org.springframework.transaction.annotation.Transactional;\n    \n    @Transactional\n    @Service(value = "tbContentCategoryService")\n    public class TbContentCategoryServiceImpl implements TbContentCategoryService {\n    \n        @Autowired\n        private TbContentCategoryDao tbContentCategoryDao;\n    \n        @Autowired\n        private TbContentService tbContentService;\n    \n        public void save(TbContentCategory tbContentCategory, TbContent tbContent) {\n            tbContentCategoryDao.insert(tbContentCategory);\n            tbContentService.save(tbContent);\n        }\n    }\n')])]),n._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[n._v("1")]),t("br"),t("span",{staticClass:"line-number"},[n._v("2")]),t("br"),t("span",{staticClass:"line-number"},[n._v("3")]),t("br"),t("span",{staticClass:"line-number"},[n._v("4")]),t("br"),t("span",{staticClass:"line-number"},[n._v("5")]),t("br"),t("span",{staticClass:"line-number"},[n._v("6")]),t("br"),t("span",{staticClass:"line-number"},[n._v("7")]),t("br"),t("span",{staticClass:"line-number"},[n._v("8")]),t("br"),t("span",{staticClass:"line-number"},[n._v("9")]),t("br"),t("span",{staticClass:"line-number"},[n._v("10")]),t("br"),t("span",{staticClass:"line-number"},[n._v("11")]),t("br"),t("span",{staticClass:"line-number"},[n._v("12")]),t("br"),t("span",{staticClass:"line-number"},[n._v("13")]),t("br"),t("span",{staticClass:"line-number"},[n._v("14")]),t("br"),t("span",{staticClass:"line-number"},[n._v("15")]),t("br"),t("span",{staticClass:"line-number"},[n._v("16")]),t("br"),t("span",{staticClass:"line-number"},[n._v("17")]),t("br"),t("span",{staticClass:"line-number"},[n._v("18")]),t("br"),t("span",{staticClass:"line-number"},[n._v("19")]),t("br"),t("span",{staticClass:"line-number"},[n._v("20")]),t("br"),t("span",{staticClass:"line-number"},[n._v("21")]),t("br"),t("span",{staticClass:"line-number"},[n._v("22")]),t("br"),t("span",{staticClass:"line-number"},[n._v("23")]),t("br"),t("span",{staticClass:"line-number"},[n._v("24")]),t("br"),t("span",{staticClass:"line-number"},[n._v("25")]),t("br"),t("span",{staticClass:"line-number"},[n._v("26")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);