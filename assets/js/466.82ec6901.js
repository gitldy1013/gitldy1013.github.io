(window.webpackJsonp=window.webpackJsonp||[]).push([[466],{1162:function(e,v,a){"use strict";a.r(v);var r=a(5),s=Object(r.a)({},(function(){var e=this,v=e.$createElement,a=e._self._c||v;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"docker-machine-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-machine-使用"}},[e._v("#")]),e._v(" Docker Machine 使用")]),e._v(" "),a("p",[e._v("Docker Machine 支持多种后端驱动，包括虚拟机、本地主机和云平台等。")]),e._v(" "),a("h2",{attrs:{id:"创建本地主机实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建本地主机实例"}},[e._v("#")]),e._v(" 创建本地主机实例")]),e._v(" "),a("h3",{attrs:{id:"virtualbox-驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#virtualbox-驱动"}},[e._v("#")]),e._v(" Virtualbox 驱动")]),e._v(" "),a("p",[e._v("使用 "),a("code",[e._v("virtualbox")]),e._v(" 类型的驱动，创建一台 Docker 主机，命名为 test。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ docker-machine create -d virtualbox test\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("你也可以在创建时加上如下参数，来配置主机或者主机上的 Docker。")]),e._v(" "),a("p",[a("code",[e._v("--engine-opt dns=114.114.114.114")]),e._v(" 配置 Docker 的默认 DNS")]),e._v(" "),a("p",[a("code",[e._v("--engine-registry-mirror https://registry.docker-cn.com")]),e._v(" 配置 Docker 的仓库镜像")]),e._v(" "),a("p",[a("code",[e._v("--virtualbox-memory 2048")]),e._v(" 配置主机内存")]),e._v(" "),a("p",[a("code",[e._v("--virtualbox-cpu-count 2")]),e._v(" 配置主机 CPU")]),e._v(" "),a("p",[e._v("更多参数请使用 "),a("code",[e._v("docker-machine create --driver virtualbox --help")]),e._v(" 命令查看。")]),e._v(" "),a("h3",{attrs:{id:"macos-xhyve-驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#macos-xhyve-驱动"}},[e._v("#")]),e._v(" macOS xhyve 驱动")]),e._v(" "),a("p",[a("code",[e._v("xhyve")]),e._v(" 驱动 GitHub: https://github.com/zchee/docker-machine-driver-xhyve")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/mist64/xhyve",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("xhyve")]),a("OutboundLink")],1),e._v(" 是 macOS 上轻量化的虚拟引擎，使用其创建的 Docker Machine 较 "),a("code",[e._v("VirtualBox")]),e._v(" 驱动创建的运行效率要高。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ brew install docker-machine-driver-xhyve\n    \n    $ docker-machine create \\\n          -d xhyve \\\n          # --xhyve-boot2docker-url ~/.docker/machine/cache/boot2docker.iso \\\n          --engine-opt dns=114.114.114.114 \\\n          --engine-registry-mirror https://registry.docker-cn.com \\\n          --xhyve-memory-size 2048 \\\n          --xhyve-rawdisk \\\n          --xhyve-cpu-count 2 \\\n          xhyve\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br")])]),a("blockquote",[a("p",[e._v("注意：非首次创建时建议加上 "),a("code",[e._v("--xhyve-boot2docker-url ~/.docker/machine/cache/boot2docker.iso")]),e._v(" 参数，避免每次创建时都从 GitHub 下载 ISO 镜像。")])]),e._v(" "),a("p",[e._v("更多参数请使用 "),a("code",[e._v("docker-machine create --driver xhyve --help")]),e._v(" 命令查看。")]),e._v(" "),a("h3",{attrs:{id:"windows-10"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows-10"}},[e._v("#")]),e._v(" Windows 10")]),e._v(" "),a("p",[e._v("Windows 10 安装 Docker for Windows 之后不能再安装 VirtualBox，也就不能使用 "),a("code",[e._v("virtualbox")]),e._v(" 驱动来创建 Docker Machine，我们可以选择使用 "),a("code",[e._v("hyperv")]),e._v(" 驱动。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ docker-machine create --driver hyperv vm\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("更多参数请使用 "),a("code",[e._v("docker-machine create --driver hyperv --help")]),e._v(" 命令查看。")]),e._v(" "),a("h2",{attrs:{id:"使用介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用介绍"}},[e._v("#")]),e._v(" 使用介绍")]),e._v(" "),a("p",[e._v("创建好主机之后，查看主机")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ docker-machine ls\n    \n    NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER       ERRORS\n    test      -        virtualbox   Running   tcp://192.168.99.187:2376           v17.10.0-ce\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("创建主机成功后，可以通过 "),a("code",[e._v("env")]),e._v(" 命令来让后续操作对象都是目标主机。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ docker-machine env test\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("后续根据提示在命令行输入命令之后就可以操作 test 主机。")]),e._v(" "),a("p",[e._v("也可以通过 "),a("code",[e._v("SSH")]),e._v(" 登录到主机。")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ docker-machine ssh test\n    \n    docker@test:~$ docker --version\n    Docker version 17.10.0-ce, build f4ffd25\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("连接到主机之后你就可以在其上使用 Docker 了。")]),e._v(" "),a("h2",{attrs:{id:"官方支持驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#官方支持驱动"}},[e._v("#")]),e._v(" 官方支持驱动")]),e._v(" "),a("p",[e._v("通过 "),a("code",[e._v("-d")]),e._v(" 选项可以选择支持的驱动类型。")]),e._v(" "),a("ul",[a("li",[e._v("amazonec2")]),e._v(" "),a("li",[e._v("azure")]),e._v(" "),a("li",[e._v("digitalocean")]),e._v(" "),a("li",[e._v("exoscale")]),e._v(" "),a("li",[e._v("generic")]),e._v(" "),a("li",[e._v("google")]),e._v(" "),a("li",[e._v("hyperv")]),e._v(" "),a("li",[e._v("none")]),e._v(" "),a("li",[e._v("openstack")]),e._v(" "),a("li",[e._v("rackspace")]),e._v(" "),a("li",[e._v("softlayer")]),e._v(" "),a("li",[e._v("virtualbox")]),e._v(" "),a("li",[e._v("vmwarevcloudair")]),e._v(" "),a("li",[e._v("vmwarefusion")]),e._v(" "),a("li",[e._v("vmwarevsphere")])]),e._v(" "),a("h2",{attrs:{id:"第三方驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三方驱动"}},[e._v("#")]),e._v(" 第三方驱动")]),e._v(" "),a("p",[e._v("请到 "),a("a",{attrs:{href:"https://github.com/docker/docker.github.io/blob/master/machine/AVAILABLE_DRIVER_PLUGINS.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("第三方驱动列表"),a("OutboundLink")],1),e._v(" 查看")]),e._v(" "),a("h2",{attrs:{id:"操作命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作命令"}},[e._v("#")]),e._v(" 操作命令")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("active")]),e._v(" 查看活跃的 Docker 主机")]),e._v(" "),a("li",[a("code",[e._v("config")]),e._v(" 输出连接的配置信息")]),e._v(" "),a("li",[a("code",[e._v("create")]),e._v(" 创建一个 Docker 主机")]),e._v(" "),a("li",[a("code",[e._v("env")]),e._v(" 显示连接到某个主机需要的环境变量")]),e._v(" "),a("li",[a("code",[e._v("inspect")]),e._v(" 输出主机更多信息")]),e._v(" "),a("li",[a("code",[e._v("ip")]),e._v(" 获取主机地址")]),e._v(" "),a("li",[a("code",[e._v("kill")]),e._v(" 停止某个主机")]),e._v(" "),a("li",[a("code",[e._v("ls")]),e._v(" 列出所有管理的主机")]),e._v(" "),a("li",[a("code",[e._v("provision")]),e._v(" 重新设置一个已存在的主机")]),e._v(" "),a("li",[a("code",[e._v("regenerate-certs")]),e._v(" 为某个主机重新生成 TLS 认证信息")]),e._v(" "),a("li",[a("code",[e._v("restart")]),e._v(" 重启主机")]),e._v(" "),a("li",[a("code",[e._v("rm")]),e._v(" 删除某台主机")]),e._v(" "),a("li",[a("code",[e._v("ssh")]),e._v(" SSH 到主机上执行命令")]),e._v(" "),a("li",[a("code",[e._v("scp")]),e._v(" 在主机之间复制文件")]),e._v(" "),a("li",[a("code",[e._v("mount")]),e._v(" 挂载主机目录到本地")]),e._v(" "),a("li",[a("code",[e._v("start")]),e._v(" 启动一个主机")]),e._v(" "),a("li",[a("code",[e._v("status")]),e._v(" 查看主机状态")]),e._v(" "),a("li",[a("code",[e._v("stop")]),e._v(" 停止一个主机")]),e._v(" "),a("li",[a("code",[e._v("upgrade")]),e._v(" 更新主机 Docker 版本为最新")]),e._v(" "),a("li",[a("code",[e._v("url")]),e._v(" 获取主机的 URL")]),e._v(" "),a("li",[a("code",[e._v("version")]),e._v(" 输出 docker-machine 版本信息")]),e._v(" "),a("li",[a("code",[e._v("help")]),e._v(" 输出帮助信息")])]),e._v(" "),a("p",[e._v("每个命令，又带有不同的参数，可以通过")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    $ docker-machine COMMAND --help\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("来查看具体的用法。")])])}),[],!1,null,null,null);v.default=s.exports}}]);