(window.webpackJsonp=window.webpackJsonp||[]).push([[957],{1654:function(t,a,n){"use strict";n.r(a);var s=n(5),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"quartz-使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#quartz-使用"}},[t._v("#")]),t._v(" Quartz 使用")]),t._v(" "),n("h2",{attrs:{id:"概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),n("p",[t._v("Quartz 是 OpenSymphony 开源组织在 Job Scheduling 领域又一个开源项目，它可以与 J2EE 与 J2SE 应用程序相结合也可以单独使用。Quartz 可以用来创建简单或为运行十个，百个，甚至是好几万个 Jobs 这样复杂的程序。Jobs 可以做成标准的 Java 组件或 EJBs。")]),t._v(" "),n("h2",{attrs:{id:"为什么使用-quartz"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么使用-quartz"}},[t._v("#")]),t._v(" 为什么使用 Quartz？")]),t._v(" "),n("p",[t._v("Quartz 是一个任务调度框架。比如你遇到这样的问题：")]),t._v(" "),n("ul",[n("li",[t._v("每天 02:00 发送一份工作邮件给工作组成员并抄送给老板（假装自己很努力的工作到深夜）")]),t._v(" "),n("li",[t._v("每月 2 号提醒自己还信用卡或自动还款")]),t._v(" "),n("li",[t._v("每秒钟发 N 笔脏数据给竞争对手公司的服务器（！←_←）")])]),t._v(" "),n("p",[t._v("这些问题总结起来就是：在某一个有规律的时间点干某件事。并且时间的触发的条件可以非常复杂，复杂到需要一个专门的框架来干这个事。Quartz 就是来干这样的事，你给它一个触发条件的定义，它负责到了时间点，触发相应的 Job 起来干活（睡 NMB 起来嗨！）。")]),t._v(" "),n("h2",{attrs:{id:"什么是-cron-表达式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是-cron-表达式"}},[t._v("#")]),t._v(" 什么是 cron 表达式？")]),t._v(" "),n("p",[t._v("cron 是 Linux 系统用来设置计划任务的，比如：每天晚上 12 点重启服务器。")]),t._v(" "),n("h3",{attrs:{id:"格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#格式"}},[t._v("#")]),t._v(" 格式")]),t._v(" "),n("p",[t._v("一个 cron 表达式具体表现就是一个字符串，这个字符串中包含 6~7 个字段，字段之间是由空格分割的，每个字段可以由任何允许的值以及允许的特殊字符所构成，下面表格列出了每个字段所允许的值和特殊字符")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("字段")]),t._v(" "),n("th",[t._v("允许值")]),t._v(" "),n("th",[t._v("允许的特殊字符")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("秒")]),t._v(" "),n("td",[t._v("0-59")]),t._v(" "),n("td",[t._v(", - * /")])]),t._v(" "),n("tr",[n("td",[t._v("分")]),t._v(" "),n("td",[t._v("0-59")]),t._v(" "),n("td",[t._v(", - * /")])]),t._v(" "),n("tr",[n("td",[t._v("小时")]),t._v(" "),n("td",[t._v("0-23")]),t._v(" "),n("td",[t._v(", - * /")])]),t._v(" "),n("tr",[n("td",[t._v("日期")]),t._v(" "),n("td",[t._v("1-31")]),t._v(" "),n("td",[t._v(", - * / L W C")])]),t._v(" "),n("tr",[n("td",[t._v("月份")]),t._v(" "),n("td",[t._v("1-12 或者 JAN-DEC")]),t._v(" "),n("td",[t._v(", - * /")])]),t._v(" "),n("tr",[n("td",[t._v("星期")]),t._v(" "),n("td",[t._v("1-7 或者 SUN-SAT")]),t._v(" "),n("td",[t._v(", - * / L C #")])]),t._v(" "),n("tr",[n("td",[t._v("年（可选）")]),t._v(" "),n("td",[t._v("留空, 1970-2099")]),t._v(" "),n("td",[t._v(", - * /")])])])]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v("*")]),t._v(" 字符被用来指定所有的值。如："),n("code",[t._v("*")]),t._v(" 在分钟的字段域里表示“每分钟”。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("-")]),t._v(" 字符被用来指定一个范围。如："),n("code",[t._v("10-12")]),t._v(" 在小时域意味着“10点、11点、12点”")])]),t._v(" "),n("li",[n("p",[n("code",[t._v(",")]),t._v(" 字符被用来指定另外的值。如："),n("code",[t._v("MON,WED,FRI")]),t._v(" 在星期域里表示“星期一、星期三、星期五”.")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("?")]),t._v(" 字符只在日期域和星期域中使用。它被用来指定“非明确的值”。当你需要通过在这两个域中的一个来指定一些东西的时候，它是有用的。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("L")]),t._v(" 字符指定在月或者星期中的某天（最后一天）。即 “Last” 的缩写。但是在星期和月中 “Ｌ” 表示不同的意思，如：在月字段中 “L” 指月份的最后一天 “1月31日，2月28日”，如果在星期字段中则简单的表示为“7”或者“SAT”。如果在星期字段中在某个 value 值得后面，则表示 “某月的最后一个星期 value” ,如 “6L” 表示某月的最后一个星期五。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("W")]),t._v(" 字符只能用在月份字段中，该字段指定了离指定日期最近的那个星期日。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("#")]),t._v(" 字符只能用在星期字段，该字段指定了第几个星期 value 在某月中")])])]),t._v(" "),n("p",[t._v("每一个元素都可以显式地规定一个值（如 6），一个区间（如 9-12 ），一个列表（如 9，11，13 ）或一个通配符（如 *）。“月份中的日期”和“星期中的日期”这两个元素是互斥的，因此应该通过设置一个问号（?）来表明你不想设置的那个字段。")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("表达式")]),t._v(" "),n("th",[t._v("意义")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("0 0 12 * * ?")]),t._v(" "),n("td",[t._v("每天中午 12 点触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 ? * *")]),t._v(" "),n("td",[t._v("每天上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 * * ?")]),t._v(" "),n("td",[t._v("每天上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 * * ? *")]),t._v(" "),n("td",[t._v("每天上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 * * ? 2005")]),t._v(" "),n("td",[t._v("2005 年的每天上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 * 14 * * ?")]),t._v(" "),n("td",[t._v("在每天下午 2 点到下午 2:59 期间的每 1 分钟触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 0/5 14 * * ?")]),t._v(" "),n("td",[t._v("在每天下午 2 点到下午 2:55 期间的每 5 分钟触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 0/5 14,18 * * ?")]),t._v(" "),n("td",[t._v("在每天下午 2 点到 2:55 期间和下午 6 点到 6:55 期间的每 5 分钟触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 0-5 14 * * ?")]),t._v(" "),n("td",[t._v("在每天下午 2 点到下午 2:05 期间的每 1 分钟触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 10,44 14 ? 3 WED")]),t._v(" "),n("td",[t._v("每年三月的星期三的下午 2:10 和 2:44 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 ? * MON-FRI")]),t._v(" "),n("td",[t._v("周一至周五的上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 15 * ?")]),t._v(" "),n("td",[t._v("每月 15 日上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 L * ?")]),t._v(" "),n("td",[t._v("每月最后一日的上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 ? * 6L")]),t._v(" "),n("td",[t._v("每月的最后一个星期五上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 ? * 6L 2002-2005")]),t._v(" "),n("td",[t._v("2002 年至 2005 年的每月的最后一个星期五上午 10:15 触发")])]),t._v(" "),n("tr",[n("td",[t._v("0 15 10 ? * 6#3")]),t._v(" "),n("td",[t._v("每月的第三个星期五上午 10:15 触发")])])])]),t._v(" "),n("h2",{attrs:{id:"spring-boot-集成-quartz"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-集成-quartz"}},[t._v("#")]),t._v(" Spring Boot 集成 Quartz")]),t._v(" "),n("h3",{attrs:{id:"创建项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建项目"}},[t._v("#")]),t._v(" 创建项目")]),t._v(" "),n("p",[t._v("创建一个名为 "),n("code",[t._v("hello-quartz")]),t._v(" 的项目")]),t._v(" "),n("h3",{attrs:{id:"pom"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pom"}},[t._v("#")]),t._v(" POM")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('    <?xml version="1.0" encoding="UTF-8"?>\n    <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n             xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n        <modelVersion>4.0.0</modelVersion>\n    \n        <groupId>com.cmcc</groupId>\n        <artifactId>hello-quartz</artifactId>\n        <version>0.0.1-SNAPSHOT</version>\n        <packaging>jar</packaging>\n    \n        <name>hello-quartz</name>\n    \n        <parent>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-parent</artifactId>\n            <version>2.0.4.RELEASE</version>\n            <relativePath/> \x3c!-- lookup parent from repository --\x3e\n        </parent>\n    \n        <properties>\n            <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n            <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n            <java.version>1.8</java.version>\n        </properties>\n    \n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-quartz</artifactId>\n            </dependency>\n    \n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-test</artifactId>\n                <scope>test</scope>\n            </dependency>\n        </dependencies>\n    \n        <build>\n            <plugins>\n                <plugin>\n                    <groupId>org.springframework.boot</groupId>\n                    <artifactId>spring-boot-maven-plugin</artifactId>\n                </plugin>\n            </plugins>\n        </build>\n    \n    </project>\n')])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br")])]),n("p",[t._v("主要增加了 "),n("code",[t._v("org.springframework.boot:spring-boot-starter-quartz")]),t._v(" 依赖")]),t._v(" "),n("h3",{attrs:{id:"application"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#application"}},[t._v("#")]),t._v(" Application")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("    package com.cmcc.hello.quatrz;\n    \n    import org.springframework.boot.SpringApplication;\n    import org.springframework.boot.autoconfigure.SpringBootApplication;\n    import org.springframework.scheduling.annotation.EnableScheduling;\n    \n    @EnableScheduling\n    @SpringBootApplication\n    public class HelloQuatrzApplication {\n        public static void main(String[] args) {\n            SpringApplication.run(HelloQuatrzApplication.class, args);\n        }\n    }\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("p",[t._v("使用 "),n("code",[t._v("@EnableScheduling")]),t._v(" 注解来开启计划任务功能")]),t._v(" "),n("h3",{attrs:{id:"创建任务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建任务"}},[t._v("#")]),t._v(" 创建任务")]),t._v(" "),n("p",[t._v("我们创建一个每 5 秒钟打印当前时间的任务来测试 Quartz")]),t._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('    package com.cmcc.hello.quatrz.tasks;\n    \n    import org.springframework.scheduling.annotation.Scheduled;\n    import org.springframework.stereotype.Component;\n    \n    import java.text.SimpleDateFormat;\n    import java.util.Date;\n    \n    @Component\n    public class PrintCurrentTimeTask {\n        @Scheduled(cron = "0/5 * * * * ? ")\n        public void printCurrentTime() {\n            System.out.println("Current Time is:" + new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()));\n        }\n    }\n')])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br")])]),n("p",[t._v("启动服务，控制台打印效果如下：")]),t._v(" "),n("p",[n("img",{attrs:{src:"/img/1534681836.png",alt:""}})])])}),[],!1,null,null,null);a.default=r.exports}}]);