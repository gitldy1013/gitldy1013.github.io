(window.webpackJsonp=window.webpackJsonp||[]).push([[943],{1638:function(s,n,e){"use strict";e.r(n);var a=e(5),r=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"基于-docker-安装-rocketmq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于-docker-安装-rocketmq"}},[s._v("#")]),s._v(" 基于 Docker 安装 RocketMQ")]),s._v(" "),e("h2",{attrs:{id:"docker-compose-yml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml"}},[s._v("#")]),s._v(" docker-compose.yml")]),s._v(" "),e("p",[e("strong",[s._v("注意：启动 RocketMQ Server + Broker + Console 至少需要 2G 内存")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    version: \'3.5\'\n    services:\n      rmqnamesrv:\n        image: foxiswho/rocketmq:server\n        container_name: rmqnamesrv\n        ports:\n          - 9876:9876\n        volumes:\n          - ./data/logs:/opt/logs\n          - ./data/store:/opt/store\n        networks:\n            rmq:\n              aliases:\n                - rmqnamesrv\n    \n      rmqbroker:\n        image: foxiswho/rocketmq:broker\n        container_name: rmqbroker\n        ports:\n          - 10909:10909\n          - 10911:10911\n        volumes:\n          - ./data/logs:/opt/logs\n          - ./data/store:/opt/store\n          - ./data/brokerconf/broker.conf:/etc/rocketmq/broker.conf\n        environment:\n            NAMESRV_ADDR: "rmqnamesrv:9876"\n            JAVA_OPTS: " -Duser.home=/opt"\n            JAVA_OPT_EXT: "-server -Xms128m -Xmx128m -Xmn128m"\n        command: mqbroker -c /etc/rocketmq/broker.conf\n        depends_on:\n          - rmqnamesrv\n        networks:\n          rmq:\n            aliases:\n              - rmqbroker\n    \n      rmqconsole:\n        image: styletang/rocketmq-console-ng\n        container_name: rmqconsole\n        ports:\n          - 8080:8080\n        environment:\n            JAVA_OPTS: "-Drocketmq.namesrv.addr=rmqnamesrv:9876 -Dcom.rocketmq.sendMessageWithVIPChannel=false"\n        depends_on:\n          - rmqnamesrv\n        networks:\n          rmq:\n            aliases:\n              - rmqconsole\n    \n    networks:\n      rmq:\n        name: rmq\n        driver: bridge\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br")])]),e("h2",{attrs:{id:"broker-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broker-conf"}},[s._v("#")]),s._v(" broker.conf")]),s._v(" "),e("p",[s._v("RocketMQ Broker 需要一个配置文件，按照上面的 Compose 配置，我们需要在 "),e("code",[s._v("./data/brokerconf/")]),s._v(" 目录下创建一个名为 "),e("code",[s._v("broker.conf")]),s._v(" 的配置文件，内容如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    # Licensed to the Apache Software Foundation (ASF) under one or more\n    # contributor license agreements.  See the NOTICE file distributed with\n    # this work for additional information regarding copyright ownership.\n    # The ASF licenses this file to You under the Apache License, Version 2.0\n    # (the "License"); you may not use this file except in compliance with\n    # the License.  You may obtain a copy of the License at\n    #\n    #     http://www.apache.org/licenses/LICENSE-2.0\n    #\n    #  Unless required by applicable law or agreed to in writing, software\n    #  distributed under the License is distributed on an "AS IS" BASIS,\n    #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    #  See the License for the specific language governing permissions and\n    #  limitations under the License.\n    \n    \n    # 所属集群名字\n    brokerClusterName=DefaultCluster\n    \n    # broker 名字，注意此处不同的配置文件填写的不一样，如果在 broker-a.properties 使用: broker-a,\n    # 在 broker-b.properties 使用: broker-b\n    brokerName=broker-a\n    \n    # 0 表示 Master，> 0 表示 Slave\n    brokerId=0\n    \n    # nameServer地址，分号分割\n    # namesrvAddr=rocketmq-nameserver1:9876;rocketmq-nameserver2:9876\n    \n    # 启动IP,如果 docker 报 com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to <192.168.0.120:10909> failed\n    # 解决方式1 加上一句 producer.setVipChannelEnabled(false);，解决方式2 brokerIP1 设置宿主机IP，不要使用docker 内部IP\n    # brokerIP1=192.168.0.253\n    \n    # 在发送消息时，自动创建服务器不存在的topic，默认创建的队列数\n    defaultTopicQueueNums=4\n    \n    # 是否允许 Broker 自动创建 Topic，建议线下开启，线上关闭 ！！！这里仔细看是 false，false，false\n    autoCreateTopicEnable=true\n    \n    # 是否允许 Broker 自动创建订阅组，建议线下开启，线上关闭\n    autoCreateSubscriptionGroup=true\n    \n    # Broker 对外服务的监听端口\n    listenPort=10911\n    \n    # 删除文件时间点，默认凌晨4点\n    deleteWhen=04\n    \n    # 文件保留时间，默认48小时\n    fileReservedTime=120\n    \n    # commitLog 每个文件的大小默认1G\n    mapedFileSizeCommitLog=1073741824\n    \n    # ConsumeQueue 每个文件默认存 30W 条，根据业务情况调整\n    mapedFileSizeConsumeQueue=300000\n    \n    # destroyMapedFileIntervalForcibly=120000\n    # redeleteHangedFileInterval=120000\n    # 检测物理文件磁盘空间\n    diskMaxUsedSpaceRatio=88\n    # 存储路径\n    # storePathRootDir=/home/ztztdata/rocketmq-all-4.1.0-incubating/store\n    # commitLog 存储路径\n    # storePathCommitLog=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/commitlog\n    # 消费队列存储\n    # storePathConsumeQueue=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/consumequeue\n    # 消息索引存储路径\n    # storePathIndex=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/index\n    # checkpoint 文件存储路径\n    # storeCheckpoint=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/checkpoint\n    # abort 文件存储路径\n    # abortFile=/home/ztztdata/rocketmq-all-4.1.0-incubating/store/abort\n    # 限制的消息大小\n    maxMessageSize=65536\n    \n    # flushCommitLogLeastPages=4\n    # flushConsumeQueueLeastPages=2\n    # flushCommitLogThoroughInterval=10000\n    # flushConsumeQueueThoroughInterval=60000\n    \n    # Broker 的角色\n    # - ASYNC_MASTER 异步复制Master\n    # - SYNC_MASTER 同步双写Master\n    # - SLAVE\n    brokerRole=ASYNC_MASTER\n    \n    # 刷盘方式\n    # - ASYNC_FLUSH 异步刷盘\n    # - SYNC_FLUSH 同步刷盘\n    flushDiskType=ASYNC_FLUSH\n    \n    # 发消息线程池数量\n    # sendMessageThreadPoolNums=128\n    # 拉消息线程池数量\n    # pullMessageThreadPoolNums=128\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br")])]),e("h2",{attrs:{id:"rocketmq-控制台"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq-控制台"}},[s._v("#")]),s._v(" RocketMQ 控制台")]),s._v(" "),e("p",[s._v("访问 http://rmqIP:8080 登入控制台")]),s._v(" "),e("p",[e("img",{attrs:{src:"/img/20190115014325.png",alt:""}})])])}),[],!1,null,null,null);n.default=r.exports}}]);