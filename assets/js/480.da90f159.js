(window.webpackJsonp=window.webpackJsonp||[]).push([[480],{1176:function(a,s,e){"use strict";e.r(s);var t=e(5),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"docker-外部访问容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-外部访问容器"}},[a._v("#")]),a._v(" Docker 外部访问容器")]),a._v(" "),e("p",[a._v("容器中可以运行一些网络应用，要让外部也可以访问这些应用，可以通过 "),e("code",[a._v("-P")]),a._v(" 或 "),e("code",[a._v("-p")]),a._v(" 参数来指定端口映射。")]),a._v(" "),e("p",[a._v("当使用 "),e("code",[a._v("-P")]),a._v(" 标记时，Docker 会随机映射一个 "),e("code",[a._v("49000~49900")]),a._v(" 的端口到内部容器开放的网络端口。")]),a._v(" "),e("p",[a._v("使用 "),e("code",[a._v("docker container ls")]),a._v(" 可以看到，本地主机的 49155 被映射到了容器的 5000 端口。此时访问本机的 49155 端口即可访问容器内 web 应用提供的界面。")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker run -d -P training/webapp python app.py\n    \n    $ docker container ls -l\n    CONTAINER ID  IMAGE                   COMMAND       CREATED        STATUS        PORTS                    NAMES\n    bc533791f3f5  training/webapp:latest  python app.py 5 seconds ago  Up 2 seconds  0.0.0.0:49155->5000/tcp  nostalgic_morse\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("p",[a._v("同样的，可以通过 "),e("code",[a._v("docker logs")]),a._v(" 命令来查看应用的信息。")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('    $ docker logs -f nostalgic_morse\n    * Running on http://0.0.0.0:5000/\n    10.0.2.2 - - [23/May/2014 20:16:31] "GET / HTTP/1.1" 200 -\n    10.0.2.2 - - [23/May/2014 20:16:31] "GET /favicon.ico HTTP/1.1" 404 -\n')])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])]),e("p",[e("code",[a._v("-p")]),a._v(" 则可以指定要映射的端口，并且，在一个指定端口上只可以绑定一个容器。支持的格式有 "),e("code",[a._v("ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort")]),a._v("。")]),a._v(" "),e("h2",{attrs:{id:"映射所有接口地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#映射所有接口地址"}},[a._v("#")]),a._v(" 映射所有接口地址")]),a._v(" "),e("p",[a._v("使用 "),e("code",[a._v("hostPort:containerPort")]),a._v(" 格式本地的 5000 端口映射到容器的 5000 端口，可以执行")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker run -d -p 5000:5000 training/webapp python app.py\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("此时默认会绑定本地所有接口上的所有地址。")]),a._v(" "),e("h2",{attrs:{id:"映射到指定地址的指定端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#映射到指定地址的指定端口"}},[a._v("#")]),a._v(" 映射到指定地址的指定端口")]),a._v(" "),e("p",[a._v("可以使用 "),e("code",[a._v("ip:hostPort:containerPort")]),a._v(" 格式指定映射使用一个特定地址，比如 localhost 地址 127.0.0.1")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker run -d -p 127.0.0.1:5000:5000 training/webapp python app.py\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h2",{attrs:{id:"映射到指定地址的任意端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#映射到指定地址的任意端口"}},[a._v("#")]),a._v(" 映射到指定地址的任意端口")]),a._v(" "),e("p",[a._v("使用 "),e("code",[a._v("ip::containerPort")]),a._v(" 绑定 localhost 的任意端口到容器的 5000 端口，本地主机会自动分配一个端口。")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker run -d -p 127.0.0.1::5000 training/webapp python app.py\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("还可以使用 "),e("code",[a._v("udp")]),a._v(" 标记来指定 "),e("code",[a._v("udp")]),a._v(" 端口")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h2",{attrs:{id:"查看映射端口配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看映射端口配置"}},[a._v("#")]),a._v(" 查看映射端口配置")]),a._v(" "),e("p",[a._v("使用 "),e("code",[a._v("docker port")]),a._v(" 来查看当前映射的端口配置，也可以查看到绑定的地址")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker port nostalgic_morse 5000\n    127.0.0.1:49155.\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("注意：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("容器有自己的内部网络和 ip 地址（使用 "),e("code",[a._v("docker inspect")]),a._v(" 可以获取所有的变量，Docker 还可以有一个可变的网络配置。）")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("-p")]),a._v(" 标记可以多次使用来绑定多个端口")])])]),a._v(" "),e("p",[a._v("例如")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("    $ docker run -d \\\n        -p 5000:5000 \\\n        -p 3000:80 \\\n        training/webapp \\\n        python app.py\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);