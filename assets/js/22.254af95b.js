(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{719:function(e,a,s){"use strict";s.r(a);var n=s(5),t=Object(n.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"docker操作系统之alpine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker操作系统之alpine"}},[e._v("#")]),e._v(" Docker操作系统之Alpine")]),e._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),s("p",[e._v("这阵子我发现只要带着alpine前缀的镜像，相比于其它的镜像，体积都相对较小，例如下面这些")]),e._v(" "),s("div",{staticClass:"language-shell script line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("java:alpine\nnginx:alpine\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("后面通过了解，发现了其实这些java镜像，或者nginx镜像都依赖于某个linux操作系统，我们常见的操作系统有  ubuntu、centos、debian。而这个alpine其实也是一个新的操作系统。但是它比其它的操作系统而言，体积更小，所以在他们的基础之上做的镜像，体积也会更小，常见的linux操作系统体积大小，如下所示")]),e._v(" "),s("div",{staticClass:"language-shell script line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("REPOSITORY          TAG           IMAGE ID          VIRTUAL SIZE\nalpine              latest        4e38e38c8ce0      "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.799")]),e._v(" MB\ndebian              latest        4d6ce913b130      "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("84.98")]),e._v(" MB\nubuntu              latest        b39b81afc8ca      "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("188.3")]),e._v(" MB\ncentos              latest        8efe422e6104      "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("210")]),e._v(" MB\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("我们也就发现了 alpine的大小远远小于 其它的操作系统，因此制作出来的镜像大小也远远小于其它的")]),e._v(" "),s("h2",{attrs:{id:"alpine操作系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alpine操作系统"}},[e._v("#")]),e._v(" Alpine操作系统")]),e._v(" "),s("p",[e._v("Alpine操作系统主要是面向安全的轻量级Linux发行版，它和其它的发行版不同之处在于，Alpine采用了musllibc 和 busybox以减少系统体积和运行时资源消耗，但功能上比busybox又完善的多 ，因此越来越得到开源社区的青睐。在保持瘦身的同时，Alpine还提供了自己的包管理工具【CentOS是yum，ubuntu是 apt-get】，可以通过 "),s("a",{attrs:{href:"https://pkgs.alpinelinux.org/packages",target:"_blank",rel:"noopener noreferrer"}},[e._v("Alpine包查询网站"),s("OutboundLink")],1),e._v(" ，来进行查看，例如下图所示，搜索自己需要安装的包进行查看")]),e._v(" "),s("p",[s("img",{attrs:{src:"/images/image-20201206093447554.png",alt:"image-20201206093447554"}})]),e._v(" "),s("p",[e._v("然后通过 apk add vim 来进行安装即可。")]),e._v(" "),s("p",[e._v("Alpine Docker镜像也继承了Alpine Linux发行版的优势，相比于其它的Docker镜像，它的容量体积非常小，仅仅只有5MB，我们通过打开 DockerHub中 "),s("a",{attrs:{href:"https://registry.hub.docker.com/_/alpine",target:"_blank",rel:"noopener noreferrer"}},[e._v("Alpine的官网"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("img",{attrs:{src:"/images/image-20201206093922397.png",alt:"image-20201206093922397"}})]),e._v(" "),s("p",[e._v("可以发现，它提供了只有5MB的系统镜像可供我们进行下载使用")]),e._v(" "),s("div",{staticClass:"language-shell script line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 下载alpine镜像")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" pull alpine\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("同时，它还列举了一个例子 【通过制作一个mysql镜像】")]),e._v(" "),s("p",[s("img",{attrs:{src:"/images/image-20201206094302242.png",alt:"image-20201206094302242"}})]),e._v(" "),s("p",[e._v("使用Alpine 和 Ubuntu 制作出来的镜像一个是 36.8MB 一个是 145MB，相差4倍多")]),e._v(" "),s("p",[e._v("目前Docker官方已经开始推荐Alpine替代之前的Ubuntu作为基础镜像环境，这样所带来的好处包括：镜像下载速度更快、镜像安全性提高、主机之间的切换更方便、占用内存更少等特点。")]),e._v(" "),s("h2",{attrs:{id:"使用alpine镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用alpine镜像"}},[e._v("#")]),e._v(" 使用Alpine镜像")]),e._v(" "),s("p",[e._v("我们通过下面命令，能够非常快的运行一个Alpine容器【本地不存在会去官方下载】，并输出 hello alpine")]),e._v(" "),s("div",{staticClass:"language-shell script line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" run alpine "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hello alpine"')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/images/image-20201206094817959.png",alt:"image-20201206094817959"}})]),e._v(" "),s("h2",{attrs:{id:"迁移至alpine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#迁移至alpine"}},[e._v("#")]),e._v(" 迁移至Alpine")]),e._v(" "),s("p",[e._v("目前，大部分Docker官方镜像，都已经提供了Alpine版本镜像的支持，我们非常容易镜像迁移")]),e._v(" "),s("p",[e._v("例如，通过Nginx的 "),s("a",{attrs:{href:"https://registry.hub.docker.com/_/nginx",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方DockerHub地址"),s("OutboundLink")],1),e._v("，我们可以看到，也专门有 alpine稳定版本")]),e._v(" "),s("p",[s("img",{attrs:{src:"/images/image-20201206095346672.png",alt:"image-20201206095346672"}})]),e._v(" "),s("p",[e._v("还有其它一些官方镜像也都提供了alpine版本，我们可以在")]),e._v(" "),s("div",{staticClass:"language-shell script line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ubuntu/debian -"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" alpine\npython:2.7 -"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" python:2.7-alpine\nruby:2.3 -"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ruby:2.3-alpine\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("另外，如果我们想要在alpine的基础上进行一些软件的安装，可以使用下面的命令")]),e._v(" "),s("div",{staticClass:"language-shell script line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("apk "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" --no-cache "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("package"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h2",{attrs:{id:"思考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#思考"}},[e._v("#")]),e._v(" 思考")]),e._v(" "),s("p",[e._v("本段来源于V2EX上的 "),s("a",{attrs:{href:"https://www.v2ex.com/t/581888",target:"_blank",rel:"noopener noreferrer"}},[e._v("提问"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("上面其实我们已经提到了很多关于alpine的优势，比如体积小，并且很多官方的Docker镜像都提供了基于alpine的版本。那如果alpine版本没有任何坑的话，从体积小，并且能满足使用正常使用的话，这相比于CentOS、Ubuntu和Debian的镜像，就拥有非常大的优势了，那么以后这些发行版的进行也就没有存在的必要，真实是这样的么？")]),e._v(" "),s("p",[e._v("下面是针对上述问题，最后的总结")]),e._v(" "),s("ul",[s("li",[e._v("首先在基于alpine的操作系统上编写Dockerfile制作新镜像，并不会像其他操作系统一样方便，甚至会出现alpine中不存在的情况。")]),e._v(" "),s("li",[e._v("虽然每个单个的基于alpine的软件镜像是明显少于其他操作系统，但是如果多个镜像【包括每个镜像运行的多个容器】，使用 了同一个基础镜像，是不会花费额外的空间【归结于docker的Overlay文件系统】")]),e._v(" "),s("li",[e._v("有些软件没办法在Alpine中运行，因为alpine不像其它发行版那样使用CGLIBC【MySQL没有Alpine镜像】")])]),e._v(" "),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("Alpine")]),e._v(" 官网：http://alpinelinux.org/")]),e._v(" "),s("li",[s("code",[e._v("Alpine")]),e._v(" 官方仓库：https://github.com/alpinelinux")]),e._v(" "),s("li",[s("code",[e._v("Alpine")]),e._v(" 官方镜像：https://hub.docker.com/_/alpine/")]),e._v(" "),s("li",[s("code",[e._v("Alpine")]),e._v(" 官方镜像仓库：https://github.com/gliderlabs/docker-alpine")])])])}),[],!1,null,null,null);a.default=t.exports}}]);