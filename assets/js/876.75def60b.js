(window.webpackJsonp=window.webpackJsonp||[]).push([[876],{1573:function(n,s,a){"use strict";a.r(s);var e=a(5),t=Object(e.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"一、快速入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、快速入门"}},[n._v("#")]),n._v(" 一、快速入门")]),n._v(" "),a("h2",{attrs:{id:"_1、spring-boot-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、spring-boot-简介"}},[n._v("#")]),n._v(" 1、Spring Boot 简介")]),n._v(" "),a("blockquote",[a("p",[n._v("简化Spring应用开发的一个框架；")]),n._v(" "),a("p",[n._v("整个Spring技术栈的一个大整合；")]),n._v(" "),a("p",[n._v("J2EE开发的一站式解决方案；")])]),n._v(" "),a("h2",{attrs:{id:"_2、微服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、微服务"}},[n._v("#")]),n._v(" 2、微服务")]),n._v(" "),a("p",[n._v("2014，martin fowler")]),n._v(" "),a("p",[n._v("微服务：架构风格（服务微化）")]),n._v(" "),a("p",[n._v("一个应用应该是一组小型服务；可以通过HTTP/RPC的方式进行互通；")]),n._v(" "),a("p",[n._v("单体应用：ALL IN ONE")]),n._v(" "),a("p",[n._v("微服务：每一个功能元素最终都是一个可独立替换和独立升级的软件单元；")]),n._v(" "),a("p",[a("a",{attrs:{href:"https://martinfowler.com/articles/microservices.html#MicroservicesAndSoa",target:"_blank",rel:"noopener noreferrer"}},[n._v("详细参照微服务文档"),a("OutboundLink")],1)]),n._v(" "),a("h2",{attrs:{id:"_3、环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、环境准备"}},[n._v("#")]),n._v(" 3、环境准备")]),n._v(" "),a("p",[n._v("环境约束")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v('–jdk1.8：Spring Boot 推荐jdk1.7及以上；java version "1.8.0_112"\n\n–maven3.x：maven 3.3以上版本；Apache Maven 3.3.9\n\n–IntelliJIDEA2019：IntelliJ IDEA 2019.2.2 x64、STS\n\n–SpringBoot 2.2.0.RELEASE：2.2.0；\n')])])]),a("p",[n._v("统一环境；")]),n._v(" "),a("h3",{attrs:{id:"_1、maven设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、maven设置"}},[n._v("#")]),n._v(" 1、MAVEN设置；")]),n._v(" "),a("p",[n._v("给maven 的settings.xml配置文件的profiles标签添加")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<profile>\n  <id>jdk-1.8</id>\n  <activation>\n    <activeByDefault>true</activeByDefault>\n    <jdk>1.8</jdk>\n  </activation>\n  <properties>\n    <maven.compiler.source>1.8</maven.compiler.source>\n    <maven.compiler.target>1.8</maven.compiler.target>\n    <maven.compiler.compilerVersion>1.8</maven.compiler.compilerVersion>\n  </properties>\n</profile>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br")])]),a("h3",{attrs:{id:"_2、idea设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、idea设置"}},[n._v("#")]),n._v(" 2、IDEA设置")]),n._v(" "),a("p",[n._v("整合maven进来；")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180129151112.png",alt:"images/"}})]),n._v(" "),a("h2",{attrs:{id:"_4、spring-boot-helloworld"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、spring-boot-helloworld"}},[n._v("#")]),n._v(" 4、Spring Boot HelloWorld")]),n._v(" "),a("p",[n._v("一个功能：")]),n._v(" "),a("p",[n._v("浏览器发送hello请求，服务器接受请求并处理，响应Hello World字符串；")]),n._v(" "),a("h3",{attrs:{id:"_1、idea-使用-spring-initializer快速创建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、idea-使用-spring-initializer快速创建项目"}},[n._v("#")]),n._v(" 1、IDEA：使用 Spring Initializer快速创建项目")]),n._v(" "),a("p",[n._v("IDE都支持使用Spring的项目创建向导快速创建一个Spring Boot项目；")]),n._v(" "),a("p",[n._v("选择我们需要的模块；向导会联网创建Spring Boot项目；")]),n._v(" "),a("p",[n._v("默认生成的Spring Boot项目；")]),n._v(" "),a("ul",[a("li",[n._v("主程序已经生成好了，我们只需要我们自己的逻辑")]),n._v(" "),a("li",[n._v("resources文件夹中目录结构\n"),a("ul",[a("li",[n._v("static：保存所有的静态资源； js css  images；")]),n._v(" "),a("li",[n._v("templates：保存所有的模板页面；（Spring Boot默认jar包使用嵌入式的Tomcat，默认不支持JSP页面）；可以使用模板引擎（freemarker、thymeleaf）；")]),n._v(" "),a("li",[n._v("application.properties：Spring Boot应用的配置文件；可以修改一些默认设置；")])])])]),n._v(" "),a("h3",{attrs:{id:"_2、导入spring-boot相关的依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、导入spring-boot相关的依赖"}},[n._v("#")]),n._v(" 2、导入spring boot相关的依赖")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    \x3c!-- 父依赖spring-boot-dependencies来管理Spring Boot应用里面的所有依赖版本 没有在dependencies里面管理的依赖需要声明版本号 自定义会覆盖--\x3e\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.2.0.RELEASE</version>\n        <relativePath/> \x3c!-- lookup parent from repository --\x3e\n    </parent>\n    <groupId>com.cmcc.demo</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>demo</name>\n    <description>Demo project for cmcc Spring Boot</description>\n\n    <properties>\n        <java.version>1.8</java.version>\n    </properties>\n\n    <dependencies>\n        \x3c!-- spring-boot-starter：spring-boot场景启动器帮我们导入了web模块正常运行所依赖的组件 --\x3e\n        \x3c!-- Spring Boot将所有的功能场景都抽取出来，做成一个个的starters（启动器），只需要在项目里面引入这些starter相关场景的所有依赖都会导入进来。要用什么功能就导入什么场景的启动器 --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        \x3c!-- spring容器测试整合包 --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n        \n        \x3c!-- 敏捷开发工具包 --\x3e\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <version>1.18.10</version>\n        </dependency>\n        \n        \x3c!--导入配置文件处理器，配置文件进行绑定就会有提示--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-configuration-processor</artifactId>\n            <optional>true</optional>\n        </dependency>\n    </dependencies>\n\n    \x3c!-- 这个插件，可以将应用打包成一个可执行的jar包 --\x3e\n    \x3c!-- 将这个应用打成jar包，直接使用java -jar的命令进行执行 --\x3e\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n\n</project>\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br")])]),a("h3",{attrs:{id:"_3、编写一个主程序-启动spring-boot应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、编写一个主程序-启动spring-boot应用"}},[n._v("#")]),n._v(" 3、编写一个主程序；启动Spring Boot应用")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("/**\n *  @SpringBootApplication 来标注一个主程序类，说明这是一个Spring Boot应用\n */\n@SpringBootApplication\npublic class DemoApplication {\n    public static void main(String[] args) {\n        // Spring应用启动起来\n        SpringApplication.run(DemoApplication.class,args);\n    }\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br")])]),a("h3",{attrs:{id:"_4、编写相关的controller、service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、编写相关的controller、service"}},[n._v("#")]),n._v(" 4、编写相关的Controller、Service")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Controller\npublic class HelloController {\n    @ResponseBody\n    @RequestMapping("/hello")\n    public String hello(){\n        return "Hello World!";\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br")])]),a("h3",{attrs:{id:"_5、运行主程序测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、运行主程序测试"}},[n._v("#")]),n._v(" 5、运行主程序测试")]),n._v(" "),a("p",[a("strong",[n._v("Spring Boot在启动的时候从类路径下的META-INF/spring.factories中获取EnableAutoConfiguration指定的值，将这些值作为自动配置类导入到容器中，自动配置类就生效，帮我们进行自动配置工作；以前我们需要自己配置的东西，自动配置类都帮我们;")])]),n._v(" "),a("p",[a("strong",[n._v("J2EE的整体整合解决方案和自动配置都在spring-boot-autoconfigure-X.X.X.RELEASE.jar")])]),n._v(" "),a("h1",{attrs:{id:"二、注解配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、注解配置"}},[n._v("#")]),n._v(" 二、注解配置")]),n._v(" "),a("h2",{attrs:{id:"_1、配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、配置文件"}},[n._v("#")]),n._v(" 1、配置文件")]),n._v(" "),a("p",[n._v("SpringBoot使用一个全局的配置文件，配置文件名是固定的；")]),n._v(" "),a("p",[n._v("•application.properties")]),n._v(" "),a("p",[n._v("•application.yml")]),n._v(" "),a("p",[n._v("配置文件的作用：修改SpringBoot自动配置的默认值；SpringBoot在底层都给我们自动配置好；")]),n._v(" "),a("p",[n._v("YAML（YAML Ain't Markup Language）")]),n._v(" "),a("p",[n._v("​\tYAML  A Markup Language：是一个标记语言")]),n._v(" "),a("p",[n._v("​\tYAML   isn't Markup Language：不是一个标记语言；")]),n._v(" "),a("p",[n._v("标记语言：")]),n._v(" "),a("p",[n._v("​\t以前的配置文件；大多都使用的是  "),a("strong",[n._v("xxxx.xml")]),n._v("文件；")]),n._v(" "),a("p",[n._v("​\tYAML："),a("strong",[n._v("以数据为中心")]),n._v("，比json、xml等更适合做配置文件；")]),n._v(" "),a("p",[n._v("​\tYAML：配置例子")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("server:\n  port: 8081\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br")])]),a("p",[n._v("​\tXML：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<server>\n\t<port>8081</port>\n</server>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("h2",{attrs:{id:"_2、yaml语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、yaml语法"}},[n._v("#")]),n._v(" 2、YAML语法：")]),n._v(" "),a("h3",{attrs:{id:"_1、基本语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、基本语法"}},[n._v("#")]),n._v(" 1、基本语法")]),n._v(" "),a("p",[n._v("k:(空格)v：表示一对键值对（空格必须有）；")]),n._v(" "),a("p",[n._v("以"),a("strong",[n._v("空格")]),n._v("的缩进来控制层级关系；只要是左对齐的一列数据，都是同一个层级的")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("server:\n    port: 8081\n    path: /hello\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("p",[n._v("属性和值也是大小写敏感；")]),n._v(" "),a("h3",{attrs:{id:"_2、值的写法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、值的写法"}},[n._v("#")]),n._v(" 2、值的写法")]),n._v(" "),a("h4",{attrs:{id:"字面量-普通的值-数字-字符串-布尔"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字面量-普通的值-数字-字符串-布尔"}},[n._v("#")]),n._v(" 字面量：普通的值（数字，字符串，布尔）")]),n._v(" "),a("p",[n._v("​\tk: v：字面直接来写；")]),n._v(" "),a("p",[n._v("​\t\t字符串默认不用加上单引号或者双引号；")]),n._v(" "),a("p",[n._v('​\t\t""：双引号；不会转义字符串里面的特殊字符；特殊字符会作为本身想表示的意思')]),n._v(" "),a("p",[n._v('​\t\t\t\tname:   "zhangsan \\n lisi"：输出；zhangsan 换行  lisi')]),n._v(" "),a("p",[n._v("​\t\t''：单引号；会转义特殊字符，特殊字符最终只是一个普通的字符串数据")]),n._v(" "),a("p",[n._v("​\t\t\t\tname:   ‘zhangsan \\n lisi’：输出；zhangsan \\n  lisi")]),n._v(" "),a("h4",{attrs:{id:"对象、map-属性和值-键值对"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对象、map-属性和值-键值对"}},[n._v("#")]),n._v(" 对象、Map（属性和值）（键值对）：")]),n._v(" "),a("p",[n._v("​\tk: v：在下一行来写对象的属性和值的关系；注意缩进")]),n._v(" "),a("p",[n._v("​\t\t对象还是k: v的方式")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("friends:\n\t\tlastName: zhangsan\n\t\tage: 20\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("p",[n._v("行内写法：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("friends: {lastName: zhangsan,age: 18}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("h4",{attrs:{id:"数组-list、set"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数组-list、set"}},[n._v("#")]),n._v(" 数组（List、Set）：")]),n._v(" "),a("p",[n._v("用- 值表示数组中的一个元素")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("pets:\n - cat\n - dog\n - pig\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("p",[n._v("行内写法")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("pets: [cat,dog,pig]\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("h2",{attrs:{id:"_3、配置文件值注入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、配置文件值注入"}},[n._v("#")]),n._v(" 3、配置文件值注入")]),n._v(" "),a("p",[n._v("配置文件")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("person:\n    lastName: hello\n    age: 18\n    boss: false\n    birth: 2017/12/12\n    maps: {k1: v1,k2: 12}\n    lists:\n      - lisi\n      - zhaoliu\n    dog:\n      name: 小狗\n      age: 12\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br")])]),a("p",[n._v("javaBean：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('/**\n * 将配置文件中配置的每一个属性的值，映射到这个组件中\n * @ConfigurationProperties：告诉SpringBoot将本类中的所有属性和配置文件中相关的配置进行绑定；\n *      prefix = "person"：配置文件中哪个下面的所有属性进行一一映射\n *\n * 只有这个组件是容器中的组件，才能容器提供的@ConfigurationProperties功能；\n *\n */\n@Component\n@ConfigurationProperties(prefix = "person")\npublic class Person {\n\n    private String lastName;\n    private Integer age;\n    private Boolean boss;\n    private Date birth;\n\n    private Map<String,Object> maps;\n    private List<Object> lists;\n    private Dog dog;\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br")])]),a("p",[n._v("我们可以导入配置文件处理器，以后编写配置就有提示了")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\x3c!--导入配置文件处理器，配置文件进行绑定就会有提示--\x3e\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-configuration-processor</artifactId>\n    <optional>true</optional>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br")])]),a("h4",{attrs:{id:"_1、properties配置文件在idea中默认utf-8可能会乱码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、properties配置文件在idea中默认utf-8可能会乱码"}},[n._v("#")]),n._v(" 1、properties配置文件在idea中默认utf-8可能会乱码")]),n._v(" "),a("p",[n._v("调整")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180130161620.png",alt:"idea配置乱码"}})]),n._v(" "),a("h4",{attrs:{id:"_2、-value获取值和-configurationproperties获取值比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、-value获取值和-configurationproperties获取值比较"}},[n._v("#")]),n._v(" 2、@Value获取值和@ConfigurationProperties获取值比较")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th"),n._v(" "),a("th",[n._v("@ConfigurationProperties")]),n._v(" "),a("th",[n._v("@Value")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("功能")]),n._v(" "),a("td",[n._v("批量注入配置文件中的属性")]),n._v(" "),a("td",[n._v("一个个指定")])]),n._v(" "),a("tr",[a("td",[n._v("松散绑定（松散语法）")]),n._v(" "),a("td",[n._v("支持")]),n._v(" "),a("td",[n._v("不支持")])]),n._v(" "),a("tr",[a("td",[n._v("SpEL")]),n._v(" "),a("td",[n._v("不支持")]),n._v(" "),a("td",[n._v("支持")])]),n._v(" "),a("tr",[a("td",[n._v("JSR303数据校验")]),n._v(" "),a("td",[n._v("支持")]),n._v(" "),a("td",[n._v("不支持")])]),n._v(" "),a("tr",[a("td",[n._v("复杂类型封装")]),n._v(" "),a("td",[n._v("支持")]),n._v(" "),a("td",[n._v("不支持")])])])]),n._v(" "),a("p",[a("strong",[n._v("配置文件yml还是properties他们都能获取到值；")])]),n._v(" "),a("p",[a("strong",[n._v("如果说，我们只是在某个业务逻辑中需要获取一下配置文件中的某项值，使用@Value；")])]),n._v(" "),a("p",[a("strong",[n._v("如果说，我们专门编写了一个javaBean来和配置文件进行映射，我们就直接使用@ConfigurationProperties；")])]),n._v(" "),a("h4",{attrs:{id:"_3、配置文件注入值数据校验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、配置文件注入值数据校验"}},[n._v("#")]),n._v(" 3、配置文件注入值数据校验")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Component\n@ConfigurationProperties(prefix = "person")\n@Validated\npublic class Person {\n\n    /**\n     * <bean class="Person">\n     *      <property name="lastName" value="字面量/${key}从环境变量、配置文件中获取值/#{SpEL}"></property>\n     * <bean/>\n     */\n\n   //lastName必须是邮箱格式\n    @Email\n    //@Value("${person.last-name}")\n    private String lastName;\n    //@Value("#{11*2}")\n    private Integer age;\n    //@Value("true")\n    private Boolean boss;\n\n    private Date birth;\n    private Map<String,Object> maps;\n    private List<Object> lists;\n    private Dog dog;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br")])]),a("h4",{attrs:{id:"_4、-propertysource-importresource-bean"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、-propertysource-importresource-bean"}},[n._v("#")]),n._v(" 4、@PropertySource&@ImportResource&@Bean")]),n._v(" "),a("p",[n._v("@"),a("strong",[n._v("PropertySource")]),n._v("：加载指定的配置文件；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('/**\n * 将配置文件中配置的每一个属性的值，映射到这个组件中\n * @ConfigurationProperties：告诉SpringBoot将本类中的所有属性和配置文件中相关的配置进行绑定；\n *      prefix = "person"：配置文件中哪个下面的所有属性进行一一映射\n *\n * 只有这个组件是容器中的组件，才能容器提供的@ConfigurationProperties功能；\n *  @ConfigurationProperties(prefix = "person")默认从全局配置文件中获取值；\n *\n */\n@PropertySource(value = {"classpath:person.properties"})\n@Component\n@ConfigurationProperties(prefix = "person")\n//@Validated\npublic class Person {\n\n    /**\n     * <bean class="Person">\n     *      <property name="lastName" value="字面量/${key}从环境变量、配置文件中获取值/#{SpEL}"></property>\n     * <bean/>\n     */\n\n   //lastName必须是邮箱格式\n   // @Email\n    //@Value("${person.last-name}")\n    private String lastName;\n    //@Value("#{11*2}")\n    private Integer age;\n    //@Value("true")\n    private Boolean boss;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br")])]),a("p",[n._v("@"),a("strong",[n._v("ImportResource")]),n._v("：导入Spring的配置文件，让配置文件里面的内容生效；")]),n._v(" "),a("p",[n._v("Spring Boot里面没有Spring的配置文件，我们自己编写的配置文件，也不能自动识别；")]),n._v(" "),a("p",[n._v("想让Spring的配置文件生效，加载进来；@"),a("strong",[n._v("ImportResource")]),n._v("标注在一个配置类上")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@ImportResource(locations = {"classpath:beans.xml"})\n导入Spring的配置文件让其生效\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br")])]),a("p",[n._v("不来编写Spring的配置文件")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    <bean id="helloService" class="com.demo.springboot.service.HelloService"></bean>\n</beans>\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[n._v("SpringBoot推荐给容器中添加组件的方式；推荐使用全注解的方式")]),n._v(" "),a("p",[n._v("1、配置类**@Configuration**------\x3eSpring配置文件")]),n._v(" "),a("p",[n._v("2、使用**@Bean**给容器中添加组件")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('/**\n * @Configuration：指明当前类是一个配置类；就是来替代之前的Spring配置文件\n *\n * 在配置文件中用<bean><bean/>标签添加组件\n *\n */\n@Configuration\npublic class MyAppConfig {\n\n    //将方法的返回值添加到容器中；容器中这个组件默认的id就是方法名\n    @Bean\n    public HelloService helloService02(){\n        System.out.println("配置类@Bean给容器中添加组件了...");\n        return new HelloService();\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br")])]),a("h2",{attrs:{id:"_4、配置文件占位符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、配置文件占位符"}},[n._v("#")]),n._v(" "),a("strong",[n._v("4、配置文件占位符")])]),n._v(" "),a("h3",{attrs:{id:"_1、随机数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、随机数"}},[n._v("#")]),n._v(" 1、随机数")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("${random.value}、${random.int}、${random.long}\n${random.int(10)}、${random.int[1024,65536]}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br")])]),a("h3",{attrs:{id:"_2、占位符获取之前配置的值-如果没有可以是用-指定默认值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、占位符获取之前配置的值-如果没有可以是用-指定默认值"}},[n._v("#")]),n._v(" 2、占位符获取之前配置的值，如果没有可以是用:指定默认值")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("person.last-name=张三${random.uuid}\nperson.age=${random.int}\nperson.birth=2017/12/15\nperson.boss=false\nperson.maps.k1=v1\nperson.maps.k2=14\nperson.lists=a,b,c\nperson.dog.name=${person.hello:hello}_dog\nperson.dog.age=15\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("h2",{attrs:{id:"_5、profile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、profile"}},[n._v("#")]),n._v(" 5、Profile")]),n._v(" "),a("h3",{attrs:{id:"_1、多profile文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、多profile文件"}},[n._v("#")]),n._v(" 1、多Profile文件")]),n._v(" "),a("p",[n._v("我们在主配置文件编写的时候，文件名可以是   application-{profile}.properties/yml")]),n._v(" "),a("p",[n._v("默认使用application.properties的配置；")]),n._v(" "),a("h3",{attrs:{id:"_2、yml支持多文档块方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、yml支持多文档块方式"}},[n._v("#")]),n._v(" 2、yml支持多文档块方式")]),n._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[n._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("8081")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("profiles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("active")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" prod\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("---")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("8083")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("profiles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" dev\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("---")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("8084")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[n._v("profiles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(":")]),n._v(" prod  "),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#指定属于哪个环境")]),n._v("\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("h3",{attrs:{id:"_3、激活指定profile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、激活指定profile"}},[n._v("#")]),n._v(" 3、激活指定profile")]),n._v(" "),a("p",[n._v("​\t1、在配置文件中指定  spring.profiles.active=dev")]),n._v(" "),a("p",[n._v("​\t2、命令行：")]),n._v(" "),a("p",[n._v("​\t    java -jar spring-boot-02-config-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev；")]),n._v(" "),a("p",[n._v("​\t\t可以直接在测试的时候，配置传入命令行参数")]),n._v(" "),a("p",[n._v("​\t3、虚拟机参数；")]),n._v(" "),a("p",[n._v("​\t\t-Dspring.profiles.active=dev")]),n._v(" "),a("h2",{attrs:{id:"_6、配置文件加载位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、配置文件加载位置"}},[n._v("#")]),n._v(" 6、配置文件加载位置")]),n._v(" "),a("p",[n._v("springboot 启动会扫描以下位置的application.properties或者application.yml文件作为Spring boot的默认配置文件")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("–file:./config/\n\n–file:./\n\n–classpath:/config/\n\n–classpath:/\n")])])]),a("p",[n._v("优先级由高到底，高优先级的配置会覆盖低优先级的配置；")]),n._v(" "),a("p",[n._v("SpringBoot会从这四个位置全部加载主配置文件；"),a("strong",[n._v("互补配置")]),n._v("；")]),n._v(" "),a("p",[n._v("==我们还可以通过spring.config.location来改变默认的配置文件位置==")]),n._v(" "),a("p",[a("strong",[n._v("项目打包好以后，我们可以使用命令行参数的形式，启动项目的时候来指定配置文件的新位置；指定配置文件和默认加载的这些配置文件共同起作用形成互补配置；")])]),n._v(" "),a("p",[n._v("java -jar spring-boot-02-config-02-0.0.1-SNAPSHOT.jar --spring.config.location=G:/application.properties")]),n._v(" "),a("h2",{attrs:{id:"_7、外部配置加载顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7、外部配置加载顺序"}},[n._v("#")]),n._v(" 7、外部配置加载顺序")]),n._v(" "),a("p",[a("strong",[n._v("SpringBoot由jar包外向jar包内进行寻找； 优先级从高到低；高优先级的配置覆盖低优先级的配置，所有的配置会形成互补配置")])]),n._v(" "),a("p",[n._v("所有的配置都可以在命令行上进行指定")]),n._v(" "),a("p",[n._v("java -jar demo-0.0.1-SNAPSHOT.jar --server.port=8087  --server.context-path=/myconfig")]),n._v(" "),a("p",[n._v("多个配置用空格分开； --配置项=值")]),n._v(" "),a("p",[a("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/reference/htmlsingle/#boot-features-external-config",target:"_blank",rel:"noopener noreferrer"}},[n._v("参考官方文档"),a("OutboundLink")],1)]),n._v(" "),a("h2",{attrs:{id:"_8、自动配置原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8、自动配置原理"}},[n._v("#")]),n._v(" 8、自动配置原理")]),n._v(" "),a("p",[n._v("配置文件到底能写什么？怎么写？自动配置原理；")]),n._v(" "),a("p",[a("a",{attrs:{href:"https://docs.spring.io/spring-boot/docs/1.5.9.RELEASE/reference/htmlsingle/#common-application-properties",target:"_blank",rel:"noopener noreferrer"}},[n._v("配置文件能配置的属性参照"),a("OutboundLink")],1)]),n._v(" "),a("h3",{attrs:{id:"_1、自动配置原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、自动配置原理"}},[n._v("#")]),n._v(" 1、"),a("strong",[n._v("自动配置原理：")])]),n._v(" "),a("p",[a("strong",[n._v("1、SpringBoot启动的时候加载主配置类，开启了自动配置功能 @EnableAutoConfiguration")])]),n._v(" "),a("p",[a("strong",[n._v("2、@EnableAutoConfiguration 作用：")])]),n._v(" "),a("ul",[a("li",[a("p",[n._v("利用AutoConfigurationImportSelector给容器中导入一些组件？")])]),n._v(" "),a("li",[a("p",[n._v("可以查看selectImports()方法的内容；")])])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("List<String> configurations = this.getCandidateConfigurations(annotationMetadata, attributes);\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("获取候选的配置")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("  SpringFactoriesLoader.loadFactoryNames()\n    org.springframework.core.io.support.SpringFactoriesLoader#loadSpringFactories\n  扫描所有jar包类路径下  META-INF/spring.factories\n    把扫描到的这些文件的内容包装成properties对象\n  从properties中获取到EnableAutoConfiguration.class类（类名）对应的值，然后把他们添加在容器中\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[a("strong",[n._v("将类路径下  META-INF/spring.factories 里面配置的所有EnableAutoConfiguration的值加入到了容器中；")])]),n._v(" "),a("p",[a("img",{attrs:{src:"images/1571731430990.png",alt:"1571731430990"}})]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("# Initializers\norg.springframework.context.ApplicationContextInitializer=\\\norg.springframework.boot.autoconfigure.SharedMetadataReaderFactoryContextInitializer,\\\norg.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener\n\n# Application Listeners\norg.springframework.context.ApplicationListener=\\\norg.springframework.boot.autoconfigure.BackgroundPreinitializer\n\n# Auto Configuration Import Listeners\norg.springframework.boot.autoconfigure.AutoConfigurationImportListener=\\\norg.springframework.boot.autoconfigure.condition.ConditionEvaluationReportAutoConfigurationImportListener\n\n# Auto Configuration Import Filters\norg.springframework.boot.autoconfigure.AutoConfigurationImportFilter=\\\norg.springframework.boot.autoconfigure.condition.OnBeanCondition,\\\norg.springframework.boot.autoconfigure.condition.OnClassCondition,\\\norg.springframework.boot.autoconfigure.condition.OnWebApplicationCondition\n\n# Auto Configure\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\norg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\norg.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\\\norg.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\\\norg.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\\\norg.springframework.boot.autoconfigure.cloud.CloudServiceConnectorsAutoConfiguration,\\\norg.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\\\norg.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\\\norg.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.elasticsearch.ReactiveRestClientAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.jdbc.JdbcRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\\\norg.springframework.boot.autoconfigure.elasticsearch.jest.JestAutoConfiguration,\\\norg.springframework.boot.autoconfigure.elasticsearch.rest.RestClientAutoConfiguration,\\\norg.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\\\norg.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\\\norg.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\\\norg.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\\\norg.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\\\norg.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\\\norg.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\\\norg.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\\\norg.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\\\norg.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\\\norg.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\\\norg.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\\\norg.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\\\norg.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\\\norg.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\\\norg.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\\\norg.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\\\norg.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\\\norg.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\\\norg.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\\\norg.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\\\norg.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\\\norg.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\\\norg.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\\\norg.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\\\norg.springframework.boot.autoconfigure.rsocket.RSocketMessagingAutoConfiguration,\\\norg.springframework.boot.autoconfigure.rsocket.RSocketRequesterAutoConfiguration,\\\norg.springframework.boot.autoconfigure.rsocket.RSocketServerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.rsocket.RSocketStrategiesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.rsocket.RSocketSecurityAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.saml2.Saml2RelyingPartyAutoConfiguration,\\\norg.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\\\norg.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.security.oauth2.resource.reactive.ReactiveOAuth2ResourceServerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\\\norg.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration,\\\norg.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration,\\\norg.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\\\norg.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\\\norg.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\\\norg.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.reactive.function.client.ClientHttpConnectorAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\\\norg.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\\\norg.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\\\norg.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\\\norg.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration,\\\norg.springframework.boot.autoconfigure.webservices.client.WebServiceTemplateAutoConfiguration\n\n# Failure analyzers\norg.springframework.boot.diagnostics.FailureAnalyzer=\\\norg.springframework.boot.autoconfigure.diagnostics.analyzer.NoSuchBeanDefinitionFailureAnalyzer,\\\norg.springframework.boot.autoconfigure.flyway.FlywayMigrationScriptMissingFailureAnalyzer,\\\norg.springframework.boot.autoconfigure.jdbc.DataSourceBeanCreationFailureAnalyzer,\\\norg.springframework.boot.autoconfigure.jdbc.HikariDriverConfigurationFailureAnalyzer,\\\norg.springframework.boot.autoconfigure.session.NonUniqueSessionRepositoryFailureAnalyzer\n\n# Template availability providers\norg.springframework.boot.autoconfigure.template.TemplateAvailabilityProvider=\\\norg.springframework.boot.autoconfigure.freemarker.FreeMarkerTemplateAvailabilityProvider,\\\norg.springframework.boot.autoconfigure.mustache.MustacheTemplateAvailabilityProvider,\\\norg.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAvailabilityProvider,\\\norg.springframework.boot.autoconfigure.thymeleaf.ThymeleafTemplateAvailabilityProvider,\\\norg.springframework.boot.autoconfigure.web.servlet.JspTemplateAvailabilityProvider\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br"),a("span",{staticClass:"line-number"},[n._v("65")]),a("br"),a("span",{staticClass:"line-number"},[n._v("66")]),a("br"),a("span",{staticClass:"line-number"},[n._v("67")]),a("br"),a("span",{staticClass:"line-number"},[n._v("68")]),a("br"),a("span",{staticClass:"line-number"},[n._v("69")]),a("br"),a("span",{staticClass:"line-number"},[n._v("70")]),a("br"),a("span",{staticClass:"line-number"},[n._v("71")]),a("br"),a("span",{staticClass:"line-number"},[n._v("72")]),a("br"),a("span",{staticClass:"line-number"},[n._v("73")]),a("br"),a("span",{staticClass:"line-number"},[n._v("74")]),a("br"),a("span",{staticClass:"line-number"},[n._v("75")]),a("br"),a("span",{staticClass:"line-number"},[n._v("76")]),a("br"),a("span",{staticClass:"line-number"},[n._v("77")]),a("br"),a("span",{staticClass:"line-number"},[n._v("78")]),a("br"),a("span",{staticClass:"line-number"},[n._v("79")]),a("br"),a("span",{staticClass:"line-number"},[n._v("80")]),a("br"),a("span",{staticClass:"line-number"},[n._v("81")]),a("br"),a("span",{staticClass:"line-number"},[n._v("82")]),a("br"),a("span",{staticClass:"line-number"},[n._v("83")]),a("br"),a("span",{staticClass:"line-number"},[n._v("84")]),a("br"),a("span",{staticClass:"line-number"},[n._v("85")]),a("br"),a("span",{staticClass:"line-number"},[n._v("86")]),a("br"),a("span",{staticClass:"line-number"},[n._v("87")]),a("br"),a("span",{staticClass:"line-number"},[n._v("88")]),a("br"),a("span",{staticClass:"line-number"},[n._v("89")]),a("br"),a("span",{staticClass:"line-number"},[n._v("90")]),a("br"),a("span",{staticClass:"line-number"},[n._v("91")]),a("br"),a("span",{staticClass:"line-number"},[n._v("92")]),a("br"),a("span",{staticClass:"line-number"},[n._v("93")]),a("br"),a("span",{staticClass:"line-number"},[n._v("94")]),a("br"),a("span",{staticClass:"line-number"},[n._v("95")]),a("br"),a("span",{staticClass:"line-number"},[n._v("96")]),a("br"),a("span",{staticClass:"line-number"},[n._v("97")]),a("br"),a("span",{staticClass:"line-number"},[n._v("98")]),a("br"),a("span",{staticClass:"line-number"},[n._v("99")]),a("br"),a("span",{staticClass:"line-number"},[n._v("100")]),a("br"),a("span",{staticClass:"line-number"},[n._v("101")]),a("br"),a("span",{staticClass:"line-number"},[n._v("102")]),a("br"),a("span",{staticClass:"line-number"},[n._v("103")]),a("br"),a("span",{staticClass:"line-number"},[n._v("104")]),a("br"),a("span",{staticClass:"line-number"},[n._v("105")]),a("br"),a("span",{staticClass:"line-number"},[n._v("106")]),a("br"),a("span",{staticClass:"line-number"},[n._v("107")]),a("br"),a("span",{staticClass:"line-number"},[n._v("108")]),a("br"),a("span",{staticClass:"line-number"},[n._v("109")]),a("br"),a("span",{staticClass:"line-number"},[n._v("110")]),a("br"),a("span",{staticClass:"line-number"},[n._v("111")]),a("br"),a("span",{staticClass:"line-number"},[n._v("112")]),a("br"),a("span",{staticClass:"line-number"},[n._v("113")]),a("br"),a("span",{staticClass:"line-number"},[n._v("114")]),a("br"),a("span",{staticClass:"line-number"},[n._v("115")]),a("br"),a("span",{staticClass:"line-number"},[n._v("116")]),a("br"),a("span",{staticClass:"line-number"},[n._v("117")]),a("br"),a("span",{staticClass:"line-number"},[n._v("118")]),a("br"),a("span",{staticClass:"line-number"},[n._v("119")]),a("br"),a("span",{staticClass:"line-number"},[n._v("120")]),a("br"),a("span",{staticClass:"line-number"},[n._v("121")]),a("br"),a("span",{staticClass:"line-number"},[n._v("122")]),a("br"),a("span",{staticClass:"line-number"},[n._v("123")]),a("br"),a("span",{staticClass:"line-number"},[n._v("124")]),a("br"),a("span",{staticClass:"line-number"},[n._v("125")]),a("br"),a("span",{staticClass:"line-number"},[n._v("126")]),a("br"),a("span",{staticClass:"line-number"},[n._v("127")]),a("br"),a("span",{staticClass:"line-number"},[n._v("128")]),a("br"),a("span",{staticClass:"line-number"},[n._v("129")]),a("br"),a("span",{staticClass:"line-number"},[n._v("130")]),a("br"),a("span",{staticClass:"line-number"},[n._v("131")]),a("br"),a("span",{staticClass:"line-number"},[n._v("132")]),a("br"),a("span",{staticClass:"line-number"},[n._v("133")]),a("br"),a("span",{staticClass:"line-number"},[n._v("134")]),a("br"),a("span",{staticClass:"line-number"},[n._v("135")]),a("br"),a("span",{staticClass:"line-number"},[n._v("136")]),a("br"),a("span",{staticClass:"line-number"},[n._v("137")]),a("br"),a("span",{staticClass:"line-number"},[n._v("138")]),a("br"),a("span",{staticClass:"line-number"},[n._v("139")]),a("br"),a("span",{staticClass:"line-number"},[n._v("140")]),a("br"),a("span",{staticClass:"line-number"},[n._v("141")]),a("br"),a("span",{staticClass:"line-number"},[n._v("142")]),a("br"),a("span",{staticClass:"line-number"},[n._v("143")]),a("br"),a("span",{staticClass:"line-number"},[n._v("144")]),a("br"),a("span",{staticClass:"line-number"},[n._v("145")]),a("br"),a("span",{staticClass:"line-number"},[n._v("146")]),a("br"),a("span",{staticClass:"line-number"},[n._v("147")]),a("br"),a("span",{staticClass:"line-number"},[n._v("148")]),a("br"),a("span",{staticClass:"line-number"},[n._v("149")]),a("br"),a("span",{staticClass:"line-number"},[n._v("150")]),a("br"),a("span",{staticClass:"line-number"},[n._v("151")]),a("br"),a("span",{staticClass:"line-number"},[n._v("152")]),a("br"),a("span",{staticClass:"line-number"},[n._v("153")]),a("br"),a("span",{staticClass:"line-number"},[n._v("154")]),a("br"),a("span",{staticClass:"line-number"},[n._v("155")]),a("br"),a("span",{staticClass:"line-number"},[n._v("156")]),a("br"),a("span",{staticClass:"line-number"},[n._v("157")]),a("br"),a("span",{staticClass:"line-number"},[n._v("158")]),a("br"),a("span",{staticClass:"line-number"},[n._v("159")]),a("br"),a("span",{staticClass:"line-number"},[n._v("160")]),a("br"),a("span",{staticClass:"line-number"},[n._v("161")]),a("br")])]),a("p",[n._v("每一个这样的  xxxAutoConfiguration类都是容器中的一个组件，都加入到容器中；用他们来做自动配置；")]),n._v(" "),a("p",[a("strong",[n._v("3、每一个自动配置类进行自动配置功能；")])]),n._v(" "),a("p",[a("strong",[n._v("4、以HttpEncodingAutoConfiguration（Http编码自动配置）为例解释自动配置原理；")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Configuration   //表示这是一个配置类，以前编写的配置文件一样，也可以给容器中添加组件\n@EnableConfigurationProperties(HttpEncodingProperties.class)  //启动指定类的ConfigurationProperties功能；将配置文件中对应的值和HttpEncodingProperties绑定起来；并把HttpEncodingProperties加入到ioc容器中\n\n@ConditionalOnWebApplication //Spring底层@Conditional注解，根据不同的条件，如果满足指定的条件，整个配置类里面的配置就会生效；    判断当前应用是否是web应用，如果是，当前配置类生效\n\n@ConditionalOnClass(CharacterEncodingFilter.class)  //判断当前项目有没有这个类CharacterEncodingFilter；SpringMVC中进行乱码解决的过滤器；\n\n@ConditionalOnProperty(prefix = "spring.http.encoding", value = "enabled", matchIfMissing = true)  //判断配置文件中是否存在某个配置  spring.http.encoding.enabled；如果不存在，判断也是成立的\n//即使我们配置文件中不配置pring.http.encoding.enabled=true，也是默认生效的；\npublic class HttpEncodingAutoConfiguration {\n  \n  \t//他已经和SpringBoot的配置文件映射了\n  \tprivate final HttpEncodingProperties properties;\n  \n   //只有一个有参构造器的情况下，参数的值就会从容器中拿\n  \tpublic HttpEncodingAutoConfiguration(HttpEncodingProperties properties) {\n\t\tthis.properties = properties;\n\t}\n  \n    @Bean   //给容器中添加一个组件，这个组件的某些值需要从properties中获取\n\t@ConditionalOnMissingBean(CharacterEncodingFilter.class) //判断容器没有这个组件？\n\tpublic CharacterEncodingFilter characterEncodingFilter() {\n\t\tCharacterEncodingFilter filter = new OrderedCharacterEncodingFilter();\n\t\tfilter.setEncoding(this.properties.getCharset().name());\n\t\tfilter.setForceRequestEncoding(this.properties.shouldForce(Type.REQUEST));\n\t\tfilter.setForceResponseEncoding(this.properties.shouldForce(Type.RESPONSE));\n\t\treturn filter;\n\t}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br")])]),a("p",[n._v("根据当前不同的条件判断，决定这个配置类是否生效？")]),n._v(" "),a("p",[n._v("一但这个配置类生效；这个配置类就会给容器中添加各种组件；这些组件的属性是从对应的properties类中获取的，这些类里面的每一个属性又是和配置文件绑定的；")]),n._v(" "),a("p",[a("strong",[n._v("5、所有在配置文件中能配置的属性都是在xxxxProperties类中封装者‘；配置文件能配置什么就可以参照某个功能对应的这个属性类")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@ConfigurationProperties(prefix = "spring.http.encoding")  //从配置文件中获取指定的值和bean的属性进行绑定\npublic class HttpEncodingProperties {\n\n   public static final Charset DEFAULT_CHARSET = Charset.forName("UTF-8");\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("p",[a("strong",[n._v("总结：")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("1、SpringBoot启动会加载大量的自动配置类")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("2、我们看我们需要的功能有没有SpringBoot默认写好的自动配置类；")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("3、我们再来看这个自动配置类中到底配置了哪些组件；（只要我们要用的组件有，我们就不需要再来配置了）")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("4）、给容器中自动配置类添加组件的时候，会从properties类中获取某些属性。我们就可以在配置文件中指定这些属性的值；")])]),n._v(" "),a("p",[a("strong",[n._v("xxxxAutoConfigurartion：自动配置类；")])]),n._v(" "),a("p",[a("strong",[n._v("给容器中添加组件")])]),n._v(" "),a("p",[a("strong",[n._v("xxxxProperties:封装配置文件中相关属性；")])]),n._v(" "),a("h3",{attrs:{id:"_2、细节"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、细节"}},[n._v("#")]),n._v(" 2、细节")]),n._v(" "),a("h4",{attrs:{id:"_1、-conditional派生注解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、-conditional派生注解"}},[n._v("#")]),n._v(" 1、@Conditional派生注解")]),n._v(" "),a("p",[n._v("作用：必须是@Conditional指定的条件成立，才给容器中添加组件，配置配里面的所有内容才生效；")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("@Conditional扩展注解")]),n._v(" "),a("th",[n._v("作用（判断是否满足当前指定条件）")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("@ConditionalOnJava")]),n._v(" "),a("td",[n._v("系统的java版本是否符合要求")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnBean")]),n._v(" "),a("td",[n._v("容器中存在指定Bean；")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnMissingBean")]),n._v(" "),a("td",[n._v("容器中不存在指定Bean；")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnExpression")]),n._v(" "),a("td",[n._v("满足SpEL表达式指定")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnClass")]),n._v(" "),a("td",[n._v("系统中有指定的类")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnMissingClass")]),n._v(" "),a("td",[n._v("系统中没有指定的类")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnSingleCandidate")]),n._v(" "),a("td",[n._v("容器中只有一个指定的Bean，或者这个Bean是首选Bean")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnProperty")]),n._v(" "),a("td",[n._v("系统中指定的属性是否有指定的值")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnResource")]),n._v(" "),a("td",[n._v("类路径下是否存在指定资源文件")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnWebApplication")]),n._v(" "),a("td",[n._v("当前是web环境")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnNotWebApplication")]),n._v(" "),a("td",[n._v("当前不是web环境")])]),n._v(" "),a("tr",[a("td",[n._v("@ConditionalOnJndi")]),n._v(" "),a("td",[n._v("JNDI存在指定项")])])])]),n._v(" "),a("p",[a("strong",[n._v("自动配置类必须在一定的条件下才能生效；")])]),n._v(" "),a("p",[n._v("我们怎么知道哪些自动配置类生效；")]),n._v(" "),a("p",[a("strong",[n._v("我们可以通过启用  debug=true属性；来让控制台打印自动配置报告")]),n._v("，这样我们就可以很方便的知道哪些自动配置类生效；")]),n._v(" "),a("h1",{attrs:{id:"三、数据访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、数据访问"}},[n._v("#")]),n._v(" 三、数据访问")]),n._v(" "),a("h2",{attrs:{id:"_1、jdbc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、jdbc"}},[n._v("#")]),n._v(" 1、JDBC")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-jdbc</artifactId>\n</dependency>\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <scope>runtime</scope>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("spring:\n  datasource:\n    username: root\n    password: 123456\n    url: jdbc:mysql://192.168.15.22:3306/jdbc\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    schema:\n      - classpath:department.sql\n    initialization-mode: always\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("效果：")]),n._v(" "),a("p",[n._v("​\t默认是用com.zaxxer.hikari.HikariDataSource作为数据源；")]),n._v(" "),a("p",[n._v("（之前是org.apache.tomcat.jdbc.pool.DataSource）")]),n._v(" "),a("p",[n._v("​\t数据源的相关配置都在DataSourceProperties里面；")]),n._v(" "),a("p",[n._v("自动配置原理：")]),n._v(" "),a("p",[n._v("org.springframework.boot.autoconfigure.jdbc：")]),n._v(" "),a("p",[n._v("1、参考DataSourceConfiguration，根据配置创建数据源，默认使用Tomcat连接池；可以使用spring.datasource.type指定自定义的数据源类型；")]),n._v(" "),a("p",[n._v("2、SpringBoot默认可以支持；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("org.apache.tomcat.jdbc.pool.DataSource、HikariDataSource、BasicDataSource、\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("3、自定义数据源类型")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('/**\n * Generic DataSource configuration.\n */\n@ConditionalOnMissingBean(DataSource.class)\n@ConditionalOnProperty(name = "spring.datasource.type")\nstatic class Generic {\n\n   @Bean\n   public DataSource dataSource(DataSourceProperties properties) {\n       //使用DataSourceBuilder创建数据源，利用反射创建响应type的数据源，并且绑定相关属性\n      return properties.initializeDataSourceBuilder().build();\n   }\n\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br")])]),a("p",[n._v("4、"),a("strong",[n._v("DataSourceInitializer：ApplicationListener")]),n._v("；")]),n._v(" "),a("p",[n._v("​\t作用：")]),n._v(" "),a("p",[n._v("​\t\t1、runSchemaScripts();运行建表语句；")]),n._v(" "),a("p",[n._v("​\t\t2、runDataScripts();运行插入数据的sql语句；")]),n._v(" "),a("p",[n._v("默认只需要将文件命名为： "),a("strong",[n._v("DataSourceInitializationMode")]),n._v(" 数据源初始化模式有三种模式：ALWAYS，EMBEDDED，NEVER，默认值为“EMBEDDED”")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("schema-*.sql、data-*.sql\n默认规则：schema.sql，schema-all.sql；\n可以使用   \n\tschema:\n      - classpath:department.sql\n      指定位置\n    initialization-mode: always  \n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[n._v("5、操作数据库：自动配置了JdbcTemplate操作数据库")]),n._v(" "),a("h2",{attrs:{id:"_2、整合druid数据源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、整合druid数据源"}},[n._v("#")]),n._v(" 2、整合Druid数据源")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\x3c!--引入druid数据源--\x3e\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>druid-spring-boot-starter</artifactId>\n    <version>${druid.version}</version>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('druid:\n      # 连接池的配置信息\n      # 初始化大小，最小，最大\n      initial-size: 5\n      min-idle: 5\n      maxActive: 20\n      # 配置获取连接等待超时的时间\n      maxWait: 60000\n      # 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒\n      timeBetweenEvictionRunsMillis: 60000\n      # 配置一个连接在池中最小生存的时间，单位是毫秒\n      minEvictableIdleTimeMillis: 300000\n      validationQuery: SELECT 1\n      testWhileIdle: true\n      testOnBorrow: false\n      testOnReturn: false\n      # 打开PSCache，并且指定每个连接上PSCache的大小\n      poolPreparedStatements: true\n      maxPoolPreparedStatementPerConnectionSize: 20\n      # 配置监控统计拦截的filters，去掉后监控界面sql无法统计，\'wall\'用于防火墙\n      filters: stat,wall,slf4j\n      # 通过connectProperties属性来打开mergeSql功能；慢SQL记录\n      connectionProperties: druid.stat.mergeSql\\=true;druid.stat.slowSqlMillis\\=5000\n      # 配置DruidStatFilter\n      web-stat-filter:\n        enabled: true\n        url-pattern: "/*"\n        exclusions: "*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*"\n      # 配置DruidStatViewServlet\n      stat-view-servlet:\n        # 开启监控web页面\n        enabled: true\n        url-pattern: "/druid/*"\n        # IP白名单(没有配置或者为空，则允许所有访问)\n        allow: 127.0.0.1,192.168.179.65\n        # IP黑名单 (存在共同时，deny优先于allow)\n        deny: 192.168.1.73\n        #  禁用HTML页面上的“Reset All”功能\n        reset-enable: false\n        # 登录名\n        login-username: admin\n        # 登录密码\n        login-password: 123456\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br")])]),a("h2",{attrs:{id:"_3、整合mybatis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、整合mybatis"}},[n._v("#")]),n._v(" 3、整合MyBatis")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n    <groupId>org.mybatis.spring.boot</groupId>\n    <artifactId>mybatis-spring-boot-starter</artifactId>\n    <version>${mybatis.version}</version>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180305194443.png",alt:""}})]),n._v(" "),a("p",[n._v("步骤：")]),n._v(" "),a("p",[n._v("​\t1、配置数据源相关属性")]),n._v(" "),a("p",[n._v("​\t2、给数据库建表")]),n._v(" "),a("p",[n._v("​\t3、创建JavaBean")]),n._v(" "),a("h3",{attrs:{id:"_4、注解版"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、注解版"}},[n._v("#")]),n._v(" 4、注解版")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//指定这是一个操作数据库的mapper\n@Mapper\npublic interface DepartmentMapper {\n\n    @Select("select * from department where id=#{id}")\n    public Department getDeptById(Integer id);\n\n    @Delete("delete from department where id=#{id}")\n    public int deleteDeptById(Integer id);\n\n    @Options(useGeneratedKeys = true,keyProperty = "id")\n    @Insert("insert into department(departmentName) values(#{departmentName})")\n    public int insertDept(Department department);\n\n    @Update("update department set departmentName=#{departmentName} where id=#{id}")\n    public int updateDept(Department department);\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br")])]),a("p",[n._v("问题：")]),n._v(" "),a("p",[n._v("自定义MyBatis的配置规则；给容器中添加一个ConfigurationCustomizer；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@org.springframework.context.annotation.Configuration\npublic class MyBatisConfig {\n\n    @Bean\n    public ConfigurationCustomizer configurationCustomizer(){\n        return configuration -> configuration.setMapUnderscoreToCamelCase(true);\n    }\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//使用MapperScan批量扫描所有的Mapper接口；\n@MapperScan(value = "com.cmcc.demo.demo.mapper")\n@SpringBootApplication\npublic class DemoApplication {\n\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(DemoApplication.class, args);\n\t}\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("h3",{attrs:{id:"_5、配置版"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、配置版"}},[n._v("#")]),n._v(" 5、配置版")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("mybatis:\n  config-location: classpath:mybatis/mybatis-config.xml 指定全局配置文件的位置\n  mapper-locations: classpath:mybatis/mapper/*.xml  指定sql映射文件的位置\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE configuration\n        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n\n    <settings>\n        <setting name="mapUnderscoreToCamelCase" value="true"/>\n    </settings>\n</configuration>\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.cmcc.demo.demo.mapper.EmployeeMapper">\n    <select id="getEmpById" resultType="com.cmcc.demo.demo.entity.Employee">\n        SELECT * FROM employee WHERE id=#{id}\n    </select>\n\n    <insert id="insertEmp">\n        INSERT INTO employee(lastName,email,gender,d_id) VALUES (#{lastName},#{email},#{gender},#{dId})\n    </insert>\n</mapper>\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br")])]),a("p",[a("a",{attrs:{href:"http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/",target:"_blank",rel:"noopener noreferrer"}},[n._v("更多使用参照"),a("OutboundLink")],1)]),n._v(" "),a("h2",{attrs:{id:"_4、整合springdata-jpa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、整合springdata-jpa"}},[n._v("#")]),n._v(" 4、整合SpringData JPA")]),n._v(" "),a("h3",{attrs:{id:"_1、springdata简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、springdata简介"}},[n._v("#")]),n._v(" 1、SpringData简介")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180306105412.png",alt:""}})]),n._v(" "),a("h3",{attrs:{id:"_2、整合springdata-jpa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、整合springdata-jpa"}},[n._v("#")]),n._v(" 2、整合SpringData JPA")]),n._v(" "),a("p",[n._v("JPA:ORM（Object Relational Mapping）；")]),n._v(" "),a("p",[n._v("1、编写一个实体类（bean）和数据表进行映射，并且配置好映射关系；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//使用JPA注解配置映射关系\n@Entity //告诉JPA这是一个实体类（和数据表映射的类）\n@Table(name = "tbl_user") //@Table来指定和哪个数据表对应;如果省略默认表名就是user；\npublic class User {\n\n    @Id //这是一个主键\n    @GeneratedValue(strategy = GenerationType.IDENTITY)//自增主键\n    private Integer id;\n\n    @Column(name = "last_name",length = 50) //这是和数据表对应的一个列\n    private String lastName;\n    @Column //省略默认列名就是属性名\n    private String email;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br")])]),a("p",[n._v("2、编写一个Dao接口来操作实体类对应的数据表（Repository）")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("//继承JpaRepository来完成对数据库的操作\npublic interface UserRepository extends JpaRepository<User,Integer> {\n}\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("p",[n._v("3、基本的配置JpaProperties")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("spring:  \n jpa:\n    hibernate:\n#     更新或者创建数据表结构\n      ddl-auto: update\n#    控制台显示SQL\n    show-sql: true\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("h1",{attrs:{id:"四、原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、原理"}},[n._v("#")]),n._v(" 四、原理")]),n._v(" "),a("h2",{attrs:{id:"_1、简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、简介"}},[n._v("#")]),n._v(" 1、简介")]),n._v(" "),a("p",[n._v("使用SpringBoot；")]),n._v(" "),a("p",[a("strong",[n._v("1、创建SpringBoot应用，选中我们需要的模块；")])]),n._v(" "),a("p",[a("strong",[n._v("2、SpringBoot已经默认将这些场景配置好了，只需要在配置文件中指定少量配置就可以运行起来")])]),n._v(" "),a("p",[a("strong",[n._v("3、自己编写业务代码；")])]),n._v(" "),a("h2",{attrs:{id:"_2、springboot对静态资源的映射规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、springboot对静态资源的映射规则"}},[n._v("#")]),n._v(" 2、SpringBoot对静态资源的映射规则；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@ConfigurationProperties(prefix = "spring.resources", ignoreUnknownFields = false)\npublic class ResourceProperties implements ResourceLoaderAware {\n  //可以设置和静态资源有关的参数，缓存时间等\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('\tWebMvcAuotConfiguration：\n\t\t@Override\n\t\tpublic void addResourceHandlers(ResourceHandlerRegistry registry) {\n\t\t\tif (!this.resourceProperties.isAddMappings()) {\n\t\t\t\tlogger.debug("Default resource handling disabled");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tInteger cachePeriod = this.resourceProperties.getCachePeriod();\n\t\t\tif (!registry.hasMappingForPattern("/webjars/**")) {\n\t\t\t\tcustomizeResourceHandlerRegistration(\n\t\t\t\t\t\tregistry.addResourceHandler("/webjars/**")\n\t\t\t\t\t\t\t\t.addResourceLocations(\n\t\t\t\t\t\t\t\t\t\t"classpath:/META-INF/resources/webjars/")\n\t\t\t\t\t\t.setCachePeriod(cachePeriod));\n\t\t\t}\n\t\t\tString staticPathPattern = this.mvcProperties.getStaticPathPattern();\n          \t//静态资源文件夹映射\n\t\t\tif (!registry.hasMappingForPattern(staticPathPattern)) {\n\t\t\t\tcustomizeResourceHandlerRegistration(\n\t\t\t\t\t\tregistry.addResourceHandler(staticPathPattern)\n\t\t\t\t\t\t\t\t.addResourceLocations(\n\t\t\t\t\t\t\t\t\t\tthis.resourceProperties.getStaticLocations())\n\t\t\t\t\t\t.setCachePeriod(cachePeriod));\n\t\t\t}\n\t\t}\n\n        //配置欢迎页映射\n\t\t@Bean\n\t\tpublic WelcomePageHandlerMapping welcomePageHandlerMapping(\n\t\t\t\tResourceProperties resourceProperties) {\n\t\t\treturn new WelcomePageHandlerMapping(resourceProperties.getWelcomePage(),\n\t\t\t\t\tthis.mvcProperties.getStaticPathPattern());\n\t\t}\n\n       //配置喜欢的图标\n\t\t@Configuration\n\t\t@ConditionalOnProperty(value = "spring.mvc.favicon.enabled", matchIfMissing = true)\n\t\tpublic static class FaviconConfiguration {\n\n\t\t\tprivate final ResourceProperties resourceProperties;\n\n\t\t\tpublic FaviconConfiguration(ResourceProperties resourceProperties) {\n\t\t\t\tthis.resourceProperties = resourceProperties;\n\t\t\t}\n\n\t\t\t@Bean\n\t\t\tpublic SimpleUrlHandlerMapping faviconHandlerMapping() {\n\t\t\t\tSimpleUrlHandlerMapping mapping = new SimpleUrlHandlerMapping();\n\t\t\t\tmapping.setOrder(Ordered.HIGHEST_PRECEDENCE + 1);\n              \t//所有  **/favicon.ico \n\t\t\t\tmapping.setUrlMap(Collections.singletonMap("**/favicon.ico",\n\t\t\t\t\t\tfaviconRequestHandler()));\n\t\t\t\treturn mapping;\n\t\t\t}\n\n\t\t\t@Bean\n\t\t\tpublic ResourceHttpRequestHandler faviconRequestHandler() {\n\t\t\t\tResourceHttpRequestHandler requestHandler = new ResourceHttpRequestHandler();\n\t\t\t\trequestHandler\n\t\t\t\t\t\t.setLocations(this.resourceProperties.getFaviconLocations());\n\t\t\t\treturn requestHandler;\n\t\t\t}\n\n\t\t}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br")])]),a("h2",{attrs:{id:"_3、springmvc自动配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、springmvc自动配置"}},[n._v("#")]),n._v(" 3、SpringMVC自动配置")]),n._v(" "),a("h3",{attrs:{id:"_1-扩展配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-扩展配置"}},[n._v("#")]),n._v(" 1. 扩展配置")]),n._v(" "),a("p",[a("strong",[n._v("编写一个配置类（@Configuration），是WebMvcConfigurerAdapter类型；不能标注@EnableWebMvc")]),n._v(";")]),n._v(" "),a("p",[a("strong",[n._v("既保留了所有的自动配置，也能用我们扩展的配置；")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//使用WebMvcConfigurerAdapter可以来扩展SpringMVC的功能\n@Configuration\npublic class MyMvcConfig extends WebMvcConfigurerAdapter {\n\n    @Override\n    public void addViewControllers(ViewControllerRegistry registry) {\n       // super.addViewControllers(registry);\n        //浏览器发送 /demo 请求来到 success\n        registry.addViewController("/demo").setViewName("success");\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br")])]),a("p",[n._v("原理：")]),n._v(" "),a("p",[n._v("​\t1、WebMvcAutoConfiguration是SpringMVC的自动配置类")]),n._v(" "),a("p",[n._v("​\t2、在做其他自动配置时会导入；@Import("),a("strong",[n._v("EnableWebMvcConfiguration")]),n._v(".class)")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("    @Configuration\n\tpublic static class EnableWebMvcConfiguration extends DelegatingWebMvcConfiguration {\n      private final WebMvcConfigurerComposite configurers = new WebMvcConfigurerComposite();\n\n\t //从容器中获取所有的WebMvcConfigurer\n      @Autowired(required = false)\n      public void setConfigurers(List<WebMvcConfigurer> configurers) {\n          if (!CollectionUtils.isEmpty(configurers)) {\n              this.configurers.addWebMvcConfigurers(configurers);\n            \t//一个参考实现；将所有的WebMvcConfigurer相关配置都来一起调用；  \n            \t@Override\n             // public void addViewControllers(ViewControllerRegistry registry) {\n              //    for (WebMvcConfigurer delegate : this.delegates) {\n               //       delegate.addViewControllers(registry);\n               //   }\n              }\n          }\n\t}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br")])]),a("p",[n._v("​\t3、容器中所有的WebMvcConfigurer都会一起起作用；")]),n._v(" "),a("p",[n._v("​\t4、我们的配置类也会被调用；")]),n._v(" "),a("p",[n._v("​\t效果：SpringMVC的自动配置和我们的扩展配置都会起作用；")]),n._v(" "),a("h3",{attrs:{id:"_3、全面接管springmvc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、全面接管springmvc"}},[n._v("#")]),n._v(" 3、全面接管SpringMVC；")]),n._v(" "),a("p",[n._v("SpringBoot对SpringMVC的自动配置不需要了，所有都是我们自己配置；所有的SpringMVC的自动配置都失效了")]),n._v(" "),a("p",[a("strong",[n._v("我们需要在配置类中添加@EnableWebMvc即可；")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//使用WebMvcConfigurerAdapter可以来扩展SpringMVC的功能\n@EnableWebMvc\n@Configuration\npublic class MyMvcConfig extends WebMvcConfigurerAdapter {\n\n    @Override\n    public void addViewControllers(ViewControllerRegistry registry) {\n       // super.addViewControllers(registry);\n        //浏览器发送 /demo 请求来到 success\n        registry.addViewController("/demo").setViewName("success");\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br")])]),a("p",[n._v("原理：")]),n._v(" "),a("p",[n._v("为什么@EnableWebMvc自动配置就失效了；")]),n._v(" "),a("p",[n._v("1）@EnableWebMvc的核心")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Import(DelegatingWebMvcConfiguration.class)\npublic @interface EnableWebMvc {\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br")])]),a("p",[n._v("2、")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Configuration\npublic class DelegatingWebMvcConfiguration extends WebMvcConfigurationSupport {\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br")])]),a("p",[n._v("3、")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Configuration\n@ConditionalOnWebApplication\n@ConditionalOnClass({ Servlet.class, DispatcherServlet.class,\n\t\tWebMvcConfigurerAdapter.class })\n//容器中没有这个组件的时候，这个自动配置类才生效\n@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)\n@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)\n@AutoConfigureAfter({ DispatcherServletAutoConfiguration.class,\n\t\tValidationAutoConfiguration.class })\npublic class WebMvcAutoConfiguration {\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br")])]),a("p",[n._v("4、@EnableWebMvc将WebMvcConfigurationSupport组件导入进来；")]),n._v(" "),a("p",[n._v("5、导入的WebMvcConfigurationSupport只是SpringMVC最基本的功能；")]),n._v(" "),a("h2",{attrs:{id:"_4、如何修改springboot的默认配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、如何修改springboot的默认配置"}},[n._v("#")]),n._v(" 4、如何修改SpringBoot的默认配置")]),n._v(" "),a("p",[a("strong",[n._v("springboot设计的配置模式：")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("1、SpringBoot在自动配置很多组件的时候，先看容器中有没有用户自己配置的（@Bean、@Component）如果有就用用户配置的，如果没有，才自动配置；如果有些组件可以有多个（ViewResolver）将用户配置的和自己默认的组合起来；")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("2、在SpringBoot中会有非常多的xxxConfigurer帮助我们进行扩展配置")])]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("3、在SpringBoot中会有很多的xxxCustomizer帮助我们进行定制配置")])]),n._v(" "),a("h2",{attrs:{id:"_5、错误处理机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、错误处理机制"}},[n._v("#")]),n._v(" 5、错误处理机制")]),n._v(" "),a("h3",{attrs:{id:"_1、springboot默认的错误处理机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、springboot默认的错误处理机制"}},[n._v("#")]),n._v(" 1、SpringBoot默认的错误处理机制")]),n._v(" "),a("p",[n._v("默认效果：")]),n._v(" "),a("p",[n._v("​\t\t1、浏览器，返回一个默认的错误页面")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180226173408.png",alt:""}})]),n._v(" "),a("p",[n._v("浏览器发送请求的请求头：")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180226180347.png",alt:""}})]),n._v(" "),a("p",[n._v("​\t\t2、如果是其他客户端，默认响应一个json数据")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180226173527.png",alt:""}})]),n._v(" "),a("p",[n._v("​\t\t"),a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180226180504.png",alt:""}})]),n._v(" "),a("p",[n._v("原理：")]),n._v(" "),a("p",[n._v("​\t可以参照ErrorMvcAutoConfiguration；错误处理的自动配置；")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("给容器中添加了以下组件\n")])])]),a("p",[n._v("​\t1、DefaultErrorAttributes：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('// 帮我们在页面共享信息；\n@Override\npublic Map<String, Object> getErrorAttributes(RequestAttributes requestAttributes,\n        boolean includeStackTrace) {\n    Map<String, Object> errorAttributes = new LinkedHashMap<String, Object>();\n    errorAttributes.put("timestamp", new Date());\n    addStatus(errorAttributes, requestAttributes);\n    addErrorDetails(errorAttributes, requestAttributes, includeStackTrace);\n    addPath(errorAttributes, requestAttributes);\n    return errorAttributes;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br")])]),a("p",[n._v("​\t2、BasicErrorController：处理默认/error请求")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Controller\n@RequestMapping("${server.error.path:${error.path:/error}}")\npublic class BasicErrorController extends AbstractErrorController {\n    \n    @RequestMapping(produces = "text/html")//产生html类型的数据；浏览器发送的请求来到这个方法处理\n\tpublic ModelAndView errorHtml(HttpServletRequest request,\n\t\t\tHttpServletResponse response) {\n\t\tHttpStatus status = getStatus(request);\n\t\tMap<String, Object> model = Collections.unmodifiableMap(getErrorAttributes(\n\t\t\t\trequest, isIncludeStackTrace(request, MediaType.TEXT_HTML)));\n\t\tresponse.setStatus(status.value());\n        \n        //去哪个页面作为错误页面；包含页面地址和页面内容\n\t\tModelAndView modelAndView = resolveErrorView(request, response, status, model);\n\t\treturn (modelAndView == null ? new ModelAndView("error", model) : modelAndView);\n\t}\n\n\t@RequestMapping\n\t@ResponseBody    //产生json数据，其他客户端来到这个方法处理；\n\tpublic ResponseEntity<Map<String, Object>> error(HttpServletRequest request) {\n\t\tMap<String, Object> body = getErrorAttributes(request,\n\t\t\t\tisIncludeStackTrace(request, MediaType.ALL));\n\t\tHttpStatus status = getStatus(request);\n\t\treturn new ResponseEntity<Map<String, Object>>(body, status);\n\t}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br")])]),a("p",[n._v("​\t3、ErrorPageCustomizer：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('\t@Value("${error.path:/error}")\n\tprivate String path = "/error";  系统出现错误以后来到error请求进行处理；（web.xml注册的错误页面规则）\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br")])]),a("p",[n._v("​\t4、DefaultErrorViewResolver：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Override\npublic ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status,\n        Map<String, Object> model) {\n    ModelAndView modelAndView = resolve(String.valueOf(status), model);\n    if (modelAndView == null && SERIES_VIEWS.containsKey(status.series())) {\n        modelAndView = resolve(SERIES_VIEWS.get(status.series()), model);\n    }\n    return modelAndView;\n}\n\nprivate ModelAndView resolve(String viewName, Map<String, Object> model) {\n    //默认SpringBoot可以去找到一个页面？  error/404\n    String errorViewName = "error/" + viewName;\n    \n    //模板引擎可以解析这个页面地址就用模板引擎解析\n    TemplateAvailabilityProvider provider = this.templateAvailabilityProviders\n            .getProvider(errorViewName, this.applicationContext);\n    if (provider != null) {\n        //模板引擎可用的情况下返回到errorViewName指定的视图地址\n        return new ModelAndView(errorViewName, model);\n    }\n    //模板引擎不可用，就在静态资源文件夹下找errorViewName对应的页面   error/404.html\n    return resolveResource(errorViewName, model);\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br")])]),a("p",[n._v("​\t步骤：")]),n._v(" "),a("p",[n._v("​\t\t一但系统出现4xx或者5xx之类的错误；ErrorPageCustomizer就会生效（定制错误的响应规则）；就会来到/error请求；就会被"),a("strong",[n._v("BasicErrorController")]),n._v("处理 响应页面；去哪个页面是由"),a("strong",[n._v("DefaultErrorViewResolver")]),n._v("解析得到的。")]),n._v(" "),a("h3",{attrs:{id:"_2、如何定制错误响应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、如何定制错误响应"}},[n._v("#")]),n._v(" 2、如何定制错误响应；")]),n._v(" "),a("p",[n._v("​\t\t1、自定义异常处理&返回定制json数据；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@ControllerAdvice\npublic class MyExceptionHandler {\n\n    @ResponseBody\n    @ExceptionHandler(UserNotExistException.class)\n    public Map<String,Object> handleException(Exception e){\n        Map<String,Object> map = new HashMap<>();\n        map.put("code","user.notexist");\n        map.put("message",e.getMessage());\n        return map;\n    }\n}\n//没有自适应效果...\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br")])]),a("p",[n._v("​\t\t2、转发到/error进行自适应响应效果处理")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v(' @ExceptionHandler(UserNotExistException.class)\n    public String handleException(Exception e, HttpServletRequest request){\n        Map<String,Object> map = new HashMap<>();\n        //传入我们自己的错误状态码  4xx 5xx，否则就不会进入定制错误页面的解析流程\n        /**\n         * Integer statusCode = (Integer) request\n         .getAttribute("javax.servlet.error.status_code");\n         */\n        request.setAttribute("javax.servlet.error.status_code",500);\n        map.put("code","user.notexist");\n        map.put("message",e.getMessage());\n        //转发到/error\n        return "forward:/error";\n    }\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br")])]),a("h3",{attrs:{id:"_3、将我们的定制数据携带出去"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、将我们的定制数据携带出去"}},[n._v("#")]),n._v(" 3、将我们的定制数据携带出去；")]),n._v(" "),a("p",[n._v("出现错误以后，会来到/error请求，会被BasicErrorController处理，响应出去可以获取的数据是由getErrorAttributes得到的（是AbstractErrorController（ErrorController规定的方法；")]),n._v(" "),a("p",[n._v("​\t1、完全来编写一个ErrorController的实现类【或者是编写AbstractErrorController的子类】，放在容器中；")]),n._v(" "),a("p",[n._v("​\t2、页面上能用的数据，或者是json返回能用的数据都是通过errorAttributes.getErrorAttributes得到；")]),n._v(" "),a("p",[n._v("​\t\t\t容器中DefaultErrorAttributes.getErrorAttributes()；默认进行数据处理的；")]),n._v(" "),a("p",[n._v("自定义ErrorAttributes")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//给容器中加入我们自己定义的ErrorAttributes\n@Component\npublic class MyErrorAttributes extends DefaultErrorAttributes {\n\n    @Override\n    public Map<String, Object> getErrorAttributes(RequestAttributes requestAttributes, boolean includeStackTrace) {\n        Map<String, Object> map = super.getErrorAttributes(requestAttributes, includeStackTrace);\n        map.put("company","demo");\n        return map;\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br")])]),a("p",[n._v("最终的效果：响应是自适应的，可以通过定制ErrorAttributes改变需要返回的内容，")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180228135513.png",alt:""}})]),n._v(" "),a("h2",{attrs:{id:"_6、配置嵌入式servlet容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、配置嵌入式servlet容器"}},[n._v("#")]),n._v(" 6、配置嵌入式Servlet容器")]),n._v(" "),a("p",[n._v("SpringBoot默认使用Tomcat作为嵌入式的Servlet容器；")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180301142915.png",alt:""}})]),n._v(" "),a("p",[n._v("问题？")]),n._v(" "),a("h3",{attrs:{id:"_1、如何定制和修改servlet容器的相关配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、如何定制和修改servlet容器的相关配置"}},[n._v("#")]),n._v(" 1、如何定制和修改Servlet容器的相关配置；")]),n._v(" "),a("p",[n._v("1、修改和server有关的配置（ServerProperties【也是EmbeddedServletContainerCustomizer】；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("server.port=8081\nserver.context-path=/crud\n\nserver.tomcat.uri-encoding=UTF-8\n\n//通用的Servlet容器设置\nserver.xxx\n//Tomcat的设置\nserver.tomcat.xxx\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("2、编写一个"),a("strong",[n._v("EmbeddedServletContainerCustomizer")]),n._v("：嵌入式的Servlet容器的定制器；来修改Servlet容器的配置")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Bean  //一定要将这个定制器加入到容器中\npublic EmbeddedServletContainerCustomizer embeddedServletContainerCustomizer(){\n    return new EmbeddedServletContainerCustomizer() {\n\n        //定制嵌入式的Servlet容器相关的规则\n        @Override\n        public void customize(ConfigurableEmbeddedServletContainer container) {\n            container.setPort(8083);\n        }\n    };\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br")])]),a("h3",{attrs:{id:"_2、注册servlet三大组件【servlet、filter、listener】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、注册servlet三大组件【servlet、filter、listener】"}},[n._v("#")]),n._v(" 2、注册Servlet三大组件【Servlet、Filter、Listener】")]),n._v(" "),a("p",[n._v("由于SpringBoot默认是以jar包的方式启动嵌入式的Servlet容器来启动SpringBoot的web应用，没有web.xml文件。")]),n._v(" "),a("p",[n._v("注册三大组件用以下方式")]),n._v(" "),a("p",[n._v("ServletRegistrationBean")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//注册三大组件\n@Bean\npublic ServletRegistrationBean myServlet(){\n    ServletRegistrationBean registrationBean = new ServletRegistrationBean(new MyServlet(),"/myServlet");\n    return registrationBean;\n}\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[n._v("FilterRegistrationBean")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Bean\npublic FilterRegistrationBean myFilter(){\n    FilterRegistrationBean registrationBean = new FilterRegistrationBean();\n    registrationBean.setFilter(new MyFilter());\n    registrationBean.setUrlPatterns(Arrays.asList("/hello","/myServlet"));\n    return registrationBean;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[n._v("ServletListenerRegistrationBean")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Bean\npublic ServletListenerRegistrationBean myListener(){\n    ServletListenerRegistrationBean<MyListener> registrationBean = new ServletListenerRegistrationBean<>(new MyListener());\n    return registrationBean;\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("SpringBoot帮我们自动SpringMVC的时候，自动的注册SpringMVC的前端控制器；DIspatcherServlet；")]),n._v(" "),a("p",[n._v("DispatcherServletAutoConfiguration中：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Bean(name = DEFAULT_DISPATCHER_SERVLET_REGISTRATION_BEAN_NAME)\n@ConditionalOnBean(value = DispatcherServlet.class, name = DEFAULT_DISPATCHER_SERVLET_BEAN_NAME)\npublic ServletRegistrationBean dispatcherServletRegistration(\n      DispatcherServlet dispatcherServlet) {\n   ServletRegistrationBean registration = new ServletRegistrationBean(\n         dispatcherServlet, this.serverProperties.getServletMapping());\n    //默认拦截： /  所有请求；包静态资源，但是不拦截jsp请求；   /*会拦截jsp\n    //可以通过server.servletPath来修改SpringMVC前端控制器默认拦截的请求路径\n    \n   registration.setName(DEFAULT_DISPATCHER_SERVLET_BEAN_NAME);\n   registration.setLoadOnStartup(\n         this.webMvcProperties.getServlet().getLoadOnStartup());\n   if (this.multipartConfig != null) {\n      registration.setMultipartConfig(this.multipartConfig);\n   }\n   return registration;\n}\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br")])]),a("p",[n._v("2、SpringBoot能不能支持其他的Servlet容器；")]),n._v(" "),a("h3",{attrs:{id:"_3、替换为其他嵌入式servlet容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、替换为其他嵌入式servlet容器"}},[n._v("#")]),n._v(" 3、替换为其他嵌入式Servlet容器")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302114401.png",alt:""}})]),n._v(" "),a("p",[n._v("默认支持：")]),n._v(" "),a("p",[n._v("Tomcat（默认使用")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n   <groupId>org.springframework.boot</groupId>\n   <artifactId>spring-boot-starter-web</artifactId>\n   引入web模块默认就是使用嵌入式的Tomcat作为Servlet容器；\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("Jetty")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\x3c!-- 引入web模块 --\x3e\n<dependency>\n   <groupId>org.springframework.boot</groupId>\n   <artifactId>spring-boot-starter-web</artifactId>\n   <exclusions>\n      <exclusion>\n         <artifactId>spring-boot-starter-tomcat</artifactId>\n         <groupId>org.springframework.boot</groupId>\n      </exclusion>\n   </exclusions>\n</dependency>\n\n\x3c!--引入其他的Servlet容器--\x3e\n<dependency>\n   <artifactId>spring-boot-starter-jetty</artifactId>\n   <groupId>org.springframework.boot</groupId>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br")])]),a("p",[n._v("Undertow")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\x3c!-- 引入web模块 --\x3e\n<dependency>\n   <groupId>org.springframework.boot</groupId>\n   <artifactId>spring-boot-starter-web</artifactId>\n   <exclusions>\n      <exclusion>\n         <artifactId>spring-boot-starter-tomcat</artifactId>\n         <groupId>org.springframework.boot</groupId>\n      </exclusion>\n   </exclusions>\n</dependency>\n\n\x3c!--引入其他的Servlet容器--\x3e\n<dependency>\n   <artifactId>spring-boot-starter-undertow</artifactId>\n   <groupId>org.springframework.boot</groupId>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br")])]),a("h3",{attrs:{id:"_4、嵌入式servlet容器自动配置原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、嵌入式servlet容器自动配置原理"}},[n._v("#")]),n._v(" 4、嵌入式Servlet容器自动配置原理；")]),n._v(" "),a("p",[n._v("EmbeddedServletContainerAutoConfiguration：嵌入式的Servlet容器自动配置？")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)\n@Configuration\n@ConditionalOnWebApplication\n@Import(BeanPostProcessorsRegistrar.class)\n//导入BeanPostProcessorsRegistrar：给容器中导入一些组件\n//导入了EmbeddedServletContainerCustomizerBeanPostProcessor：\n//后置处理器：bean初始化前后（创建完对象，还没赋值赋值）执行初始化工作\npublic class EmbeddedServletContainerAutoConfiguration {\n    \n    @Configuration\n\t@ConditionalOnClass({ Servlet.class, Tomcat.class })//判断当前是否引入了Tomcat依赖；\n\t@ConditionalOnMissingBean(value = EmbeddedServletContainerFactory.class, search = SearchStrategy.CURRENT)//判断当前容器没有用户自己定义EmbeddedServletContainerFactory：嵌入式的Servlet容器工厂；作用：创建嵌入式的Servlet容器\n\tpublic static class EmbeddedTomcat {\n\n\t\t@Bean\n\t\tpublic TomcatEmbeddedServletContainerFactory tomcatEmbeddedServletContainerFactory() {\n\t\t\treturn new TomcatEmbeddedServletContainerFactory();\n\t\t}\n\n\t}\n    \n    /**\n\t * Nested configuration if Jetty is being used.\n\t */\n\t@Configuration\n\t@ConditionalOnClass({ Servlet.class, Server.class, Loader.class,\n\t\t\tWebAppContext.class })\n\t@ConditionalOnMissingBean(value = EmbeddedServletContainerFactory.class, search = SearchStrategy.CURRENT)\n\tpublic static class EmbeddedJetty {\n\n\t\t@Bean\n\t\tpublic JettyEmbeddedServletContainerFactory jettyEmbeddedServletContainerFactory() {\n\t\t\treturn new JettyEmbeddedServletContainerFactory();\n\t\t}\n\n\t}\n\n\t/**\n\t * Nested configuration if Undertow is being used.\n\t */\n\t@Configuration\n\t@ConditionalOnClass({ Servlet.class, Undertow.class, SslClientAuthMode.class })\n\t@ConditionalOnMissingBean(value = EmbeddedServletContainerFactory.class, search = SearchStrategy.CURRENT)\n\tpublic static class EmbeddedUndertow {\n\n\t\t@Bean\n\t\tpublic UndertowEmbeddedServletContainerFactory undertowEmbeddedServletContainerFactory() {\n\t\t\treturn new UndertowEmbeddedServletContainerFactory();\n\t\t}\n\n\t}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br")])]),a("p",[n._v("1、EmbeddedServletContainerFactory（嵌入式Servlet容器工厂）")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("public interface EmbeddedServletContainerFactory {\n\n   //获取嵌入式的Servlet容器\n   EmbeddedServletContainer getEmbeddedServletContainer(\n         ServletContextInitializer... initializers);\n\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302144835.png",alt:""}})]),n._v(" "),a("p",[n._v("2、EmbeddedServletContainer：（嵌入式的Servlet容器）")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302144910.png",alt:""}})]),n._v(" "),a("p",[n._v("3、以"),a("strong",[n._v("TomcatEmbeddedServletContainerFactory")]),n._v("为例")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Override\npublic EmbeddedServletContainer getEmbeddedServletContainer(\n      ServletContextInitializer... initializers) {\n    //创建一个Tomcat\n   Tomcat tomcat = new Tomcat();\n    \n    //配置Tomcat的基本环节\n   File baseDir = (this.baseDirectory != null ? this.baseDirectory\n         : createTempDir("tomcat"));\n   tomcat.setBaseDir(baseDir.getAbsolutePath());\n   Connector connector = new Connector(this.protocol);\n   tomcat.getService().addConnector(connector);\n   customizeConnector(connector);\n   tomcat.setConnector(connector);\n   tomcat.getHost().setAutoDeploy(false);\n   configureEngine(tomcat.getEngine());\n   for (Connector additionalConnector : this.additionalTomcatConnectors) {\n      tomcat.getService().addConnector(additionalConnector);\n   }\n   prepareContext(tomcat.getHost(), initializers);\n    \n    //将配置好的Tomcat传入进去，返回一个EmbeddedServletContainer；并且启动Tomcat服务器\n   return getTomcatEmbeddedServletContainer(tomcat);\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br")])]),a("p",[n._v("4、我们对嵌入式容器的配置修改是怎么生效？")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("ServerProperties、EmbeddedServletContainerCustomizer\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[a("strong",[n._v("EmbeddedServletContainerCustomizer")]),n._v("：定制器帮我们修改了Servlet容器的配置？")]),n._v(" "),a("p",[n._v("怎么修改的原理？")]),n._v(" "),a("p",[n._v("5、容器中导入了"),a("strong",[n._v("EmbeddedServletContainerCustomizerBeanPostProcessor")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("//初始化之前\n@Override\npublic Object postProcessBeforeInitialization(Object bean, String beanName)\n      throws BeansException {\n    //如果当前初始化的是一个ConfigurableEmbeddedServletContainer类型的组件\n   if (bean instanceof ConfigurableEmbeddedServletContainer) {\n       //\n      postProcessBeforeInitialization((ConfigurableEmbeddedServletContainer) bean);\n   }\n   return bean;\n}\n\nprivate void postProcessBeforeInitialization(\n\t\t\tConfigurableEmbeddedServletContainer bean) {\n    //获取所有的定制器，调用每一个定制器的customize方法来给Servlet容器进行属性赋值；\n    for (EmbeddedServletContainerCustomizer customizer : getCustomizers()) {\n        customizer.customize(bean);\n    }\n}\n\nprivate Collection<EmbeddedServletContainerCustomizer> getCustomizers() {\n    if (this.customizers == null) {\n        // Look up does not include the parent context\n        this.customizers = new ArrayList<EmbeddedServletContainerCustomizer>(\n            this.beanFactory\n            //从容器中获取所有这葛类型的组件：EmbeddedServletContainerCustomizer\n            //定制Servlet容器，给容器中可以添加一个EmbeddedServletContainerCustomizer类型的组件\n            .getBeansOfType(EmbeddedServletContainerCustomizer.class,\n                            false, false)\n            .values());\n        Collections.sort(this.customizers, AnnotationAwareOrderComparator.INSTANCE);\n        this.customizers = Collections.unmodifiableList(this.customizers);\n    }\n    return this.customizers;\n}\n\nServerProperties也是定制器\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br")])]),a("p",[n._v("步骤：")]),n._v(" "),a("p",[n._v("1、SpringBoot根据导入的依赖情况，给容器中添加相应的EmbeddedServletContainerFactory【TomcatEmbeddedServletContainerFactory】")]),n._v(" "),a("p",[n._v("2、容器中某个组件要创建对象就会惊动后置处理器；EmbeddedServletContainerCustomizerBeanPostProcessor；")]),n._v(" "),a("p",[n._v("只要是嵌入式的Servlet容器工厂，后置处理器就工作；")]),n._v(" "),a("p",[n._v("3、后置处理器，从容器中获取所有的"),a("strong",[n._v("EmbeddedServletContainerCustomizer")]),n._v("，调用定制器的定制方法")]),n._v(" "),a("p",[n._v("###5、嵌入式Servlet容器启动原理；")]),n._v(" "),a("p",[n._v("什么时候创建嵌入式的Servlet容器工厂？什么时候获取嵌入式的Servlet容器并启动Tomcat；")]),n._v(" "),a("p",[n._v("获取嵌入式的Servlet容器工厂：")]),n._v(" "),a("p",[n._v("1、SpringBoot应用启动运行run方法")]),n._v(" "),a("p",[n._v("2、refreshContext(context);SpringBoot刷新IOC容器【创建IOC容器对象，并初始化容器，创建容器中的每一个组件】；如果是web应用创建"),a("strong",[n._v("AnnotationConfigEmbeddedWebApplicationContext")]),n._v("，否则："),a("strong",[n._v("AnnotationConfigApplicationContext")])]),n._v(" "),a("p",[n._v("3、refresh(context);"),a("strong",[n._v("刷新刚才创建好的ioc容器；")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('public void refresh() throws BeansException, IllegalStateException {\n   synchronized (this.startupShutdownMonitor) {\n      // Prepare this context for refreshing.\n      prepareRefresh();\n\n      // Tell the subclass to refresh the internal bean factory.\n      ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n\n      // Prepare the bean factory for use in this context.\n      prepareBeanFactory(beanFactory);\n\n      try {\n         // Allows post-processing of the bean factory in context subclasses.\n         postProcessBeanFactory(beanFactory);\n\n         // Invoke factory processors registered as beans in the context.\n         invokeBeanFactoryPostProcessors(beanFactory);\n\n         // Register bean processors that intercept bean creation.\n         registerBeanPostProcessors(beanFactory);\n\n         // Initialize message source for this context.\n         initMessageSource();\n\n         // Initialize event multicaster for this context.\n         initApplicationEventMulticaster();\n\n         // Initialize other special beans in specific context subclasses.\n         onRefresh();\n\n         // Check for listener beans and register them.\n         registerListeners();\n\n         // Instantiate all remaining (non-lazy-init) singletons.\n         finishBeanFactoryInitialization(beanFactory);\n\n         // Last step: publish corresponding event.\n         finishRefresh();\n      }\n\n      catch (BeansException ex) {\n         if (logger.isWarnEnabled()) {\n            logger.warn("Exception encountered during context initialization - " +\n                  "cancelling refresh attempt: " + ex);\n         }\n\n         // Destroy already created singletons to avoid dangling resources.\n         destroyBeans();\n\n         // Reset \'active\' flag.\n         cancelRefresh(ex);\n\n         // Propagate exception to caller.\n         throw ex;\n      }\n\n      finally {\n         // Reset common introspection caches in Spring\'s core, since we\n         // might not ever need metadata for singleton beans anymore...\n         resetCommonCaches();\n      }\n   }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br")])]),a("p",[n._v("4、  onRefresh(); web的ioc容器重写了onRefresh方法")]),n._v(" "),a("p",[n._v("5、webioc容器会创建嵌入式的Servlet容器；"),a("strong",[n._v("createEmbeddedServletContainer")]),n._v("();")]),n._v(" "),a("p",[a("strong",[n._v("6、获取嵌入式的Servlet容器工厂：")])]),n._v(" "),a("p",[n._v("EmbeddedServletContainerFactory containerFactory = getEmbeddedServletContainerFactory();")]),n._v(" "),a("p",[n._v("​\t从ioc容器中获取EmbeddedServletContainerFactory 组件；"),a("strong",[n._v("TomcatEmbeddedServletContainerFactory")]),n._v("创建对象，后置处理器一看是这个对象，就获取所有的定制器来先定制Servlet容器的相关配置；")]),n._v(" "),a("p",[n._v("7、"),a("strong",[n._v("使用容器工厂获取嵌入式的Servlet容器")]),n._v("：this.embeddedServletContainer = containerFactory      .getEmbeddedServletContainer(getSelfInitializer());")]),n._v(" "),a("p",[n._v("8、嵌入式的Servlet容器创建对象并启动Servlet容器；")]),n._v(" "),a("p",[a("strong",[n._v("先启动嵌入式的Servlet容器，再将ioc容器中剩下没有创建出的对象获取出来；")])]),n._v(" "),a("p",[a("strong",[n._v("IOC容器启动创建嵌入式的Servlet容器")])]),n._v(" "),a("h2",{attrs:{id:"_8、使用外置的servlet容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8、使用外置的servlet容器"}},[n._v("#")]),n._v(" 8、使用外置的Servlet容器")]),n._v(" "),a("p",[n._v("嵌入式Servlet容器：应用打成可执行的jar")]),n._v(" "),a("p",[n._v("​\t\t优点：简单、便携；")]),n._v(" "),a("p",[n._v("​\t\t缺点：默认不支持JSP、优化定制比较复杂（使用定制器【ServerProperties、自定义EmbeddedServletContainerCustomizer】，自己编写嵌入式Servlet容器的创建工厂【EmbeddedServletContainerFactory】）；")]),n._v(" "),a("p",[n._v("外置的Servlet容器：外面安装Tomcat---应用war包的方式打包；")]),n._v(" "),a("h3",{attrs:{id:"步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[n._v("#")]),n._v(" 步骤")]),n._v(" "),a("p",[n._v("1、必须创建一个war项目；（利用idea创建好目录结构）")]),n._v(" "),a("p",[n._v("2、将嵌入式的Tomcat指定为provided；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n   <groupId>org.springframework.boot</groupId>\n   <artifactId>spring-boot-starter-tomcat</artifactId>\n   <scope>provided</scope>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("3、必须编写一个"),a("strong",[n._v("SpringBootServletInitializer")]),n._v("的子类，并调用configure方法")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("public class ServletInitializer extends SpringBootServletInitializer {\n\n   @Override\n   protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {\n       //传入SpringBoot应用的主程序\n      return application.sources(SpringBoot04WebJspApplication.class);\n   }\n\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("4、启动服务器就可以使用；")]),n._v(" "),a("h3",{attrs:{id:"原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[n._v("#")]),n._v(" 原理")]),n._v(" "),a("p",[n._v("jar包：执行SpringBoot主类的main方法，启动ioc容器，创建嵌入式的Servlet容器；")]),n._v(" "),a("p",[n._v("war包：启动服务器，"),a("strong",[n._v("服务器启动SpringBoot应用")]),n._v("【SpringBootServletInitializer】，启动ioc容器；")]),n._v(" "),a("p",[n._v("servlet3.0：")]),n._v(" "),a("p",[n._v("8.2.4 Shared libraries / runtimes pluggability：")]),n._v(" "),a("p",[n._v("规则：")]),n._v(" "),a("blockquote",[a("p",[n._v("​\t1、服务器启动（web应用启动）会创建当前web应用里面每一个jar包里面ServletContainerInitializer实例：")]),n._v(" "),a("p",[n._v("​\t2、ServletContainerInitializer的实现放在jar包的META-INF/services文件夹下，有一个名为javax.servlet.ServletContainerInitializer的文件，内容就是ServletContainerInitializer的实现类的全类名")]),n._v(" "),a("p",[n._v("​\t3、还可以使用@HandlesTypes，在应用启动的时候加载我们感兴趣的类；")])]),n._v(" "),a("p",[n._v("流程：")]),n._v(" "),a("p",[n._v("1、启动Tomcat")]),n._v(" "),a("p",[n._v("2、org\\springframework\\spring-web\\4.3.14.RELEASE\\spring-web-4.3.14.RELEASE.jar!\\META-INF\\services\\javax.servlet.ServletContainerInitializer：")]),n._v(" "),a("p",[n._v("Spring的web模块里面有这个文件："),a("strong",[n._v("org.springframework.web.SpringServletContainerInitializer")])]),n._v(" "),a("p",[n._v("3、SpringServletContainerInitializer将@HandlesTypes(WebApplicationInitializer.class)标注的所有这个类型的类都传入到onStartup方法的Set<Class<?>>；为这些WebApplicationInitializer类型的类创建实例；")]),n._v(" "),a("p",[n._v("4、每一个WebApplicationInitializer都调用自己的onStartup；")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180302221835.png",alt:""}})]),n._v(" "),a("p",[n._v("5、相当于我们的SpringBootServletInitializer的类会被创建对象，并执行onStartup方法")]),n._v(" "),a("p",[n._v("6、SpringBootServletInitializer实例执行onStartup的时候会createRootApplicationContext；创建容器")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('protected WebApplicationContext createRootApplicationContext(\n      ServletContext servletContext) {\n    //1、创建SpringApplicationBuilder\n   SpringApplicationBuilder builder = createSpringApplicationBuilder();\n   StandardServletEnvironment environment = new StandardServletEnvironment();\n   environment.initPropertySources(servletContext, null);\n   builder.environment(environment);\n   builder.main(getClass());\n   ApplicationContext parent = getExistingRootWebApplicationContext(servletContext);\n   if (parent != null) {\n      this.logger.info("Root context already created (using as parent).");\n      servletContext.setAttribute(\n            WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, null);\n      builder.initializers(new ParentContextApplicationContextInitializer(parent));\n   }\n   builder.initializers(\n         new ServletContextApplicationContextInitializer(servletContext));\n   builder.contextClass(AnnotationConfigEmbeddedWebApplicationContext.class);\n    \n    //调用configure方法，子类重写了这个方法，将SpringBoot的主程序类传入了进来\n   builder = configure(builder);\n    \n    //使用builder创建一个Spring应用\n   SpringApplication application = builder.build();\n   if (application.getSources().isEmpty() && AnnotationUtils\n         .findAnnotation(getClass(), Configuration.class) != null) {\n      application.getSources().add(getClass());\n   }\n   Assert.state(!application.getSources().isEmpty(),\n         "No SpringApplication sources have been defined. Either override the "\n               + "configure method or add an @Configuration annotation");\n   // Ensure error pages are registered\n   if (this.registerErrorPageFilter) {\n      application.getSources().add(ErrorPageFilterConfiguration.class);\n   }\n    //启动Spring应用\n   return run(application);\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br")])]),a("p",[n._v("7、Spring的应用就启动并且创建IOC容器")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("public ConfigurableApplicationContext run(String... args) {\n   StopWatch stopWatch = new StopWatch();\n   stopWatch.start();\n   ConfigurableApplicationContext context = null;\n   FailureAnalyzers analyzers = null;\n   configureHeadlessProperty();\n   SpringApplicationRunListeners listeners = getRunListeners(args);\n   listeners.starting();\n   try {\n      ApplicationArguments applicationArguments = new DefaultApplicationArguments(\n            args);\n      ConfigurableEnvironment environment = prepareEnvironment(listeners,\n            applicationArguments);\n      Banner printedBanner = printBanner(environment);\n      context = createApplicationContext();\n      analyzers = new FailureAnalyzers(context);\n      prepareContext(context, environment, listeners, applicationArguments,\n            printedBanner);\n       \n       //刷新IOC容器\n      refreshContext(context);\n      afterRefresh(context, applicationArguments);\n      listeners.finished(context, null);\n      stopWatch.stop();\n      if (this.logStartupInfo) {\n         new StartupInfoLogger(this.mainApplicationClass)\n               .logStarted(getApplicationLog(), stopWatch);\n      }\n      return context;\n   }\n   catch (Throwable ex) {\n      handleRunFailure(context, listeners, analyzers, ex);\n      throw new IllegalStateException(ex);\n   }\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br")])]),a("p",[a("strong",[n._v("==启动Servlet容器，再启动SpringBoot应用==")])]),n._v(" "),a("h1",{attrs:{id:"五、docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、docker"}},[n._v("#")]),n._v(" 五、Docker")]),n._v(" "),a("h2",{attrs:{id:"_1、简介-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、简介-2"}},[n._v("#")]),n._v(" 1、简介")]),n._v(" "),a("p",[a("strong",[n._v("Docker")]),n._v("是一个开源的应用容器引擎；是一个轻量级容器技术；")]),n._v(" "),a("p",[n._v("Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像；")]),n._v(" "),a("p",[n._v("运行中的这个镜像称为容器，容器启动是非常快速的。")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180303145450.png",alt:""}})]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180303145531.png",alt:""}})]),n._v(" "),a("h2",{attrs:{id:"_2、核心概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、核心概念"}},[n._v("#")]),n._v(" 2、核心概念")]),n._v(" "),a("p",[n._v("docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）；")]),n._v(" "),a("p",[n._v("docker客户端(Client)：连接docker主机进行操作；")]),n._v(" "),a("p",[n._v("docker仓库(Registry)：用来保存各种打包好的软件镜像；")]),n._v(" "),a("p",[n._v("docker镜像(Images)：软件打包好的镜像；放在docker仓库中；")]),n._v(" "),a("p",[n._v("docker容器(Container)：镜像启动后的实例称为一个容器；容器是独立运行的一个或一组应用")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180303165113.png",alt:""}})]),n._v(" "),a("p",[n._v("使用Docker的步骤：")]),n._v(" "),a("p",[n._v("1、安装Docker")]),n._v(" "),a("p",[n._v("2、去Docker仓库找到这个软件对应的镜像；")]),n._v(" "),a("p",[n._v("3、使用Docker运行这个镜像，这个镜像就会生成一个Docker容器；")]),n._v(" "),a("p",[n._v("4、对容器的启动停止就是对软件的启动停止；")]),n._v(" "),a("h2",{attrs:{id:"_3、安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、安装docker"}},[n._v("#")]),n._v(" 3、安装Docker")]),n._v(" "),a("h4",{attrs:{id:"_1、安装linux虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、安装linux虚拟机"}},[n._v("#")]),n._v(" 1、安装linux虚拟机")]),n._v(" "),a("p",[n._v("​\t1、VMWare、VirtualBox（安装）；")]),n._v(" "),a("p",[n._v("​\t2、导入虚拟机文件centos7-demo.ova；")]),n._v(" "),a("p",[n._v("​\t3、双击启动linux虚拟机;使用  root/ 123456登陆")]),n._v(" "),a("p",[n._v("​\t4、使用客户端连接linux服务器进行命令操作；")]),n._v(" "),a("p",[n._v("​\t5、设置虚拟机网络；")]),n._v(" "),a("p",[n._v("​\t\t桥接网络===选好网卡====接入网线；")]),n._v(" "),a("p",[n._v("​\t6、设置好网络以后使用命令重启虚拟机的网络")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("service network restart\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("​\t7、查看linux的ip地址")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("ip addr\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("​\t8、使用客户端连接linux；")]),n._v(" "),a("h4",{attrs:{id:"_2、在linux虚拟机上安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、在linux虚拟机上安装docker"}},[n._v("#")]),n._v(" 2、在linux虚拟机上安装docker")]),n._v(" "),a("p",[n._v("步骤：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("1、检查内核版本，必须是3.10及以上\nuname -r\n2、安装docker\nyum install docker\n3、输入y确认安装\n4、启动docker\n[root@localhost ~]# systemctl start docker\n[root@localhost ~]# docker -v\nDocker version 1.12.6, build 3e8e77d/1.12.6\n5、开机启动docker\n[root@localhost ~]# systemctl enable docker\nCreated symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.\n6、停止docker\nsystemctl stop docker\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br")])]),a("h2",{attrs:{id:"_4、docker常用命令-操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、docker常用命令-操作"}},[n._v("#")]),n._v(" 4、Docker常用命令&操作")]),n._v(" "),a("h3",{attrs:{id:"_1、镜像操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、镜像操作"}},[n._v("#")]),n._v(" 1、镜像操作")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("操作")]),n._v(" "),a("th",[n._v("命令")]),n._v(" "),a("th",[n._v("说明")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("检索")]),n._v(" "),a("td",[n._v("docker  search 关键字  eg：docker  search redis")]),n._v(" "),a("td",[n._v("我们经常去docker  hub上检索镜像的详细信息，如镜像的TAG。")])]),n._v(" "),a("tr",[a("td",[n._v("拉取")]),n._v(" "),a("td",[n._v("docker pull 镜像名:tag")]),n._v(" "),a("td",[n._v(":tag是可选的，tag表示标签，多为软件的版本，默认是latest")])]),n._v(" "),a("tr",[a("td",[n._v("列表")]),n._v(" "),a("td",[n._v("docker images")]),n._v(" "),a("td",[n._v("查看所有本地镜像")])]),n._v(" "),a("tr",[a("td",[n._v("删除")]),n._v(" "),a("td",[n._v("docker rmi image-id")]),n._v(" "),a("td",[n._v("删除指定的本地镜像")])])])]),n._v(" "),a("p",[n._v("https://hub.docker.com/")]),n._v(" "),a("h3",{attrs:{id:"_2、容器操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、容器操作"}},[n._v("#")]),n._v(" 2、容器操作")]),n._v(" "),a("p",[n._v("软件镜像（QQ安装程序）----运行镜像----产生一个容器（正在运行的软件，运行的QQ）；")]),n._v(" "),a("p",[n._v("步骤：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("1、搜索镜像\n[root@localhost ~]# docker search tomcat\n2、拉取镜像\n[root@localhost ~]# docker pull tomcat\n3、根据镜像启动容器\ndocker run --name mytomcat -d tomcat:latest\n4、docker ps  \n查看运行中的容器\n5、 停止运行中的容器\ndocker stop  容器的id\n6、查看所有的容器\ndocker ps -a\n7、启动容器\ndocker start 容器id\n8、删除一个容器\n docker rm 容器id\n9、启动一个做了端口映射的tomcat\n[root@localhost ~]# docker run -d -p 8888:8080 tomcat\n-d：后台运行\n-p: 将主机的端口映射到容器的一个端口    主机端口:容器内部的端口\n\n10、为了演示简单关闭了linux的防火墙\nservice firewalld status ；查看防火墙状态\nservice firewalld stop：关闭防火墙\n11、查看容器的日志\ndocker logs container-name/container-id\n\n更多命令参看\nhttps://docs.docker.com/engine/reference/commandline/docker/\n可以参考每一个镜像的文档\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br")])]),a("h3",{attrs:{id:"_3、安装mysql示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、安装mysql示例"}},[n._v("#")]),n._v(" 3、安装MySQL示例")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("docker pull mysql\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("错误的启动")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('[root@localhost ~]# docker run --name mysql01 -d mysql\n42f09819908bb72dd99ae19e792e0a5d03c48638421fa64cce5f8ba0f40f5846\n\nmysql退出了\n[root@localhost ~]# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                           PORTS               NAMES\n42f09819908b        mysql               "docker-entrypoint.sh"   34 seconds ago      Exited (1) 33 seconds ago                            mysql01\n538bde63e500        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       compassionate_\ngoldstine\nc4f1ac60b3fc        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       lonely_fermi\n81ec743a5271        tomcat              "catalina.sh run"        About an hour ago   Exited (143) About an hour ago                       sick_ramanujan\n\n\n//错误日志\n[root@localhost ~]# docker logs 42f09819908b\nerror: database is uninitialized and password option is not specified \n  You need to specify one of MYSQL_ROOT_PASSWORD, MYSQL_ALLOW_EMPTY_PASSWORD and MYSQL_RANDOM_ROOT_PASSWORD；这个三个参数必须指定一个\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br")])]),a("p",[n._v("正确的启动")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('[root@localhost ~]# docker run --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysql\nb874c56bec49fb43024b3805ab51e9097da779f2f572c22c695305dedd684c5f\n[root@localhost ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\nb874c56bec49        mysql               "docker-entrypoint.sh"   4 seconds ago       Up 3 seconds        3306/tcp            mysql01\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("做了端口映射")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('[root@localhost ~]# docker run -p 3306:3306 --name mysql02 -e MYSQL_ROOT_PASSWORD=123456 -d mysql\nad10e4bc5c6a0f61cbad43898de71d366117d120e39db651844c0e73863b9434\n[root@localhost ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\nad10e4bc5c6a        mysql               "docker-entrypoint.sh"   4 seconds ago       Up 2 seconds        0.0.0.0:3306->3306/tcp   mysql02\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("几个其他的高级操作")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("docker run --name mysql03 -v /conf/mysql:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag\n把主机的/conf/mysql文件夹挂载到 mysqldocker容器的/etc/mysql/conf.d文件夹里面\n改mysql的配置文件就只需要把mysql配置文件放在自定义的文件夹下（/conf/mysql）\n\ndocker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci\n指定mysql的一些配置参数\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br")])]),a("h1",{attrs:{id:"六、启动配置原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、启动配置原理"}},[n._v("#")]),n._v(" 六、启动配置原理")]),n._v(" "),a("p",[n._v("几个重要的事件回调机制")]),n._v(" "),a("p",[n._v("配置在META-INF/spring.factories")]),n._v(" "),a("p",[a("strong",[n._v("ApplicationContextInitializer")])]),n._v(" "),a("p",[a("strong",[n._v("SpringApplicationRunListener")])]),n._v(" "),a("p",[n._v("只需要放在ioc容器中")]),n._v(" "),a("p",[a("strong",[n._v("ApplicationRunner")])]),n._v(" "),a("p",[a("strong",[n._v("CommandLineRunner")])]),n._v(" "),a("p",[n._v("启动流程：")]),n._v(" "),a("h2",{attrs:{id:"_1、创建springapplication对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建springapplication对象"}},[n._v("#")]),n._v(" "),a("strong",[n._v("1、创建SpringApplication对象")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("initialize(sources);\nprivate void initialize(Object[] sources) {\n    //保存主配置类\n    if (sources != null && sources.length > 0) {\n        this.sources.addAll(Arrays.asList(sources));\n    }\n    //判断当前是否一个web应用\n    this.webEnvironment = deduceWebEnvironment();\n    //从类路径下找到META-INF/spring.factories配置的所有ApplicationContextInitializer；然后保存起来\n    setInitializers((Collection) getSpringFactoriesInstances(\n        ApplicationContextInitializer.class));\n    //从类路径下找到ETA-INF/spring.factories配置的所有ApplicationListener\n    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));\n    //从多个配置类中找到有main方法的主配置类\n    this.mainApplicationClass = deduceMainApplicationClass();\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br")])]),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180306145727.png",alt:""}})]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180306145855.png",alt:""}})]),n._v(" "),a("h2",{attrs:{id:"_2、运行run方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、运行run方法"}},[n._v("#")]),n._v(" 2、运行run方法")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("public ConfigurableApplicationContext run(String... args) {\n   StopWatch stopWatch = new StopWatch();\n   stopWatch.start();\n   ConfigurableApplicationContext context = null;\n   FailureAnalyzers analyzers = null;\n   configureHeadlessProperty();\n    \n   //获取SpringApplicationRunListeners；从类路径下META-INF/spring.factories\n   SpringApplicationRunListeners listeners = getRunListeners(args);\n    //回调所有的获取SpringApplicationRunListener.starting()方法\n   listeners.starting();\n   try {\n       //封装命令行参数\n      ApplicationArguments applicationArguments = new DefaultApplicationArguments(\n            args);\n      //准备环境\n      ConfigurableEnvironment environment = prepareEnvironment(listeners,\n            applicationArguments);\n       \t\t//创建环境完成后回调SpringApplicationRunListener.environmentPrepared()；表示环境准备完成\n       \n      Banner printedBanner = printBanner(environment);\n       \n       //创建ApplicationContext；决定创建web的ioc还是普通的ioc\n      context = createApplicationContext();\n       \n      analyzers = new FailureAnalyzers(context);\n       //准备上下文环境;将environment保存到ioc中；而且applyInitializers()；\n       //applyInitializers()：回调之前保存的所有的ApplicationContextInitializer的initialize方法\n       //回调所有的SpringApplicationRunListener的contextPrepared()；\n       //\n      prepareContext(context, environment, listeners, applicationArguments,\n            printedBanner);\n       //prepareContext运行完成以后回调所有的SpringApplicationRunListener的contextLoaded（）；\n       \n       //s刷新容器；ioc容器初始化（如果是web应用还会创建嵌入式的Tomcat）；\n       //扫描，创建，加载所有组件的地方；（配置类，组件，自动配置）\n      refreshContext(context);\n       //从ioc容器中获取所有的ApplicationRunner和CommandLineRunner进行回调\n       //ApplicationRunner先回调，CommandLineRunner再回调\n      afterRefresh(context, applicationArguments);\n       //所有的SpringApplicationRunListener回调finished方法\n      listeners.finished(context, null);\n      stopWatch.stop();\n      if (this.logStartupInfo) {\n         new StartupInfoLogger(this.mainApplicationClass)\n               .logStarted(getApplicationLog(), stopWatch);\n      }\n       //整个SpringBoot应用启动完成以后返回启动的ioc容器；\n      return context;\n   }\n   catch (Throwable ex) {\n      handleRunFailure(context, listeners, analyzers, ex);\n      throw new IllegalStateException(ex);\n   }\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br")])]),a("h2",{attrs:{id:"_3、事件监听机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、事件监听机制"}},[n._v("#")]),n._v(" 3、事件监听机制")]),n._v(" "),a("p",[n._v("配置在META-INF/spring.factories")]),n._v(" "),a("p",[a("strong",[n._v("ApplicationContextInitializer")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('public class HelloApplicationContextInitializer implements ApplicationContextInitializer<ConfigurableApplicationContext> {\n    @Override\n    public void initialize(ConfigurableApplicationContext applicationContext) {\n        System.out.println("ApplicationContextInitializer...initialize..."+applicationContext);\n    }\n}\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[a("strong",[n._v("SpringApplicationRunListener")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('public class HelloSpringApplicationRunListener implements SpringApplicationRunListener {\n\n    //必须有的构造器\n    public HelloSpringApplicationRunListener(SpringApplication application, String[] args){\n\n    }\n\n    @Override\n    public void starting() {\n        System.out.println("SpringApplicationRunListener...starting...");\n    }\n\n    @Override\n    public void environmentPrepared(ConfigurableEnvironment environment) {\n        Object o = environment.getSystemProperties().get("os.name");\n        System.out.println("SpringApplicationRunListener...environmentPrepared.."+o);\n    }\n\n    @Override\n    public void contextPrepared(ConfigurableApplicationContext context) {\n        System.out.println("SpringApplicationRunListener...contextPrepared...");\n    }\n\n    @Override\n    public void contextLoaded(ConfigurableApplicationContext context) {\n        System.out.println("SpringApplicationRunListener...contextLoaded...");\n    }\n\n    @Override\n    public void finished(ConfigurableApplicationContext context, Throwable exception) {\n        System.out.println("SpringApplicationRunListener...finished...");\n    }\n}\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br")])]),a("p",[n._v("配置（META-INF/spring.factories）")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("org.springframework.context.ApplicationContextInitializer=\\\ncom.demo.springboot.listener.HelloApplicationContextInitializer\n\norg.springframework.boot.SpringApplicationRunListener=\\\ncom.demo.springboot.listener.HelloSpringApplicationRunListener\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("只需要放在ioc容器中")]),n._v(" "),a("p",[a("strong",[n._v("ApplicationRunner")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Component\npublic class HelloApplicationRunner implements ApplicationRunner {\n    @Override\n    public void run(ApplicationArguments args) throws Exception {\n        System.out.println("ApplicationRunner...run....");\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[a("strong",[n._v("CommandLineRunner")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@Component\npublic class HelloCommandLineRunner implements CommandLineRunner {\n    @Override\n    public void run(String... args) throws Exception {\n        System.out.println("CommandLineRunner...run..."+ Arrays.asList(args));\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("h1",{attrs:{id:"七、自定义starter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七、自定义starter"}},[n._v("#")]),n._v(" 七、自定义starter")]),n._v(" "),a("p",[n._v("starter：")]),n._v(" "),a("p",[n._v("​\t1、这个场景需要使用到的依赖是什么？")]),n._v(" "),a("p",[n._v("​\t2、如何编写自动配置")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("@Configuration  //指定这个类是一个配置类\n@ConditionalOnXXX  //在指定条件成立的情况下自动配置类生效\n@AutoConfigureAfter  //指定自动配置类的顺序\n@Bean  //给容器中添加组件\n\n@ConfigurationPropertie结合相关xxxProperties类来绑定相关的配置\n@EnableConfigurationProperties //让xxxProperties生效加入到容器中\n\n自动配置类要能加载\n将需要启动就加载的自动配置类，配置在META-INF/spring.factories\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\norg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br")])]),a("p",[n._v("​\t3、模式：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[n._v("启动器只用来做依赖导入；\n\n专门来写一个自动配置模块；\n\n启动器依赖自动配置；别人只需要引入启动器（starter）\n\nmybatis-spring-boot-starter；自定义启动器名-spring-boot-starter\n")])])]),a("p",[n._v("步骤：")]),n._v(" "),a("p",[n._v("1、启动器模块")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.demo.starter</groupId>\n    <artifactId>demo-spring-boot-starter</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    \x3c!--启动器--\x3e\n    <dependencies>\n        \x3c!--引入自动配置模块--\x3e\n        <dependency>\n            <groupId>com.demo.starter</groupId>\n            <artifactId>demo-spring-boot-starter-autoconfigurer</artifactId>\n            <version>0.0.1-SNAPSHOT</version>\n        </dependency>\n    </dependencies>\n</project>\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br")])]),a("p",[n._v("2、自动配置模块")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n   xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n   <modelVersion>4.0.0</modelVersion>\n\n   <groupId>com.demo.starter</groupId>\n   <artifactId>demo-spring-boot-starter-autoconfigurer</artifactId>\n   <version>0.0.1-SNAPSHOT</version>\n   <packaging>jar</packaging>\n\n   <name>demo-spring-boot-starter-autoconfigurer</name>\n   <description>Demo project for Spring Boot</description>\n\n   <parent>\n      <groupId>org.springframework.boot</groupId>\n      <artifactId>spring-boot-starter-parent</artifactId>\n      <version>1.5.10.RELEASE</version>\n      <relativePath/> \x3c!-- lookup parent from repository --\x3e\n   </parent>\n\n   <properties>\n      <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n      <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n      <java.version>1.8</java.version>\n   </properties>\n\n   <dependencies>\n\n      \x3c!--引入spring-boot-starter；所有starter的基本配置--\x3e\n      <dependency>\n         <groupId>org.springframework.boot</groupId>\n         <artifactId>spring-boot-starter</artifactId>\n      </dependency>\n\n   </dependencies>\n</project>\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('package com.demo.starter;\n\nimport org.springframework.boot.context.properties.ConfigurationProperties;\n\n@ConfigurationProperties(prefix = "demo.hello")\npublic class HelloProperties {\n\n    private String prefix;\n    private String suffix;\n\n    public String getPrefix() {\n        return prefix;\n    }\n\n    public void setPrefix(String prefix) {\n        this.prefix = prefix;\n    }\n\n    public String getSuffix() {\n        return suffix;\n    }\n\n    public void setSuffix(String suffix) {\n        this.suffix = suffix;\n    }\n}\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('package com.demo.starter;\n\npublic class HelloService {\n\n    HelloProperties helloProperties;\n\n    public HelloProperties getHelloProperties() {\n        return helloProperties;\n    }\n\n    public void setHelloProperties(HelloProperties helloProperties) {\n        this.helloProperties = helloProperties;\n    }\n\n    public String sayHelldemo(String name){\n        return helloProperties.getPrefix()+"-" +name + helloProperties.getSuffix();\n    }\n}\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("package com.demo.starter;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnWebApplication;\nimport org.springframework.boot.context.properties.EnableConfigurationProperties;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\n@ConditionalOnWebApplication //web应用才生效\n@EnableConfigurationProperties(HelloProperties.class)\npublic class HelloServiceAutoConfiguration {\n\n    @Autowired\n    HelloProperties helloProperties;\n    @Bean\n    public HelloService helloService(){\n        HelloService service = new HelloService();\n        service.setHelloProperties(helloProperties);\n        return service;\n    }\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br")])]),a("h1",{attrs:{id:"八、日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#八、日志"}},[n._v("#")]),n._v(" 八、日志")]),n._v(" "),a("h2",{attrs:{id:"_1、日志框架"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、日志框架"}},[n._v("#")]),n._v(" 1、日志框架")]),n._v(" "),a("p",[n._v("小张；开发一个大型系统；")]),n._v(" "),a("p",[n._v('​\t\t1、System.out.println("")；将关键数据打印在控制台；去掉？写在一个文件？')]),n._v(" "),a("p",[n._v("​\t\t2、框架来记录系统的一些运行时信息；日志框架 ；  zhanglogging.jar；")]),n._v(" "),a("p",[n._v("​\t\t3、高大上的几个功能？异步模式？自动归档？xxxx？  zhanglogging-good.jar？")]),n._v(" "),a("p",[n._v("​\t\t4、将以前框架卸下来？换上新的框架，重新修改之前相关的API；zhanglogging-prefect.jar；")]),n._v(" "),a("p",[n._v("​\t\t5、JDBC---数据库驱动；")]),n._v(" "),a("p",[n._v("​\t\t\t写了一个统一的接口层；日志门面（日志的一个抽象层）；logging-abstract.jar；")]),n._v(" "),a("p",[n._v("​\t\t\t给项目中导入具体的日志实现就行了；我们之前的日志框架都是实现的抽象层；")]),n._v(" "),a("p",[a("strong",[n._v("市面上的日志框架；")])]),n._v(" "),a("p",[n._v("JUL、JCL、Jboss-logging、logback、log4j、log4j2、slf4j....")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("日志门面  （日志的抽象层）")]),n._v(" "),a("th",[n._v("日志实现")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[a("s",[n._v("JCL（Jakarta  Commons Logging）")]),n._v("    SLF4j（Simple  Logging Facade for Java）    "),a("strong",[a("s",[n._v("jboss-logging")])])]),n._v(" "),a("td",[n._v("Log4j  JUL（java.util.logging）  Log4j2  "),a("strong",[n._v("Logback")])])])])]),n._v(" "),a("p",[n._v("左边选一个门面（抽象层）、右边来选一个实现；")]),n._v(" "),a("p",[n._v("日志门面：  SLF4J；")]),n._v(" "),a("p",[n._v("日志实现：Logback；")]),n._v(" "),a("p",[n._v("SpringBoot：底层是Spring框架，Spring框架默认是用JCL；‘")]),n._v(" "),a("p",[n._v("​\t"),a("strong",[n._v("SpringBoot选用 SLF4j和logback；")])]),n._v(" "),a("h2",{attrs:{id:"_2、slf4j使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、slf4j使用"}},[n._v("#")]),n._v(" 2、SLF4j使用")]),n._v(" "),a("h3",{attrs:{id:"_1、如何在系统中使用slf4j-https-www-slf4j-org"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、如何在系统中使用slf4j-https-www-slf4j-org"}},[n._v("#")]),n._v(" 1、如何在系统中使用SLF4j   https://www.slf4j.org")]),n._v(" "),a("p",[n._v("以后开发的时候，日志记录方法的调用，不应该来直接调用日志的实现类，而是调用日志抽象层里面的方法；")]),n._v(" "),a("p",[n._v("给系统里面导入slf4j的jar和  logback的实现jar")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('import org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class HelloWorld {\n  public static void main(String[] args) {\n    Logger logger = LoggerFactory.getLogger(HelloWorld.class);\n    logger.info("Hello World");\n  }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("图示；")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/concrete-bindings.png",alt:"images/concrete-bindings.png"}})]),n._v(" "),a("p",[n._v("每一个日志的实现框架都有自己的配置文件。使用slf4j以后，"),a("strong",[n._v("配置文件还是做成日志实现框架自己本身的配置文件；")])]),n._v(" "),a("h3",{attrs:{id:"_2、遗留问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、遗留问题"}},[n._v("#")]),n._v(" 2、遗留问题")]),n._v(" "),a("p",[n._v("a（slf4j+logback）: Spring（commons-logging）、Hibernate（jboss-logging）、MyBatis、xxxx")]),n._v(" "),a("p",[n._v("统一日志记录，即使是别的框架和我一起统一使用slf4j进行输出？")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/legacy.png",alt:""}})]),n._v(" "),a("p",[a("strong",[n._v("如何让系统中所有的日志都统一到slf4j；")])]),n._v(" "),a("p",[n._v("1、将系统中其他日志框架先排除出去；")]),n._v(" "),a("p",[n._v("2、用中间包来替换原有的日志框架；")]),n._v(" "),a("p",[n._v("3、我们导入slf4j其他的实现")]),n._v(" "),a("h2",{attrs:{id:"_3、springboot日志关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、springboot日志关系"}},[n._v("#")]),n._v(" 3、SpringBoot日志关系")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter</artifactId>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("p",[n._v("SpringBoot使用它来做日志功能；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-logging</artifactId>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("p",[n._v("底层依赖关系")]),n._v(" "),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180131220946.png",alt:""}})]),n._v(" "),a("p",[n._v("总结：")]),n._v(" "),a("p",[n._v("​\t1、SpringBoot底层也是使用slf4j+logback的方式进行日志记录")]),n._v(" "),a("p",[n._v("​\t2、SpringBoot也把其他的日志都替换成了slf4j；")]),n._v(" "),a("p",[n._v("​\t3、中间替换包？")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('@SuppressWarnings("rawtypes")\npublic abstract class LogFactory {\n\n    static String UNSUPPORTED_OPERATION_IN_JCL_OVER_SLF4J = "http://www.slf4j.org/codes.html#unsupported_operation_in_jcl_over_slf4j";\n\n    static LogFactory logFactory = new SLF4JLogFactory();\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br")])]),a("p",[a("img",{attrs:{src:"images/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20180131221411.png",alt:""}})]),n._v(" "),a("p",[n._v("​\t4、如果我们要引入其他框架？一定要把这个框架的默认日志依赖移除掉？")]),n._v(" "),a("p",[n._v("​\t\t\tSpring框架用的是commons-logging；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-core</artifactId>\n    <exclusions>\n        <exclusion>\n            <groupId>commons-logging</groupId>\n            <artifactId>commons-logging</artifactId>\n        </exclusion>\n    </exclusions>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br")])]),a("p",[a("strong",[n._v("SpringBoot能自动适配所有的日志，而且底层使用slf4j+logback的方式记录日志，引入其他框架的时候，只需要把这个框架依赖的日志框架排除掉即可；")])]),n._v(" "),a("h2",{attrs:{id:"_4、日志使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、日志使用"}},[n._v("#")]),n._v(" 4、日志使用；")]),n._v(" "),a("h3",{attrs:{id:"_1、默认配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、默认配置"}},[n._v("#")]),n._v(" 1、默认配置")]),n._v(" "),a("p",[n._v("SpringBoot默认帮我们配置好了日志；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('\t//记录器\n\tLogger logger = LoggerFactory.getLogger(getClass());\n\t@Test\n\tpublic void contextLoads() {\n\t\t//System.out.println();\n\n\t\t//日志的级别；\n\t\t//由低到高   trace<debug<info<warn<error\n\t\t//可以调整输出的日志级别；日志就只会在这个级别以以后的高级别生效\n\t\tlogger.trace("这是trace日志...");\n\t\tlogger.debug("这是debug日志...");\n\t\t//SpringBoot默认给我们使用的是info级别的，没有指定级别的就用SpringBoot默认规定的级别；root级别\n\t\tlogger.info("这是info日志...");\n\t\tlogger.warn("这是warn日志...");\n\t\tlogger.error("这是error日志...");\n\t}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("日志输出格式：\n    %d表示日期时间，\n    %thread表示线程名，\n    %-5level：级别从左显示5个字符宽度\n    %logger{50} 表示logger名字最长50个字符，否则按照句点分割。 \n    %msg：日志消息，\n    %n是换行符\n--\x3e\n%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("SpringBoot修改日志的默认配置")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("logging.level.com.demo=trace\n\n\n#logging.path=\n# 不指定路径在当前项目下生成springboot.log日志\n# 可以指定完整的路径；\n#logging.file=G:/springboot.log\n\n# 在当前磁盘的根路径下创建spring文件夹和里面的log文件夹；使用 spring.log 作为默认文件\nlogging.path=/spring/log\n\n#  在控制台输出的日志的格式\nlogging.pattern.console=%d{yyyy-MM-dd} [%thread] %-5level %logger{50} - %msg%n\n# 指定文件中日志输出的格式\nlogging.pattern.file=%d{yyyy-MM-dd} === [%thread] === %-5level === %logger{50} ==== %msg%n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[n._v("logging.file")]),n._v(" "),a("th",[n._v("logging.path")]),n._v(" "),a("th",[n._v("Example")]),n._v(" "),a("th",[n._v("Description")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("(none)")]),n._v(" "),a("td",[n._v("(none)")]),n._v(" "),a("td"),n._v(" "),a("td",[n._v("只在控制台输出")])]),n._v(" "),a("tr",[a("td",[n._v("指定文件名")]),n._v(" "),a("td",[n._v("(none)")]),n._v(" "),a("td",[n._v("my.log")]),n._v(" "),a("td",[n._v("输出日志到my.log文件")])]),n._v(" "),a("tr",[a("td",[n._v("(none)")]),n._v(" "),a("td",[n._v("指定目录")]),n._v(" "),a("td",[n._v("/var/log")]),n._v(" "),a("td",[n._v("输出到指定目录的 spring.log 文件中")])])])]),n._v(" "),a("h3",{attrs:{id:"_2、指定配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、指定配置"}},[n._v("#")]),n._v(" 2、指定配置")]),n._v(" "),a("p",[n._v("给类路径下放上每个日志框架自己的配置文件即可；SpringBoot就不使用他默认配置的了")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("Logging System")]),n._v(" "),a("th",[n._v("Customization")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("Logback")]),n._v(" "),a("td",[a("code",[n._v("logback-spring.xml")]),n._v(", "),a("code",[n._v("logback-spring.groovy")]),n._v(", "),a("code",[n._v("logback.xml")]),n._v(" or "),a("code",[n._v("logback.groovy")])])]),n._v(" "),a("tr",[a("td",[n._v("Log4j2")]),n._v(" "),a("td",[a("code",[n._v("log4j2-spring.xml")]),n._v(" or "),a("code",[n._v("log4j2.xml")])])]),n._v(" "),a("tr",[a("td",[n._v("JDK (Java Util Logging)")]),n._v(" "),a("td",[a("code",[n._v("logging.properties")])])])])]),n._v(" "),a("p",[n._v("logback.xml：直接就被日志框架识别了；")]),n._v(" "),a("p",[a("strong",[n._v("logback-spring.xml")]),n._v("：日志框架就不直接加载日志的配置项，由SpringBoot解析日志配置，可以使用SpringBoot的高级Profile功能")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<springProfile name="staging">\n    \x3c!-- configuration to be enabled when the "staging" profile is active --\x3e\n  \t可以指定某段配置只在某个环境下生效\n</springProfile>\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br")])]),a("p",[n._v("如：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('<appender name="stdout" class="ch.qos.logback.core.ConsoleAppender">\n    \x3c!--\n    日志输出格式：\n        %d表示日期时间，\n        %thread表示线程名，\n        %-5level：级别从左显示5个字符宽度\n        %logger{50} 表示logger名字最长50个字符，否则按照句点分割。 \n        %msg：日志消息，\n        %n是换行符\n    --\x3e\n    <layout class="ch.qos.logback.classic.PatternLayout">\n        <springProfile name="dev">\n            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} ----\x3e [%thread] ---\x3e %-5level %logger{50} - %msg%n</pattern>\n        </springProfile>\n        <springProfile name="!dev">\n            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} ==== [%thread] ==== %-5level %logger{50} - %msg%n</pattern>\n        </springProfile>\n    </layout>\n</appender>\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("p",[n._v("如果使用logback.xml作为日志配置文件，还要使用profile功能，会有以下错误")]),n._v(" "),a("p",[a("code",[n._v("no applicable action for [springProfile]")])]),n._v(" "),a("h2",{attrs:{id:"_5、切换日志框架"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、切换日志框架"}},[n._v("#")]),n._v(" 5、切换日志框架")]),n._v(" "),a("p",[n._v("可以按照slf4j的日志适配图，进行相关的切换；")]),n._v(" "),a("p",[n._v("slf4j+log4j的方式；")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-web</artifactId>\n  <exclusions>\n    <exclusion>\n      <artifactId>logback-classic</artifactId>\n      <groupId>ch.qos.logback</groupId>\n    </exclusion>\n    <exclusion>\n      <artifactId>log4j-over-slf4j</artifactId>\n      <groupId>org.slf4j</groupId>\n    </exclusion>\n  </exclusions>\n</dependency>\n\n<dependency>\n  <groupId>org.slf4j</groupId>\n  <artifactId>slf4j-log4j12</artifactId>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("p",[n._v("切换为log4j2")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n    <exclusions>\n        <exclusion>\n            <artifactId>spring-boot-starter-logging</artifactId>\n            <groupId>org.springframework.boot</groupId>\n        </exclusion>\n    </exclusions>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-log4j2</artifactId>\n</dependency>\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br")])]),a("h1",{attrs:{id:"九、缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#九、缓存"}},[n._v("#")]),n._v(" 九、缓存")]),n._v(" "),a("h2",{attrs:{id:"_1、缓存的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、缓存的使用"}},[n._v("#")]),n._v(" 1、缓存的使用")]),n._v(" "),a("p",[n._v("Spring从3.1开始定义了org.springframework.cache.Cache 和org.springframework.cache.CacheManager接口来统一不同的缓存技术； 并支持使用JCache（JSR-107）注解简化我们开发；")]),n._v(" "),a("blockquote",[a("p",[n._v("Cache接口为缓存的组件规范定义，包含缓存的各种操作集合；\nCache接口下Spring提供了各种xxxCache的实现；如RedisCache，EhCacheCache , ConcurrentMapCache等；\n每次调用需要缓存功能的方法时，Spring会检查检查指定参数的指定的目标方法是否 已经被调用过；如果有就直接从缓存中获取方法调用后的结果，如果没有就调用方法 并缓存结果后返回给用户。下次调用直接从缓存中获取。\n使用Spring缓存抽象时我们需要关注以下两点； 1、确定方法需要被缓存以及他们的缓存策略 2、从缓存中读取之前缓存存储的数据")])]),n._v(" "),a("p",[n._v("概念和核心注解:")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("注解组件")]),n._v(" "),a("th",[n._v("功能解释")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("Cache")]),n._v(" "),a("td",[n._v("缓存接口，定义缓存操作。实现有：RedisCache、EhCacheCache、 ConcurrentMapCache等 CacheManager 缓存管理器，管理各种缓存（Cache）组件")])]),n._v(" "),a("tr",[a("td",[n._v("@Cacheable")]),n._v(" "),a("td",[n._v("主要针对方法配置，能够根据方法的请求参数对其结果进行缓存")])]),n._v(" "),a("tr",[a("td",[n._v("@CacheEvict")]),n._v(" "),a("td",[n._v("清空缓存")])]),n._v(" "),a("tr",[a("td",[n._v("@CachePut")]),n._v(" "),a("td",[n._v("保证方法被调用，又希望结果被缓存。")])]),n._v(" "),a("tr",[a("td",[n._v("@EnableCaching")]),n._v(" "),a("td",[n._v("开启基于注解的缓存")])]),n._v(" "),a("tr",[a("td",[n._v("keyGenerator")]),n._v(" "),a("td",[n._v("缓存数据时key生成策略")])]),n._v(" "),a("tr",[a("td",[n._v("serialize")]),n._v(" "),a("td",[n._v("缓存数据时value序列化策略")])])])]),n._v(" "),a("p",[n._v("@Cacheable/@CachePut/@CacheEvict 主要的参数:")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("参数")]),n._v(" "),a("th",[n._v("描述")]),n._v(" "),a("th",[n._v("例子")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("value")]),n._v(" "),a("td",[n._v("缓存的名称，在 spring 配置文件中定义，必须 指定至少一个")]),n._v(" "),a("td",[n._v("例如： @Cacheable(value=”mycache”) 或者 @Cacheable(value={”cache1”,”cache2”}")])]),n._v(" "),a("tr",[a("td",[n._v("key")]),n._v(" "),a("td",[n._v("缓存的 key，可以为空，如果指定要按照 SpEL 表达式编写，如果不指定，则缺省按照方法的 所有参数进行组合")]),n._v(" "),a("td",[n._v("例如： @Cacheable(value=”testcache”,key=”#userName”)")])]),n._v(" "),a("tr",[a("td",[n._v("condition")]),n._v(" "),a("td",[n._v("缓存的条件，可以为空，使用 SpEL 编写，返 回 true 或者 false，只有为 true 才进行缓存/清 除缓存")]),n._v(" "),a("td",[n._v("例如： @Cacheable(value=”testcache”,condition=”#userNam e.length()>2”)")])]),n._v(" "),a("tr",[a("td",[n._v("allEntries")]),n._v(" "),a("td",[n._v("(@CacheEvict )")]),n._v(" "),a("td",[n._v("是否清空所有缓存内容，缺省为 false，如果指 定为 true，则方法调用后将立即清空所有缓存")])]),n._v(" "),a("tr",[a("td",[n._v("beforeInvocation (@CacheEvict)")]),n._v(" "),a("td",[n._v("是否在方法执行前就清空，缺省为 false，如果 指定为 true，则在方法还没有执行的时候就清 空缓存，缺省情况下，如果方法执行抛出异常， 则不会清空缓存")]),n._v(" "),a("td",[n._v("例如： @CachEvict(value=”testcache”， beforeInvocation=true)")])])])]),n._v(" "),a("p",[n._v("Cache SpEL available matedata")]),n._v(" "),a("table",[a("thead",[a("tr",[a("th",[n._v("名字")]),n._v(" "),a("th",[n._v("位置")]),n._v(" "),a("th",[n._v("描述")]),n._v(" "),a("th",[n._v("实例")])])]),n._v(" "),a("tbody",[a("tr",[a("td",[n._v("methodName")]),n._v(" "),a("td",[n._v("root object")]),n._v(" "),a("td",[n._v("当前被调用的方法名")]),n._v(" "),a("td",[n._v("#root.methodName")])]),n._v(" "),a("tr",[a("td",[n._v("method")]),n._v(" "),a("td",[n._v("root object")]),n._v(" "),a("td",[n._v("当前被调用的方法")]),n._v(" "),a("td",[n._v("#root.method.name")])]),n._v(" "),a("tr",[a("td",[n._v("target")]),n._v(" "),a("td",[n._v("root object")]),n._v(" "),a("td",[n._v("当前被调用的目标对象")]),n._v(" "),a("td",[n._v("#root.target")])]),n._v(" "),a("tr",[a("td",[n._v("targetClass")]),n._v(" "),a("td",[n._v("root object")]),n._v(" "),a("td",[n._v("当前被调用的目标对象类")]),n._v(" "),a("td",[n._v("#root.targetClass")])]),n._v(" "),a("tr",[a("td",[n._v("args")]),n._v(" "),a("td",[n._v("root object")]),n._v(" "),a("td",[n._v('当前方法调用使用的缓存列表(如@Cacheable(value={"cache1","cache2"})),则有两个cache')]),n._v(" "),a("td",[n._v("#root.caches[0].name")])]),n._v(" "),a("tr",[a("td",[n._v("argument")]),n._v(" "),a("td",[n._v("evaluation context")]),n._v(" "),a("td",[n._v("方法参数的名字，可以直接#参数名，也可以使用#p0或a0的形式，0代表参数的索引")]),n._v(" "),a("td",[n._v("#Iban,#a0,#p0")])]),n._v(" "),a("tr",[a("td",[n._v("result")]),n._v(" "),a("td",[n._v("evaluation context")]),n._v(" "),a("td",[n._v('方法执行后的返回值(仅当方法执行之后的判断有效，如"unless","cache put"的表达式 "cache evict"的表达式befoteInvocation=false)')]),n._v(" "),a("td",[n._v("result")])])])]),n._v(" "),a("blockquote",[a("p",[n._v("案例演示源码地址："),a("a",{attrs:{href:"https://github.com/gitldy1013/SpringBoot-learn",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://github.com/gitldy1013/SpringBoot-learn"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=t.exports}}]);